function AggregateError(e,t,i){if(t){if(t.innerError&&i)return t;var r="\n------------------------------------------------\n";e+=r+"Inner Error:\n","string"==typeof t?e+="Message: "+t:(t.message?e+="Message: "+t.message:e+="Unknown Inner Error Type. Displaying Inner Error as JSON:\n "+JSON.stringify(t,null,"  "),t.stack&&(e+="\nInner Error Stack:\n"+t.stack,e+="\nEnd Inner Error Stack")),e+=r}var n=new Error(e);return t&&(n.innerError=t),n}var FEATURE={},PLATFORM={noop:function(){},eachModule:function(){},moduleName:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return e})};PLATFORM.global="undefined"!=typeof self?self:"undefined"!=typeof global?global:new Function("return this")();var DOM={},isInitialized=!1;function initializePAL(e){isInitialized||(isInitialized=!0,"function"!=typeof Object.getPropertyDescriptor&&(Object.getPropertyDescriptor=function(e,t){for(var i=Object.getOwnPropertyDescriptor(e,t),r=Object.getPrototypeOf(e);void 0===i&&null!==r;)i=Object.getOwnPropertyDescriptor(r,t),r=Object.getPrototypeOf(r);return i}),e(PLATFORM,FEATURE,DOM))}function reset(){isInitialized=!1}String.prototype.endsWith&&!function(){try{return!"ab".endsWith("a",1)}catch(e){return!0}}()||(String.prototype.endsWith=function(e,t){var i=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>i.length)&&(t=i.length),t-=e.length;var r=i.indexOf(e,t);return-1!==r&&r===t}),String.prototype.startsWith&&!function(){try{return!"ab".startsWith("b",1)}catch(e){return!0}}()||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e});var emptyMetadata=Object.freeze({}),metadataContainerKey="__metadata__";"function"!=typeof Reflect.getOwnMetadata&&(Reflect.getOwnMetadata=function(e,t,i){if(t.hasOwnProperty(metadataContainerKey))return(t[metadataContainerKey][i]||emptyMetadata)[e]}),"function"!=typeof Reflect.defineMetadata&&(Reflect.defineMetadata=function(e,t,i,r){var n=i.hasOwnProperty(metadataContainerKey)?i[metadataContainerKey]:i[metadataContainerKey]={};(n[r]||(n[r]={}))[e]=t}),"function"!=typeof Reflect.metadata&&(Reflect.metadata=function(e,t){return function(i,r){Reflect.defineMetadata(e,t,i,r)}});const _PLATFORM={location:window.location,history:window.history,addEventListener(e,t,i){this.global.addEventListener(e,t,i)},removeEventListener(e,t,i){this.global.removeEventListener(e,t,i)},performance:window.performance,requestAnimationFrame(e){return this.global.requestAnimationFrame(e)}};if(Element&&!Element.prototype.matches){let e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}const _FEATURE={shadowDOM:!!HTMLElement.prototype.attachShadow,scopedCSS:"scoped"in document.createElement("style"),htmlTemplateElement:function(){let e=document.createElement("div");return e.innerHTML="<template></template>","content"in e.children[0]}(),mutationObserver:!(!window.MutationObserver&&!window.WebKitMutationObserver),ensureHTMLTemplateElement:e=>e};let shadowPoly=window.ShadowDOMPolyfill||null;const _DOM={Element,NodeList,SVGElement,boundary:"aurelia-dom-boundary",addEventListener(e,t,i){document.addEventListener(e,t,i)},removeEventListener(e,t,i){document.removeEventListener(e,t,i)},adoptNode:e=>document.adoptNode(e),createAttribute:e=>document.createAttribute(e),createElement:e=>document.createElement(e),createTextNode:e=>document.createTextNode(e),createComment:e=>document.createComment(e),createDocumentFragment:()=>document.createDocumentFragment(),createTemplateElement(){let e=document.createElement("template");return _FEATURE.ensureHTMLTemplateElement(e)},createMutationObserver:e=>new(window.MutationObserver||window.WebKitMutationObserver)(e),createCustomEvent:(e,t)=>new window.CustomEvent(e,t),dispatchEvent(e){document.dispatchEvent(e)},getComputedStyle:e=>window.getComputedStyle(e),getElementById:e=>document.getElementById(e),querySelector:e=>document.querySelector(e),querySelectorAll:e=>document.querySelectorAll(e),nextElementSibling(e){if(e.nextElementSibling)return e.nextElementSibling;do{e=e.nextSibling}while(e&&1!==e.nodeType);return e},createTemplateFromMarkup(e){let t=document.createElement("div");t.innerHTML=e;let i=t.firstElementChild;if(!i||"TEMPLATE"!==i.nodeName)throw new Error("Template markup must be wrapped in a <template> element e.g. <template> \x3c!-- markup here --\x3e </template>");return _FEATURE.ensureHTMLTemplateElement(i)},appendNode(e,t){(t||document.body).appendChild(e)},replaceNode(e,t,i){t.parentNode?t.parentNode.replaceChild(e,t):null!==shadowPoly?shadowPoly.unwrap(i).replaceChild(shadowPoly.unwrap(e),shadowPoly.unwrap(t)):i.replaceChild(e,t)},removeNode(e,t){e.parentNode?e.parentNode.removeChild(e):t&&(null!==shadowPoly?shadowPoly.unwrap(t).removeChild(shadowPoly.unwrap(e)):t.removeChild(e))},injectStyles(e,t,i,r){if(r){let t=document.getElementById(r);if(t){if("style"===t.tagName.toLowerCase())return void(t.innerHTML=e);throw new Error("The provided id does not indicate a style tag.")}}let n=document.createElement("style");return n.innerHTML=e,n.type="text/css",r&&(n.id=r),t=t||document.head,i&&t.childNodes.length>0?t.insertBefore(n,t.childNodes[0]):t.appendChild(n),n}};function initialize(){isInitialized||initializePAL((e,t,i)=>{Object.assign(e,_PLATFORM),Object.assign(t,_FEATURE),Object.assign(i,_DOM),Object.defineProperty(i,"title",{get:()=>document.title,set:e=>{document.title=e}}),Object.defineProperty(i,"activeElement",{get:()=>document.activeElement}),Object.defineProperty(e,"XMLHttpRequest",{get:()=>e.global.XMLHttpRequest})})}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function isObject(e){return e&&("function"==typeof e||"object"===(void 0===e?"undefined":_typeof$1(e)))}var metadata={resource:"aurelia:resource",paramTypes:"design:paramtypes",propertyType:"design:type",properties:"design:properties",get:function(e,t,i){if(isObject(t)){var r=metadata.getOwn(e,t,i);return void 0===r?metadata.get(e,Object.getPrototypeOf(t),i):r}},getOwn:function(e,t,i){if(isObject(t))return Reflect.getOwnMetadata(e,t,i)},define:function(e,t,i,r){Reflect.defineMetadata(e,t,i,r)},getOrCreateOwn:function(e,t,i,r){var n=metadata.getOwn(e,i,r);return void 0===n&&(n=new t,Reflect.defineMetadata(e,n,i,r)),n}},originStorage=new Map,unknownOrigin=Object.freeze({moduleId:void 0,moduleMember:void 0}),Origin=function(){function e(e,t){this.moduleId=e,this.moduleMember=t}return e.get=function(t){var i=originStorage.get(t);return void 0===i&&PLATFORM.eachModule(function(r,n){if("object"===(void 0===n?"undefined":_typeof$1(n)))for(var o in n)try{if(n[o]===t)return originStorage.set(t,i=new e(r,o)),!0}catch(e){}return n===t&&(originStorage.set(t,i=new e(r,"default")),!0)}),i||unknownOrigin},e.set=function(e,t){originStorage.set(e,t)},e}();function decorators(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=function(e,i,r){var n=t.length;if(i){for(r=r||{value:e[i],writable:!0,configurable:!0,enumerable:!0};n--;)r=t[n](e,i,r)||r;Object.defineProperty(e,i,r)}else for(;n--;)e=t[n](e)||e;return e};return r.on=r,r}function deprecated(e,t,i){function r(i,r,n){var o=i.constructor.name+"#"+r,s=t?{}:e||{},a="DEPRECATION - "+o;if("function"!=typeof n.value)throw new SyntaxError("Only methods can be marked as deprecated.");return s.message&&(a+=" - "+s.message),_extends({},n,{value:function(){if(s.error)throw new Error(a);return console.warn(a),n.value.apply(this,arguments)}})}return t?r(e,t,i):r}function mixin(e){var t=Object.keys(e);return function(i){var r=function(i){for(var r="function"==typeof i?i.prototype:i,n=t.length;n--;){var o=t[n];Object.defineProperty(r,o,{value:e[o],writable:!0})}};return i?r(i):r}}function alwaysValid(){return!0}function noCompose(){}function ensureProtocolOptions(e){return void 0===e?e={}:"function"==typeof e&&(e={validate:e}),e.validate||(e.validate=alwaysValid),e.compose||(e.compose=noCompose),e}function createProtocolValidator(e){return function(t){return!0===e(t)}}function createProtocolAsserter(e,t){return function(i){var r=t(i);if(!0!==r)throw new Error(r||e+" was not correctly implemented.")}}function protocol(e,t){t=ensureProtocolOptions(t);var i=function i(r){var n="function"==typeof r?r.prototype:r;t.compose(n),i.assert(n),Object.defineProperty(n,"protocol:"+e,{enumerable:!1,configurable:!1,writable:!1,value:!0})};return i.validate=createProtocolValidator(t.validate),i.assert=createProtocolAsserter(e,t.validate),i}protocol.create=function(e,t){t=ensureProtocolOptions(t);var i="protocol:"+e,r=function(i){var r=protocol(e,t);return i?r(i):r};return r.decorates=function(e){return!0===e[i]},r.validate=createProtocolValidator(t.validate),r.assert=createProtocolAsserter(e,t.validate),r};var _typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function trimDots(e){for(var t=0;t<e.length;++t){var i=e[t];if("."===i)e.splice(t,1),t-=1;else if(".."===i){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}}function relativeToFile(e,t){var i=t&&t.split("/"),r=e.trim().split("/");if("."===r[0].charAt(0)&&i){var n=i.slice(0,i.length-1);r.unshift.apply(r,n)}return trimDots(r),r.join("/")}function join(e,t){if(!e)return t;if(!t)return e;var i=e.match(/^([^\/]*?:)\//),r=i&&i.length>0?i[1]:"",n=void 0;n=0===(e=e.substr(r.length)).indexOf("///")&&"file:"===r?"///":0===e.indexOf("//")?"//":0===e.indexOf("/")?"/":"";for(var o="/"===t.slice(-1)?"/":"",s=e.split("/"),a=t.split("/"),l=[],c=0,u=s.length;c<u;++c)if(".."===s[c])l.pop();else{if("."===s[c]||""===s[c])continue;l.push(s[c])}for(var h=0,d=a.length;h<d;++h)if(".."===a[h])l.pop();else{if("."===a[h]||""===a[h])continue;l.push(a[h])}return r+n+l.join("/")+o}var encode=encodeURIComponent,encodeKey=function(e){return encode(e).replace("%24","$")};function buildParam(e,t,i){var r=[];if(null==t)return r;if(Array.isArray(t))for(var n=0,o=t.length;n<o;n++)if(i)r.push(encodeKey(e)+"="+encode(t[n]));else{var s=e+"["+("object"===_typeof$2(t[n])&&null!==t[n]?n:"")+"]";r=r.concat(buildParam(s,t[n]))}else if("object"!==(void 0===t?"undefined":_typeof$2(t))||i)r.push(encodeKey(e)+"="+encode(t));else for(var a in t)r=r.concat(buildParam(e+"["+a+"]",t[a]));return r}function buildQueryString(e,t){for(var i=[],r=Object.keys(e||{}).sort(),n=0,o=r.length;n<o;n++){var s=r[n];i=i.concat(buildParam(s,e[s],t))}return 0===i.length?"":i.join("&")}function processScalarParam(e,t){return Array.isArray(e)?(e.push(t),e):void 0!==e?[e,t]:t}function parseComplexParam(e,t,i){for(var r=e,n=t.length-1,o=0;o<=n;o++){var s=""===t[o]?r.length:t[o];if(o<n){var a=r[s]&&"object"!==_typeof$2(r[s])?[r[s]]:r[s];r=r[s]=a||(isNaN(t[o+1])?{}:[])}else r=r[s]=i}}function parseQueryString(e){var t={};if(!e||"string"!=typeof e)return t;var i=e;"?"===i.charAt(0)&&(i=i.substr(1));for(var r=i.replace(/\+/g," ").split("&"),n=0;n<r.length;n++){var o=r[n].split("="),s=decodeURIComponent(o[0]);if(s){var a=s.split("]["),l=a.length-1;if(/\[/.test(a[0])&&/\]$/.test(a[l])?(a[l]=a[l].replace(/\]$/,""),l=(a=a.shift().split("[").concat(a)).length-1):l=0,o.length>=2){var c=o[1]?decodeURIComponent(o[1]):"";l?parseComplexParam(t,a,c):t[s]=processScalarParam(t[s],c)}else t[s]=!0}}return t}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),TemplateDependency=function(e,t){this.src=e,this.name=t},TemplateRegistryEntry=function(){function e(e){this.templateIsLoaded=!1,this.factoryIsReady=!1,this.resources=null,this.dependencies=null,this.address=e,this.onReady=null,this._template=null,this._factory=null}return e.prototype.addDependency=function(e,t){var i="string"==typeof e?relativeToFile(e,this.address):Origin.get(e).moduleId;this.dependencies.push(new TemplateDependency(i,t))},_createClass(e,[{key:"template",get:function(){return this._template},set:function(e){var t,i=this.address,r=void 0,n=void 0,o=void 0;this._template=e,this.templateIsLoaded=!0,t=e.content.querySelectorAll("require"),o=this.dependencies=new Array(t.length);for(var s=0,a=t.length;s<a;++s){if(!(n=(r=t[s]).getAttribute("from")))throw new Error("<require> element in "+i+' has no "from" attribute.');o[s]=new TemplateDependency(relativeToFile(n,i),r.getAttribute("as")),r.parentNode&&r.parentNode.removeChild(r)}}},{key:"factory",get:function(){return this._factory},set:function(e){this._factory=e,this.factoryIsReady=!0}}]),e}(),Loader=function(){function e(){this.templateRegistry={}}return e.prototype.map=function(e,t){throw new Error("Loaders must implement map(id, source).")},e.prototype.normalizeSync=function(e,t){throw new Error("Loaders must implement normalizeSync(moduleId, relativeTo).")},e.prototype.normalize=function(e,t){throw new Error("Loaders must implement normalize(moduleId: string, relativeTo: string): Promise<string>.")},e.prototype.loadModule=function(e){throw new Error("Loaders must implement loadModule(id).")},e.prototype.loadAllModules=function(e){throw new Error("Loader must implement loadAllModules(ids).")},e.prototype.loadTemplate=function(e){throw new Error("Loader must implement loadTemplate(url).")},e.prototype.loadText=function(e){throw new Error("Loader must implement loadText(url).")},e.prototype.applyPluginToUrl=function(e,t){throw new Error("Loader must implement applyPluginToUrl(url, pluginName).")},e.prototype.addPlugin=function(e,t){throw new Error("Loader must implement addPlugin(pluginName, implementation).")},e.prototype.getOrCreateTemplateRegistryEntry=function(e){return this.templateRegistry[e]||(this.templateRegistry[e]=new TemplateRegistryEntry(e))},e}();class TextTemplateLoader{async loadTemplate(e,t){const i=await e.loadText(t.address);t.template=DOM.createTemplateFromMarkup(i)}}function ensureOriginOnExports(e,t){let i,r,n=e;if(Origin.set(n,new Origin(t,"")),"object"==typeof n)for(i in n)"function"==typeof(r=n[i])&&Origin.set(r,new Origin(t,i));return e}class EsmLoader extends Loader{constructor(){super(),this.moduleRegistry=Object.create(null),this.loaderPlugins=Object.create(null),this.modulesBeingLoaded=new Map,this.baseUrl=location.origin||`${location.protocol}//${location.hostname}${location.port?`:${location.port}`:""}`,this.useTemplateLoader(new TextTemplateLoader),this.addPlugin("template-registry-entry",{fetch:async e=>{const t=this.getOrCreateTemplateRegistryEntry(e);return t.templateIsLoaded||await this.templateLoader.loadTemplate(this,t),t}}),PLATFORM.eachModule=(e=>{const t=this.moduleRegistry;Object.getOwnPropertyNames(t).some(i=>{const r=t[i].exports;return"object"==typeof r&&e(i,r)})})}async _import(e){const t=e.split("!"),i=t.splice(t.length-1,1)[0],r=1===t.length?t[0]:null;if(r){const e=this.loaderPlugins[r];if(!e)throw new Error(`Plugin ${r} is not registered in the loader.`);return await e.fetch(i)}return import(join(this.baseUrl,i)).then(e=>(this.moduleRegistry[i]=e,e))}map(e,t){}normalizeSync(e,t){return e}normalize(e,t){return Promise.resolve(e)}useTemplateLoader(e){this.templateLoader=e}loadAllModules(e){return Promise.all(e.map(e=>this.loadModule(e)))}async loadModule(e){let t=this.moduleRegistry[e];if(t)return t;let i=this.modulesBeingLoaded.get(e);if(i)return i;i=this._import(e),this.modulesBeingLoaded.set(e,i);const r=await i;return this.moduleRegistry[e]=ensureOriginOnExports(r,e),this.modulesBeingLoaded.delete(e),r}loadTemplate(e){return this.loadModule(this.applyPluginToUrl(e,"template-registry-entry"))}async loadText(e){return fetch(e).then(e=>e.text())}applyPluginToUrl(e,t){return`${t}!${e}`}addPlugin(e,t){this.loaderPlugins[e]=t}}PLATFORM.Loader=EsmLoader;var logLevel={none:0,error:10,warn:20,info:30,debug:40},loggers={},appenders=[],globalDefaultLevel=logLevel.none,standardLevels=["none","error","warn","info","debug"];function isStandardLevel(e){return standardLevels.filter(function(t){return t===e}).length>0}function appendArgs(){return[this].concat(Array.prototype.slice.call(arguments))}function logFactory(e){var t=logLevel[e];return function(){if(!(this.level<t))for(var i=appendArgs.apply(this,arguments),r=appenders.length;r--;){var n;(n=appenders[r])[e].apply(n,i)}}}function logFactoryCustom(e){var t=logLevel[e];return function(){if(!(this.level<t))for(var i=appendArgs.apply(this,arguments),r=appenders.length;r--;){var n=appenders[r];void 0!==n[e]&&n[e].apply(n,i)}}}function connectLoggers(){var e=Logger.prototype;for(var t in logLevel)isStandardLevel(t)?"none"!==t&&(e[t]=logFactory(t)):e[t]=logFactoryCustom(t)}function disconnectLoggers(){var e=Logger.prototype;for(var t in logLevel)"none"!==t&&(e[t]=function(){})}function getLogger(e){return loggers[e]||new Logger(e)}function addAppender(e){1===appenders.push(e)&&connectLoggers()}function removeAppender(e){appenders=appenders.filter(function(t){return t!==e})}function getAppenders(){return[].concat(appenders)}function clearAppenders(){appenders=[],disconnectLoggers()}function addCustomLevel(e,t){if(void 0!==logLevel[e])throw Error('Log level "'+e+'" already exists.');if(isNaN(t))throw Error("Value must be a number.");logLevel[e]=t,appenders.length>0?connectLoggers():Logger.prototype[e]=function(){}}function removeCustomLevel(e){if(void 0!==logLevel[e]){if(isStandardLevel(e))throw Error('Built-in log level "'+e+'" cannot be removed.');delete logLevel[e],delete Logger.prototype[e]}}function setLevel(e){for(var t in globalDefaultLevel=e,loggers)loggers[t].setLevel(e)}function getLevel(){return globalDefaultLevel}var _dec,_class,_dec2,_class2,_dec3,_class3,_dec4,_class4,_dec5,_class5,_dec6,_class6,_dec7,_class7,Logger=function(){function e(e){var t=loggers[e];if(t)return t;loggers[e]=this,this.id=e,this.level=globalDefaultLevel}return e.prototype.debug=function(e){},e.prototype.info=function(e){},e.prototype.warn=function(e){},e.prototype.error=function(e){},e.prototype.setLevel=function(e){this.level=e},e.prototype.isDebugEnabled=function(){return this.level===logLevel.debug},e}(),TheLogManager=Object.freeze({logLevel,getLogger,addAppender,removeAppender,getAppenders,clearAppenders,addCustomLevel,removeCustomLevel,setLevel,getLevel,Logger});const resolver=protocol.create("aurelia:resolver",function(e){return"function"==typeof e.get||"Resolvers must implement: get(container: Container, key: any): any"});let StrategyResolver=(_dec=resolver())(_class=class{constructor(e,t){this.strategy=e,this.state=t}get(e,t){switch(this.strategy){case 0:return this.state;case 1:let i=e.invoke(this.state);return this.state=i,this.strategy=0,i;case 2:return e.invoke(this.state);case 3:return this.state(e,t,this);case 4:return this.state[0].get(e,t);case 5:return e.get(this.state);default:throw new Error("Invalid strategy: "+this.strategy)}}})||_class,Lazy=(_dec2=resolver())(_class2=class e{constructor(e){this._key=e}get(e){return()=>e.get(this._key)}static of(t){return new e(t)}})||_class2,All=(_dec3=resolver())(_class3=class e{constructor(e){this._key=e}get(e){return e.getAll(this._key)}static of(t){return new e(t)}})||_class3,Optional=(_dec4=resolver())(_class4=class e{constructor(e,t=!0){this._key=e,this._checkParent=t}get(e){return e.hasResolver(this._key,this._checkParent)?e.get(this._key):null}static of(t,i=!0){return new e(t,i)}})||_class4,Parent=(_dec5=resolver())(_class5=class e{constructor(e){this._key=e}get(e){return e.parent?e.parent.get(this._key):null}static of(t){return new e(t)}})||_class5,Factory=(_dec6=resolver())(_class6=class e{constructor(e){this._key=e}get(e){let t=this._key,i=e.getResolver(t);return i&&3===i.strategy&&(t=i.state),(...i)=>e.invoke(t,i)}static of(t){return new e(t)}})||_class6,NewInstance=(_dec7=resolver())(_class7=class e{constructor(e,...t){this.key=e,this.asKey=e,this.dynamicDependencies=t}get(e){let t=this.dynamicDependencies.length>0?this.dynamicDependencies.map(t=>t["protocol:aurelia:resolver"]?t.get(e):e.get(t)):void 0,i=this.key,r=e.getResolver(i);r&&3===r.strategy&&(i=r.state);const n=e.invoke(i,t);return e.registerInstance(this.asKey,n),n}as(e){return this.asKey=e,this}static of(t,...i){return new e(t,...i)}})||_class7;function getDecoratorDependencies(e){return autoinject(e),e.inject}function lazy(e){return function(t,i,r){getDecoratorDependencies(t)[r]=Lazy.of(e)}}function all(e){return function(t,i,r){getDecoratorDependencies(t)[r]=All.of(e)}}function optional(e=!0){let t=function(e){return function(t,i,r){let n=getDecoratorDependencies(t);n[r]=Optional.of(n[r],e)}};return t("boolean"!=typeof e||e)}function parent(e,t,i){let r=getDecoratorDependencies(e);r[i]=Parent.of(r[i])}function factory(e){return function(t,i,r){getDecoratorDependencies(t)[r]=Factory.of(e)}}function newInstance(e,...t){let i=function(e){return function(i,r,n){let o=getDecoratorDependencies(i);o[n]=NewInstance.of(o[n],...t),e&&o[n].as(e)}};return arguments.length>=1?i(e):i()}function invoker(e){return function(t){metadata.define(metadata.invoker,e,t)}}function invokeAsFactory(e){let t=function(e){metadata.define(metadata.invoker,FactoryInvoker.instance,e)};return e?t(e):t}let FactoryInvoker=class{invoke(e,t,i){let r=i.length,n=new Array(r);for(;r--;)n[r]=e.get(i[r]);return t.apply(void 0,n)}invokeWithDynamicDependencies(e,t,i,r){let n=i.length,o=new Array(n);for(;n--;)o[n]=e.get(i[n]);return void 0!==r&&(o=o.concat(r)),t.apply(void 0,o)}};function registration(e){return function(t){metadata.define(metadata.registration,e,t)}}function transient(e){return registration(new TransientRegistration(e))}function singleton(e,t=!1){return registration(new SingletonRegistration(e,t))}FactoryInvoker.instance=new FactoryInvoker;let TransientRegistration=class{constructor(e){this._key=e}registerResolver(e,t,i){let r=e.getResolver(this._key||t);return void 0===r?e.registerTransient(this._key||t,i):r}},SingletonRegistration=class{constructor(e,t=!1){"boolean"==typeof e?this._registerInChild=e:(this._key=e,this._registerInChild=t)}registerResolver(e,t,i){let r=this._registerInChild?e:e.root,n=r.getResolver(this._key||t);return void 0===n?r.registerSingleton(this._key||t,i):n}};function validateKey(e){if(null==e)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}const _emptyParameters=Object.freeze([]);metadata.registration="aurelia:registration",metadata.invoker="aurelia:invoker";let resolverDecorates=resolver.decorates,InvocationHandler=class{constructor(e,t,i){this.fn=e,this.invoker=t,this.dependencies=i}invoke(e,t){return void 0!==t?this.invoker.invokeWithDynamicDependencies(e,this.fn,this.dependencies,t):this.invoker.invoke(e,this.fn,this.dependencies)}};function invokeWithDynamicDependencies(e,t,i,r){let n,o=i.length,s=new Array(o);for(;o--;){if(null==(n=i[o]))throw new Error("Constructor Parameter with index "+o+" cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?");s[o]=e.get(n)}return void 0!==r&&(s=s.concat(r)),Reflect.construct(t,s)}let classInvokers={0:{invoke:(e,t)=>new t,invokeWithDynamicDependencies},1:{invoke:(e,t,i)=>new t(e.get(i[0])),invokeWithDynamicDependencies},2:{invoke:(e,t,i)=>new t(e.get(i[0]),e.get(i[1])),invokeWithDynamicDependencies},3:{invoke:(e,t,i)=>new t(e.get(i[0]),e.get(i[1]),e.get(i[2])),invokeWithDynamicDependencies},4:{invoke:(e,t,i)=>new t(e.get(i[0]),e.get(i[1]),e.get(i[2]),e.get(i[3])),invokeWithDynamicDependencies},5:{invoke:(e,t,i)=>new t(e.get(i[0]),e.get(i[1]),e.get(i[2]),e.get(i[3]),e.get(i[4])),invokeWithDynamicDependencies},fallback:{invoke:invokeWithDynamicDependencies,invokeWithDynamicDependencies}};function getDependencies(e){return e.hasOwnProperty("inject")?"function"==typeof e.inject?e.inject():e.inject:[]}let Container=class e{constructor(e){void 0===e&&(e={}),this._configuration=e,this._onHandlerCreated=e.onHandlerCreated,this._handlers=e.handlers||(e.handlers=new Map),this._resolvers=new Map,this.root=this,this.parent=null}makeGlobal(){return e.instance=this,this}setHandlerCreatedCallback(e){this._onHandlerCreated=e,this._configuration.onHandlerCreated=e}registerInstance(e,t){return this.registerResolver(e,new StrategyResolver(0,void 0===t?e:t))}registerSingleton(e,t){return this.registerResolver(e,new StrategyResolver(1,void 0===t?e:t))}registerTransient(e,t){return this.registerResolver(e,new StrategyResolver(2,void 0===t?e:t))}registerHandler(e,t){return this.registerResolver(e,new StrategyResolver(3,t))}registerAlias(e,t){return this.registerResolver(t,new StrategyResolver(5,e))}registerResolver(e,t){validateKey(e);let i=this._resolvers,r=i.get(e);return void 0===r?i.set(e,t):4===r.strategy?r.state.push(t):i.set(e,new StrategyResolver(4,[r,t])),t}autoRegister(e,t){if("function"==typeof(t=void 0===t?e:t)){let i=metadata.get(metadata.registration,t);return void 0===i?this.registerResolver(e,new StrategyResolver(1,t)):i.registerResolver(this,e,t)}return this.registerResolver(e,new StrategyResolver(0,t))}autoRegisterAll(e){let t=e.length;for(;t--;)this.autoRegister(e[t])}unregister(e){this._resolvers.delete(e)}hasResolver(e,t=!1){return validateKey(e),this._resolvers.has(e)||t&&null!==this.parent&&this.parent.hasResolver(e,t)}getResolver(e){return this._resolvers.get(e)}get(t){if(validateKey(t),t===e)return this;if(resolverDecorates(t))return t.get(this,t);let i=this._resolvers.get(t);if(void 0===i){if(null===this.parent)return this.autoRegister(t).get(this,t);let e=metadata.get(metadata.registration,t);return void 0===e?this.parent._get(t):e.registerResolver(this,t,t).get(this,t)}return i.get(this,t)}_get(e){let t=this._resolvers.get(e);return void 0===t?null===this.parent?this.autoRegister(e).get(this,e):this.parent._get(e):t.get(this,e)}getAll(e){validateKey(e);let t=this._resolvers.get(e);if(void 0===t)return null===this.parent?_emptyParameters:this.parent.getAll(e);if(4===t.strategy){let i=t.state,r=i.length,n=new Array(r);for(;r--;)n[r]=i[r].get(this,e);return n}return[t.get(this,e)]}createChild(){let t=new e(this._configuration);return t.root=this.root,t.parent=this,t}invoke(e,t){try{let i=this._handlers.get(e);return void 0===i&&(i=this._createInvocationHandler(e),this._handlers.set(e,i)),i.invoke(this,t)}catch(t){throw new AggregateError(`Error invoking ${e.name}. Check the inner error for details.`,t,!0)}}_createInvocationHandler(e){let t;if(void 0===e.inject)t=metadata.getOwn(metadata.paramTypes,e)||_emptyParameters;else{t=[];let i=e;for(;"function"==typeof i;)t.push(...getDependencies(i)),i=Object.getPrototypeOf(i)}let i=metadata.getOwn(metadata.invoker,e)||classInvokers[t.length]||classInvokers.fallback,r=new InvocationHandler(e,i,t);return void 0!==this._onHandlerCreated?this._onHandlerCreated(r):r}};function autoinject(e){let t=function(e){e.hasOwnProperty("inject")||(e.inject=(metadata.getOwn(metadata.paramTypes,e)||_emptyParameters).slice(),e.inject.length>0&&e.inject[e.inject.length-1]===Object&&e.inject.pop())};return e?t(e):t}function inject(...e){return function(t,i,r){if("number"==typeof r)return autoinject(t),void(1===e.length&&(t.inject[r]=e[0]));if(r){r.value.inject=e}else t.inject=e}}var _typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},stackSeparator="\nEnqueued in TaskQueue by:\n",microStackSeparator="\nEnqueued in MicroTaskQueue by:\n";function makeRequestFlushFromMutationObserver(e){var t=DOM.createMutationObserver(e),i="a",r=DOM.createTextNode("a"),n=Object.create(null);return n.a="b",n.b="a",t.observe(r,{characterData:!0}),function(){r.data=i=n[i]}}function makeRequestFlushFromTimer(e){return function(){var t=setTimeout(r,0),i=setInterval(r,50);function r(){clearTimeout(t),clearInterval(i),e()}}}function onError(e,t,i){i&&t.stack&&"object"===(void 0===e?"undefined":_typeof$3(e))&&null!==e&&(e.stack=filterFlushStack(e.stack)+t.stack),"onError"in t?t.onError(e):setTimeout(function(){throw e},0)}var TaskQueue=function(){function e(){var e=this;this.flushing=!1,this.longStacks=!1,this.microTaskQueue=[],this.microTaskQueueCapacity=1024,this.taskQueue=[],FEATURE.mutationObserver?this.requestFlushMicroTaskQueue=makeRequestFlushFromMutationObserver(function(){return e.flushMicroTaskQueue()}):this.requestFlushMicroTaskQueue=makeRequestFlushFromTimer(function(){return e.flushMicroTaskQueue()}),this.requestFlushTaskQueue=makeRequestFlushFromTimer(function(){return e.flushTaskQueue()})}return e.prototype._flushQueue=function(e,t){var i=0,r=void 0;try{for(this.flushing=!0;i<e.length;)if(r=e[i],this.longStacks&&(this.stack="string"==typeof r.stack?r.stack:void 0),r.call(),++i>t){for(var n=0,o=e.length-i;n<o;n++)e[n]=e[n+i];e.length-=i,i=0}}catch(e){onError(e,r,this.longStacks)}finally{this.flushing=!1}},e.prototype.queueMicroTask=function(e){this.microTaskQueue.length<1&&this.requestFlushMicroTaskQueue(),this.longStacks&&(e.stack=this.prepareQueueStack(microStackSeparator)),this.microTaskQueue.push(e)},e.prototype.queueTask=function(e){this.taskQueue.length<1&&this.requestFlushTaskQueue(),this.longStacks&&(e.stack=this.prepareQueueStack(stackSeparator)),this.taskQueue.push(e)},e.prototype.flushTaskQueue=function(){var e=this.taskQueue;this.taskQueue=[],this._flushQueue(e,Number.MAX_VALUE)},e.prototype.flushMicroTaskQueue=function(){var e=this.microTaskQueue;this._flushQueue(e,this.microTaskQueueCapacity),e.length=0},e.prototype.prepareQueueStack=function(e){var t=e+filterQueueStack(captureStack());return"string"==typeof this.stack&&(t=filterFlushStack(t)+this.stack),t},e}();function captureStack(){var e=new Error;if(e.stack)return e.stack;try{throw e}catch(e){return e.stack}}function filterQueueStack(e){return e.replace(/^[\s\S]*?\bqueue(Micro)?Task\b[^\n]*\n/,"")}function filterFlushStack(e){var t=e.lastIndexOf("flushMicroTaskQueue");return t<0&&(t=e.lastIndexOf("flushTaskQueue"))<0?e:(t=e.lastIndexOf("\n",t))<0?e:e.substr(0,t)}var _dec$1,_dec2$1,_class$1,_dec3$1,_class2$1,_dec4$1,_class3$1,_dec5$1,_class5$1,_dec6$1,_class7$1,_dec7$1,_class8,_dec8,_class9,_dec9,_class10,_class12,_temp,_dec10,_class13,_class14,_temp2,_createClass$1=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var targetContext="Binding:target",sourceContext="Binding:source",map=Object.create(null);function camelCase(e){if(e in map)return map[e];var t=e.charAt(0).toLowerCase()+e.slice(1).replace(/[_.-](\w|$)/g,function(e,t){return t.toUpperCase()});return map[e]=t,t}function createOverrideContext(e,t){return{bindingContext:e,parentOverrideContext:t||null}}function getContextFor(e,t,i){var r=t.overrideContext;if(i){for(;i&&r;)i--,r=r.parentOverrideContext;if(i||!r)return;return e in r?r:r.bindingContext}for(;r&&!(e in r)&&!(r.bindingContext&&e in r.bindingContext);)r=r.parentOverrideContext;return r?e in r?r:r.bindingContext:t.bindingContext||t.overrideContext}function createScopeForTest(e,t){return t?{bindingContext:e,overrideContext:createOverrideContext(e,createOverrideContext(t))}:{bindingContext:e,overrideContext:createOverrideContext(e)}}for(var slotNames=[],versionSlotNames=[],i=0;i<100;i++)slotNames.push("_observer"+i),versionSlotNames.push("_observerVersion"+i);function addObserver(e){for(var t=void 0===this._observerSlots?0:this._observerSlots,i=t;i--&&this[slotNames[i]]!==e;);if(-1===i){for(i=0;this[slotNames[i]];)i++;this[slotNames[i]]=e,e.subscribe(sourceContext,this),i===t&&(this._observerSlots=i+1)}void 0===this._version&&(this._version=0),this[versionSlotNames[i]]=this._version}function observeProperty(e,t){var i=this.observerLocator.getObserver(e,t);addObserver.call(this,i)}function observeArray(e){var t=this.observerLocator.getArrayObserver(e);addObserver.call(this,t)}function unobserve(e){for(var t=this._observerSlots;t--;)if(e||this[versionSlotNames[t]]!==this._version){var i=this[slotNames[t]];this[slotNames[t]]=null,i&&i.unsubscribe(sourceContext,this)}}function connectable(){return function(e){e.prototype.observeProperty=observeProperty,e.prototype.observeArray=observeArray,e.prototype.unobserve=unobserve,e.prototype.addObserver=addObserver}}var queue=[],queued={},nextId=0,minimumImmediate=100,frameBudget=15,isFlushRequested=!1,immediate=0;function flush(e){for(var t=queue.length,i=0;i<t;){var r=queue[i];if(queued[r.__connectQueueId]=!1,r.connect(!0),++i%100==0&&PLATFORM.performance.now()-e>frameBudget)break}queue.splice(0,i),queue.length?PLATFORM.requestAnimationFrame(flush):(isFlushRequested=!1,immediate=0)}function enqueueBindingConnect(e){if(immediate<minimumImmediate)immediate++,e.connect(!1);else{var t=e.__connectQueueId;void 0===t&&(t=nextId,nextId++,e.__connectQueueId=t),queued[t]||(queue.push(e),queued[t]=!0)}isFlushRequested||(isFlushRequested=!0,PLATFORM.requestAnimationFrame(flush))}function setConnectQueueThreshold(e){minimumImmediate=e}function enableConnectQueue(){setConnectQueueThreshold(100)}function disableConnectQueue(){setConnectQueueThreshold(Number.MAX_SAFE_INTEGER)}function getConnectQueueSize(){return queue.length}function addSubscriber(e,t){return!this.hasSubscriber(e,t)&&(this._context0?this._context1?this._context2?this._contextsRest?(this._contextsRest.push(e),this._callablesRest.push(t),!0):(this._contextsRest=[e],this._callablesRest=[t],!0):(this._context2=e,this._callable2=t,!0):(this._context1=e,this._callable1=t,!0):(this._context0=e,this._callable0=t,!0))}function removeSubscriber(e,t){if(this._context0===e&&this._callable0===t)return this._context0=null,this._callable0=null,!0;if(this._context1===e&&this._callable1===t)return this._context1=null,this._callable1=null,!0;if(this._context2===e&&this._callable2===t)return this._context2=null,this._callable2=null,!0;var i=this._callablesRest;if(void 0===i||0===i.length)return!1;for(var r=this._contextsRest,n=0;(i[n]!==t||r[n]!==e)&&i.length>n;)n++;return!(n>=i.length)&&(r.splice(n,1),i.splice(n,1),!0)}var arrayPool1=[],arrayPool2=[],poolUtilization=[];function callSubscribers(e,t){var i=this._context0,r=this._callable0,n=this._context1,o=this._callable1,s=this._context2,a=this._callable2,l=this._contextsRest?this._contextsRest.length:0,c=void 0,u=void 0,h=void 0,d=void 0;if(l){for(h=poolUtilization.length;h--&&poolUtilization[h];);for(h<0?(h=poolUtilization.length,c=[],u=[],poolUtilization.push(!0),arrayPool1.push(c),arrayPool2.push(u)):(poolUtilization[h]=!0,c=arrayPool1[h],u=arrayPool2[h]),d=l;d--;)c[d]=this._contextsRest[d],u[d]=this._callablesRest[d]}if(i&&(r?r.call(i,e,t):i(e,t)),n&&(o?o.call(n,e,t):n(e,t)),s&&(a?a.call(s,e,t):s(e,t)),l){for(d=0;d<l;d++){var p=u[d],f=c[d];p?p.call(f,e,t):f(e,t),c[d]=null,u[d]=null}poolUtilization[h]=!1}}function hasSubscribers(){return!!(this._context0||this._context1||this._context2||this._contextsRest&&this._contextsRest.length)}function hasSubscriber(e,t){if(this._context0===e&&this._callable0===t||this._context1===e&&this._callable1===t||this._context2===e&&this._callable2===t)return!0;var i=void 0,r=this._contextsRest;if(!r||0===(i=r.length))return!1;for(var n=this._callablesRest;i--;)if(r[i]===e&&n[i]===t)return!0;return!1}function subscriberCollection(){return function(e){e.prototype.addSubscriber=addSubscriber,e.prototype.removeSubscriber=removeSubscriber,e.prototype.callSubscribers=callSubscribers,e.prototype.hasSubscribers=hasSubscribers,e.prototype.hasSubscriber=hasSubscriber}}var ExpressionObserver=(_dec$1=connectable())(_class$1=(_dec2$1=subscriberCollection())(_class$1=function(){function e(e,t,i,r){this.scope=e,this.expression=t,this.observerLocator=i,this.lookupFunctions=r}return e.prototype.getValue=function(){return this.expression.evaluate(this.scope,this.lookupFunctions)},e.prototype.setValue=function(e){this.expression.assign(this.scope,e)},e.prototype.subscribe=function(e,t){var i=this;if(this.hasSubscribers()||(this.oldValue=this.expression.evaluate(this.scope,this.lookupFunctions),this.expression.connect(this,this.scope)),this.addSubscriber(e,t),1===arguments.length&&e instanceof Function)return{dispose:function(){i.unsubscribe(e,t)}}},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&(this.unobserve(!0),this.oldValue=void 0)},e.prototype.call=function(){var e=this.expression.evaluate(this.scope,this.lookupFunctions),t=this.oldValue;e!==t&&(this.oldValue=e,this.callSubscribers(e,t)),this._version++,this.expression.connect(this,this.scope),this.unobserve(!1)},e}())||_class$1)||_class$1;function isIndex(e){return+e==e>>>0}function toNumber(e){return+e}function newSplice(e,t,i){return{index:e,removed:t,addedCount:i}}var EDIT_LEAVE=0,EDIT_UPDATE=1,EDIT_ADD=2,EDIT_DELETE=3;function ArraySplice(){}ArraySplice.prototype={calcEditDistances:function(e,t,i,r,n,o){for(var s=o-n+1,a=i-t+1,l=new Array(s),c=void 0,u=void 0,h=0;h<s;++h)l[h]=new Array(a),l[h][0]=h;for(var d=0;d<a;++d)l[0][d]=d;for(var p=1;p<s;++p)for(var f=1;f<a;++f)this.equals(e[t+f-1],r[n+p-1])?l[p][f]=l[p-1][f-1]:(c=l[p-1][f]+1,u=l[p][f-1]+1,l[p][f]=c<u?c:u);return l},spliceOperationsFromEditDistances:function(e){for(var t=e.length-1,i=e[0].length-1,r=e[t][i],n=[];t>0||i>0;)if(0!==t)if(0!==i){var o=e[t-1][i-1],s=e[t-1][i],a=e[t][i-1],l=void 0;(l=s<a?s<o?s:o:a<o?a:o)===o?(o===r?n.push(EDIT_LEAVE):(n.push(EDIT_UPDATE),r=o),t--,i--):l===s?(n.push(EDIT_DELETE),t--,r=s):(n.push(EDIT_ADD),i--,r=a)}else n.push(EDIT_DELETE),t--;else n.push(EDIT_ADD),i--;return n.reverse(),n},calcSplices:function(e,t,i,r,n,o){var s=0,a=0,l=Math.min(i-t,o-n);if(0===t&&0===n&&(s=this.sharedPrefix(e,r,l)),i===e.length&&o===r.length&&(a=this.sharedSuffix(e,r,l-s)),n+=s,o-=a,(i-=a)-(t+=s)==0&&o-n==0)return[];if(t===i){for(var c=newSplice(t,[],0);n<o;)c.removed.push(r[n++]);return[c]}if(n===o)return[newSplice(t,[],i-t)];for(var u=this.spliceOperationsFromEditDistances(this.calcEditDistances(e,t,i,r,n,o)),h=void 0,d=[],p=t,f=n,v=0;v<u.length;++v)switch(u[v]){case EDIT_LEAVE:h&&(d.push(h),h=void 0),p++,f++;break;case EDIT_UPDATE:h||(h=newSplice(p,[],0)),h.addedCount++,p++,h.removed.push(r[f]),f++;break;case EDIT_ADD:h||(h=newSplice(p,[],0)),h.addedCount++,p++;break;case EDIT_DELETE:h||(h=newSplice(p,[],0)),h.removed.push(r[f]),f++}return h&&d.push(h),d},sharedPrefix:function(e,t,i){for(var r=0;r<i;++r)if(!this.equals(e[r],t[r]))return r;return i},sharedSuffix:function(e,t,i){for(var r=e.length,n=t.length,o=0;o<i&&this.equals(e[--r],t[--n]);)o++;return o},calculateSplices:function(e,t){return this.calcSplices(e,0,e.length,t,0,t.length)},equals:function(e,t){return e===t}};var arraySplice=new ArraySplice;function calcSplices(e,t,i,r,n,o){return arraySplice.calcSplices(e,t,i,r,n,o)}function intersect(e,t,i,r){return t<i||r<e?-1:t===i||r===e?0:e<i?t<r?t-i:r-i:r<t?r-e:t-e}function mergeSplice(e,t,i,r){for(var n=newSplice(t,i,r),o=!1,s=0,a=0;a<e.length;a++){var l=e[a];if(l.index+=s,!o){var c=intersect(n.index,n.index+n.removed.length,l.index,l.index+l.addedCount);if(c>=0){e.splice(a,1),a--,s-=l.addedCount-l.removed.length,n.addedCount+=l.addedCount-c;var u=n.removed.length+l.removed.length-c;if(n.addedCount||u){var h=l.removed;if(n.index<l.index){var d=n.removed.slice(0,l.index-n.index);Array.prototype.push.apply(d,h),h=d}if(n.index+n.removed.length>l.index+l.addedCount){var p=n.removed.slice(l.index+l.addedCount-n.index);Array.prototype.push.apply(h,p)}n.removed=h,l.index<n.index&&(n.index=l.index)}else o=!0}else if(n.index<l.index){o=!0,e.splice(a,0,n),a++;var f=n.addedCount-n.removed.length;l.index+=f,s+=f}}}o||e.push(n)}function createInitialSplices(e,t){for(var i=[],r=0;r<t.length;r++){var n=t[r];switch(n.type){case"splice":mergeSplice(i,n.index,n.removed.slice(),n.addedCount);break;case"add":case"update":case"delete":if(!isIndex(n.name))continue;var o=toNumber(n.name);if(o<0)continue;mergeSplice(i,o,[n.oldValue],"delete"===n.type?0:1);break;default:console.error("Unexpected record type: "+JSON.stringify(n))}}return i}function projectArraySplices(e,t){var i=[];return createInitialSplices(e,t).forEach(function(t){1!==t.addedCount||1!==t.removed.length?i=i.concat(calcSplices(e,t.index,t.index+t.addedCount,t.removed,0,t.removed.length)):t.removed[0]!==e[t.index]&&i.push(t)}),i}function newRecord(e,t,i,r){return{type:e,object:t,key:i,oldValue:r}}function getChangeRecords(e){for(var t=new Array(e.size),i=e.keys(),r=0,n=void 0;(n=i.next())&&!n.done;)t[r]=newRecord("added",e,n.value),r++;return t}var ModifyCollectionObserver=(_dec3$1=subscriberCollection())(_class2$1=function(){function e(e,t){this.taskQueue=e,this.queued=!1,this.changeRecords=null,this.oldCollection=null,this.collection=t,this.lengthPropertyName=t instanceof Map||t instanceof Set?"size":"length"}return e.prototype.subscribe=function(e,t){this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)},e.prototype.addChangeRecord=function(e){if(this.hasSubscribers()||this.lengthObserver){if("splice"===e.type){var t=e.index,i=e.object.length;t>i?t=i-e.addedCount:t<0&&(t=i+e.removed.length+t-e.addedCount),t<0&&(t=0),e.index=t}null===this.changeRecords?this.changeRecords=[e]:this.changeRecords.push(e),this.queued||(this.queued=!0,this.taskQueue.queueMicroTask(this))}},e.prototype.flushChangeRecords=function(){(this.changeRecords&&this.changeRecords.length||this.oldCollection)&&this.call()},e.prototype.reset=function(e){this.oldCollection=e,this.hasSubscribers()&&!this.queued&&(this.queued=!0,this.taskQueue.queueMicroTask(this))},e.prototype.getLengthObserver=function(){return this.lengthObserver||(this.lengthObserver=new CollectionLengthObserver(this.collection))},e.prototype.call=function(){var e=this.changeRecords,t=this.oldCollection,i=void 0;this.queued=!1,this.changeRecords=[],this.oldCollection=null,this.hasSubscribers()&&(i=t?this.collection instanceof Map||this.collection instanceof Set?getChangeRecords(t):calcSplices(this.collection,0,this.collection.length,t,0,t.length):this.collection instanceof Map||this.collection instanceof Set?e:projectArraySplices(this.collection,e),this.callSubscribers(i)),this.lengthObserver&&this.lengthObserver.call(this.collection[this.lengthPropertyName])},e}())||_class2$1,CollectionLengthObserver=(_dec4$1=subscriberCollection())(_class3$1=function(){function e(e){this.collection=e,this.lengthPropertyName=e instanceof Map||e instanceof Set?"size":"length",this.currentValue=e[this.lengthPropertyName]}return e.prototype.getValue=function(){return this.collection[this.lengthPropertyName]},e.prototype.setValue=function(e){this.collection[this.lengthPropertyName]=e},e.prototype.subscribe=function(e,t){this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)},e.prototype.call=function(e){var t=this.currentValue;this.callSubscribers(e,t),this.currentValue=e},e}())||_class3$1,arrayProto=Array.prototype,pop=arrayProto.pop,push=arrayProto.push,reverse=arrayProto.reverse,shift=arrayProto.shift,sort=arrayProto.sort,splice=arrayProto.splice,unshift=arrayProto.unshift;function _getArrayObserver(e,t){return ModifyArrayObserver.for(e,t)}arrayProto.__au_patched__?getLogger("array-observation").warn("Detected 2nd attempt of patching array from Aurelia binding. This is probably caused by dependency mismatch between core modules and a 3rd party plugin. Please see https://github.com/aurelia/cli/pull/906 if you are using webpack."):(Reflect.defineProperty(arrayProto,"__au_patched__",{value:1}),arrayProto.pop=function(){var e=this.length>0,t=pop.apply(this,arguments);return e&&void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"delete",object:this,name:this.length,oldValue:t}),t},arrayProto.push=function(){var e=push.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"splice",object:this,index:this.length-arguments.length,removed:[],addedCount:arguments.length}),e},arrayProto.reverse=function(){var e=void 0;void 0!==this.__array_observer__&&(this.__array_observer__.flushChangeRecords(),e=this.slice());var t=reverse.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.reset(e),t},arrayProto.shift=function(){var e=this.length>0,t=shift.apply(this,arguments);return e&&void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"delete",object:this,name:0,oldValue:t}),t},arrayProto.sort=function(){var e=void 0;void 0!==this.__array_observer__&&(this.__array_observer__.flushChangeRecords(),e=this.slice());var t=sort.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.reset(e),t},arrayProto.splice=function(){var e=splice.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"splice",object:this,index:+arguments[0],removed:e,addedCount:arguments.length>2?arguments.length-2:0}),e},arrayProto.unshift=function(){var e=unshift.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"splice",object:this,index:0,removed:[],addedCount:arguments.length}),e});var ModifyArrayObserver=function(e){function t(t,i){return _possibleConstructorReturn(this,e.call(this,t,i))}return _inherits(t,e),t.for=function(e,i){return"__array_observer__"in i||Reflect.defineProperty(i,"__array_observer__",{value:t.create(e,i),enumerable:!1,configurable:!1}),i.__array_observer__},t.create=function(e,i){return new t(e,i)},t}(ModifyCollectionObserver),Expression=function(){function e(){this.isAssignable=!1}return e.prototype.evaluate=function(e,t,i){throw new Error('Binding expression "'+this+'" cannot be evaluated.')},e.prototype.assign=function(e,t,i){throw new Error('Binding expression "'+this+'" cannot be assigned to.')},e.prototype.toString=function(){return Function.prototype.toString.call(this)},e}(),BindingBehavior=function(e){function t(t,i,r){var n=_possibleConstructorReturn(this,e.call(this));return n.expression=t,n.name=i,n.args=r,n}return _inherits(t,e),t.prototype.evaluate=function(e,t){return this.expression.evaluate(e,t)},t.prototype.assign=function(e,t,i){return this.expression.assign(e,t,i)},t.prototype.accept=function(e){return e.visitBindingBehavior(this)},t.prototype.connect=function(e,t){this.expression.connect(e,t)},t.prototype.bind=function(e,t,i){this.expression.expression&&this.expression.bind&&this.expression.bind(e,t,i);var r=i.bindingBehaviors(this.name);if(!r)throw new Error('No BindingBehavior named "'+this.name+'" was found!');var n="behavior-"+this.name;if(e[n])throw new Error('A binding behavior named "'+this.name+'" has already been applied to "'+this.expression+'"');e[n]=r,r.bind.apply(r,[e,t].concat(evalList(t,this.args,e.lookupFunctions)))},t.prototype.unbind=function(e,t){var i="behavior-"+this.name;e[i].unbind(e,t),e[i]=null,this.expression.expression&&this.expression.unbind&&this.expression.unbind(e,t)},t}(Expression),ValueConverter=function(e){function t(t,i,r){var n=_possibleConstructorReturn(this,e.call(this));return n.expression=t,n.name=i,n.args=r,n.allArgs=[t].concat(r),n}return _inherits(t,e),t.prototype.evaluate=function(e,t){var i=t.valueConverters(this.name);if(!i)throw new Error('No ValueConverter named "'+this.name+'" was found!');return"toView"in i?i.toView.apply(i,evalList(e,this.allArgs,t)):this.allArgs[0].evaluate(e,t)},t.prototype.assign=function(e,t,i){var r=i.valueConverters(this.name);if(!r)throw new Error('No ValueConverter named "'+this.name+'" was found!');return"fromView"in r&&(t=r.fromView.apply(r,[t].concat(evalList(e,this.args,i)))),this.allArgs[0].assign(e,t,i)},t.prototype.accept=function(e){return e.visitValueConverter(this)},t.prototype.connect=function(e,t){for(var i=this.allArgs,r=i.length;r--;)i[r].connect(e,t);var n=e.lookupFunctions.valueConverters(this.name);if(!n)throw new Error('No ValueConverter named "'+this.name+'" was found!');var o=n.signals;if(void 0!==o)for(r=o.length;r--;)connectBindingToSignal(e,o[r])},t}(Expression),Assign=function(e){function t(t,i){var r=_possibleConstructorReturn(this,e.call(this));return r.target=t,r.value=i,r.isAssignable=!0,r}return _inherits(t,e),t.prototype.evaluate=function(e,t){return this.target.assign(e,this.value.evaluate(e,t))},t.prototype.accept=function(e){e.visitAssign(this)},t.prototype.connect=function(e,t){},t.prototype.assign=function(e,t){this.value.assign(e,t),this.target.assign(e,t)},t}(Expression),Conditional=function(e){function t(t,i,r){var n=_possibleConstructorReturn(this,e.call(this));return n.condition=t,n.yes=i,n.no=r,n}return _inherits(t,e),t.prototype.evaluate=function(e,t){return this.condition.evaluate(e,t)?this.yes.evaluate(e,t):this.no.evaluate(e,t)},t.prototype.accept=function(e){return e.visitConditional(this)},t.prototype.connect=function(e,t){this.condition.connect(e,t),this.condition.evaluate(t)?this.yes.connect(e,t):this.no.connect(e,t)},t}(Expression),AccessThis=function(e){function t(t){var i=_possibleConstructorReturn(this,e.call(this));return i.ancestor=t,i}return _inherits(t,e),t.prototype.evaluate=function(e,t){for(var i=e.overrideContext,r=this.ancestor;r--&&i;)i=i.parentOverrideContext;return r<1&&i?i.bindingContext:void 0},t.prototype.accept=function(e){return e.visitAccessThis(this)},t.prototype.connect=function(e,t){},t}(Expression),AccessScope=function(e){function t(t,i){var r=_possibleConstructorReturn(this,e.call(this));return r.name=t,r.ancestor=i,r.isAssignable=!0,r}return _inherits(t,e),t.prototype.evaluate=function(e,t){return getContextFor(this.name,e,this.ancestor)[this.name]},t.prototype.assign=function(e,t){var i=getContextFor(this.name,e,this.ancestor);return i?i[this.name]=t:void 0},t.prototype.accept=function(e){return e.visitAccessScope(this)},t.prototype.connect=function(e,t){var i=getContextFor(this.name,t,this.ancestor);e.observeProperty(i,this.name)},t}(Expression),AccessMember=function(e){function t(t,i){var r=_possibleConstructorReturn(this,e.call(this));return r.object=t,r.name=i,r.isAssignable=!0,r}return _inherits(t,e),t.prototype.evaluate=function(e,t){var i=this.object.evaluate(e,t);return null==i?i:i[this.name]},t.prototype.assign=function(e,t){var i=this.object.evaluate(e);return null==i&&(i={},this.object.assign(e,i)),i[this.name]=t,t},t.prototype.accept=function(e){return e.visitAccessMember(this)},t.prototype.connect=function(e,t){this.object.connect(e,t);var i=this.object.evaluate(t);i&&e.observeProperty(i,this.name)},t}(Expression),AccessKeyed=function(e){function t(t,i){var r=_possibleConstructorReturn(this,e.call(this));return r.object=t,r.key=i,r.isAssignable=!0,r}return _inherits(t,e),t.prototype.evaluate=function(e,t){return getKeyed(this.object.evaluate(e,t),this.key.evaluate(e,t))},t.prototype.assign=function(e,t){return setKeyed(this.object.evaluate(e),this.key.evaluate(e),t)},t.prototype.accept=function(e){return e.visitAccessKeyed(this)},t.prototype.connect=function(e,t){this.object.connect(e,t);var i=this.object.evaluate(t);if(i instanceof Object){this.key.connect(e,t);var r=this.key.evaluate(t);null==r||Array.isArray(i)&&"number"==typeof r||e.observeProperty(i,r)}},t}(Expression),CallScope=function(e){function t(t,i,r){var n=_possibleConstructorReturn(this,e.call(this));return n.name=t,n.args=i,n.ancestor=r,n}return _inherits(t,e),t.prototype.evaluate=function(e,t,i){var r=evalList(e,this.args,t),n=getContextFor(this.name,e,this.ancestor),o=getFunction(n,this.name,i);if(o)return o.apply(n,r)},t.prototype.accept=function(e){return e.visitCallScope(this)},t.prototype.connect=function(e,t){for(var i=this.args,r=i.length;r--;)i[r].connect(e,t)},t}(Expression),CallMember=function(e){function t(t,i,r){var n=_possibleConstructorReturn(this,e.call(this));return n.object=t,n.name=i,n.args=r,n}return _inherits(t,e),t.prototype.evaluate=function(e,t,i){var r=this.object.evaluate(e,t),n=evalList(e,this.args,t),o=getFunction(r,this.name,i);if(o)return o.apply(r,n)},t.prototype.accept=function(e){return e.visitCallMember(this)},t.prototype.connect=function(e,t){if(this.object.connect(e,t),getFunction(this.object.evaluate(t),this.name,!1))for(var i=this.args,r=i.length;r--;)i[r].connect(e,t)},t}(Expression),CallFunction=function(e){function t(t,i){var r=_possibleConstructorReturn(this,e.call(this));return r.func=t,r.args=i,r}return _inherits(t,e),t.prototype.evaluate=function(e,t,i){var r=this.func.evaluate(e,t);if("function"==typeof r)return r.apply(null,evalList(e,this.args,t));if(i||null!=r)throw new Error(this.func+" is not a function")},t.prototype.accept=function(e){return e.visitCallFunction(this)},t.prototype.connect=function(e,t){if(this.func.connect(e,t),"function"==typeof this.func.evaluate(t))for(var i=this.args,r=i.length;r--;)i[r].connect(e,t)},t}(Expression),Binary=function(e){function t(t,i,r){var n=_possibleConstructorReturn(this,e.call(this));return n.operation=t,n.left=i,n.right=r,n}return _inherits(t,e),t.prototype.evaluate=function(e,t){var i=this.left.evaluate(e,t);switch(this.operation){case"&&":return i&&this.right.evaluate(e,t);case"||":return i||this.right.evaluate(e,t)}var r=this.right.evaluate(e,t);switch(this.operation){case"==":return i==r;case"===":return i===r;case"!=":return i!=r;case"!==":return i!==r;case"instanceof":return"function"==typeof r&&i instanceof r;case"in":return"object"===(void 0===r?"undefined":_typeof$4(r))&&null!==r&&i in r}if(null===i||null===r||void 0===i||void 0===r){switch(this.operation){case"+":return null!=i?i:null!=r?r:0;case"-":return null!=i?i:null!=r?0-r:0}return null}switch(this.operation){case"+":return autoConvertAdd(i,r);case"-":return i-r;case"*":return i*r;case"/":return i/r;case"%":return i%r;case"<":return i<r;case">":return i>r;case"<=":return i<=r;case">=":return i>=r;case"^":return i^r}throw new Error("Internal error ["+this.operation+"] not handled")},t.prototype.accept=function(e){return e.visitBinary(this)},t.prototype.connect=function(e,t){this.left.connect(e,t);var i=this.left.evaluate(t);"&&"===this.operation&&!i||"||"===this.operation&&i||this.right.connect(e,t)},t}(Expression),Unary=function(e){function t(t,i){var r=_possibleConstructorReturn(this,e.call(this));return r.operation=t,r.expression=i,r}return _inherits(t,e),t.prototype.evaluate=function(e,t){switch(this.operation){case"!":return!this.expression.evaluate(e,t);case"typeof":return _typeof$4(this.expression.evaluate(e,t));case"void":return void this.expression.evaluate(e,t)}throw new Error("Internal error ["+this.operation+"] not handled")},t.prototype.accept=function(e){return e.visitPrefix(this)},t.prototype.connect=function(e,t){this.expression.connect(e,t)},t}(Expression),LiteralPrimitive=function(e){function t(t){var i=_possibleConstructorReturn(this,e.call(this));return i.value=t,i}return _inherits(t,e),t.prototype.evaluate=function(e,t){return this.value},t.prototype.accept=function(e){return e.visitLiteralPrimitive(this)},t.prototype.connect=function(e,t){},t}(Expression),LiteralString=function(e){function t(t){var i=_possibleConstructorReturn(this,e.call(this));return i.value=t,i}return _inherits(t,e),t.prototype.evaluate=function(e,t){return this.value},t.prototype.accept=function(e){return e.visitLiteralString(this)},t.prototype.connect=function(e,t){},t}(Expression),LiteralTemplate=function(e){function t(t,i,r,n){var o=_possibleConstructorReturn(this,e.call(this));if(o.cooked=t,o.expressions=i||[],o.length=o.expressions.length,o.tagged=void 0!==n,o.tagged)if(o.cooked.raw=r,o.tag=n,n instanceof AccessScope)o.contextType="Scope";else{if(!(n instanceof AccessMember||n instanceof AccessKeyed))throw new Error(o.tag+" is not a valid template tag");o.contextType="Object"}return o}return _inherits(t,e),t.prototype.getScopeContext=function(e,t){return getContextFor(this.tag.name,e,this.tag.ancestor)},t.prototype.getObjectContext=function(e,t){return this.tag.object.evaluate(e,t)},t.prototype.evaluate=function(e,t,i){for(var r=new Array(this.length),n=0;n<this.length;n++)r[n]=this.expressions[n].evaluate(e,t);if(this.tagged){var o=this.tag.evaluate(e,t);if("function"==typeof o){var s=this["get"+this.contextType+"Context"](e,t);return o.call.apply(o,[s,this.cooked].concat(r))}if(!i)return null;throw new Error(this.tag+" is not a function")}for(var a=this.cooked[0],l=0;l<this.length;l++)a=String.prototype.concat(a,r[l],this.cooked[l+1]);return a},t.prototype.accept=function(e){return e.visitLiteralTemplate(this)},t.prototype.connect=function(e,t){for(var i=0;i<this.length;i++)this.expressions[i].connect(e,t);this.tagged&&this.tag.connect(e,t)},t}(Expression),LiteralArray=function(e){function t(t){var i=_possibleConstructorReturn(this,e.call(this));return i.elements=t,i}return _inherits(t,e),t.prototype.evaluate=function(e,t){for(var i=this.elements,r=[],n=0,o=i.length;n<o;++n)r[n]=i[n].evaluate(e,t);return r},t.prototype.accept=function(e){return e.visitLiteralArray(this)},t.prototype.connect=function(e,t){for(var i=this.elements.length,r=0;r<i;r++)this.elements[r].connect(e,t)},t}(Expression),LiteralObject=function(e){function t(t,i){var r=_possibleConstructorReturn(this,e.call(this));return r.keys=t,r.values=i,r}return _inherits(t,e),t.prototype.evaluate=function(e,t){for(var i={},r=this.keys,n=this.values,o=0,s=r.length;o<s;++o)i[r[o]]=n[o].evaluate(e,t);return i},t.prototype.accept=function(e){return e.visitLiteralObject(this)},t.prototype.connect=function(e,t){for(var i=this.keys.length,r=0;r<i;r++)this.values[r].connect(e,t)},t}(Expression);function evalList(e,t,i){for(var r=t.length,n=[],o=0;o<r;o++)n[o]=t[o].evaluate(e,i);return n}function autoConvertAdd(e,t){return null!==e&&null!==t?"string"==typeof e&&"string"!=typeof t?e+t.toString():"string"!=typeof e&&"string"==typeof t?e.toString()+t:e+t:null!==e?e:null!==t?t:0}function getFunction(e,t,i){var r=null==e?null:e[t];if("function"==typeof r)return r;if(!i&&null==r)return null;throw new Error(t+" is not a function")}function getKeyed(e,t){return Array.isArray(e)?e[parseInt(t,10)]:e?e[t]:null!=e?e[t]:void 0}function setKeyed(e,t,i){if(Array.isArray(e)){var r=parseInt(t,10);e.length<=r&&(e.length=r+1),e[r]=i}else e[t]=i;return i}var _Unparser=null,ExpressionCloner=function(){function e(){}return e.prototype.cloneExpressionArray=function(e){for(var t=[],i=e.length;i--;)t[i]=e[i].accept(this);return t},e.prototype.visitBindingBehavior=function(e){return new BindingBehavior(e.expression.accept(this),e.name,this.cloneExpressionArray(e.args))},e.prototype.visitValueConverter=function(e){return new ValueConverter(e.expression.accept(this),e.name,this.cloneExpressionArray(e.args))},e.prototype.visitAssign=function(e){return new Assign(e.target.accept(this),e.value.accept(this))},e.prototype.visitConditional=function(e){return new Conditional(e.condition.accept(this),e.yes.accept(this),e.no.accept(this))},e.prototype.visitAccessThis=function(e){return new AccessThis(e.ancestor)},e.prototype.visitAccessScope=function(e){return new AccessScope(e.name,e.ancestor)},e.prototype.visitAccessMember=function(e){return new AccessMember(e.object.accept(this),e.name)},e.prototype.visitAccessKeyed=function(e){return new AccessKeyed(e.object.accept(this),e.key.accept(this))},e.prototype.visitCallScope=function(e){return new CallScope(e.name,this.cloneExpressionArray(e.args),e.ancestor)},e.prototype.visitCallFunction=function(e){return new CallFunction(e.func.accept(this),this.cloneExpressionArray(e.args))},e.prototype.visitCallMember=function(e){return new CallMember(e.object.accept(this),e.name,this.cloneExpressionArray(e.args))},e.prototype.visitUnary=function(e){return new Unary(prefix.operation,prefix.expression.accept(this))},e.prototype.visitBinary=function(e){return new Binary(e.operation,e.left.accept(this),e.right.accept(this))},e.prototype.visitLiteralPrimitive=function(e){return new LiteralPrimitive(e)},e.prototype.visitLiteralArray=function(e){return new LiteralArray(this.cloneExpressionArray(e.elements))},e.prototype.visitLiteralObject=function(e){return new LiteralObject(e.keys,this.cloneExpressionArray(e.values))},e.prototype.visitLiteralString=function(e){return new LiteralString(e.value)},e.prototype.visitLiteralTemplate=function(e){return new LiteralTemplate(e.cooked,this.cloneExpressionArray(e.expressions),e.raw,e.tag&&e.tag.accept(this))},e}();function cloneExpression(e){var t=new ExpressionCloner;return e.accept(t)}var bindingMode={oneTime:0,toView:1,oneWay:1,twoWay:2,fromView:3},Parser=function(){function e(){this.cache=Object.create(null)}return e.prototype.parse=function(e){return e=e||"",this.cache[e]||(this.cache[e]=new ParserImplementation(e).parseBindingBehavior())},e}(),fromCharCode=String.fromCharCode,ParserImplementation=function(){function e(e){this.idx=0,this.start=0,this.src=e,this.len=e.length,this.tkn=T$EOF,this.val=void 0,this.ch=e.charCodeAt(0)}return _createClass$1(e,[{key:"raw",get:function(){return this.src.slice(this.start,this.idx)}}]),e.prototype.parseBindingBehavior=function(){this.nextToken(),this.tkn&T$ExpressionTerminal&&this.err("Invalid start of expression");for(var e=this.parseValueConverter();this.opt(T$Ampersand);)e=new BindingBehavior(e,this.val,this.parseVariadicArgs());return this.tkn!==T$EOF&&this.err("Unconsumed token "+this.raw),e},e.prototype.parseValueConverter=function(){for(var e=this.parseExpression();this.opt(T$Bar);)e=new ValueConverter(e,this.val,this.parseVariadicArgs());return e},e.prototype.parseVariadicArgs=function(){this.nextToken();for(var e=[];this.opt(T$Colon);)e.push(this.parseExpression());return e},e.prototype.parseExpression=function(){for(var e=this.idx,t=this.parseConditional();this.tkn===T$Eq;)t.isAssignable||this.err("Expression "+this.src.slice(e,this.start)+" is not assignable"),this.nextToken(),e=this.idx,t=new Assign(t,this.parseConditional());return t},e.prototype.parseConditional=function(){var e=this.parseBinary(0);if(this.opt(T$Question)){var t=this.parseExpression();this.expect(T$Colon),e=new Conditional(e,t,this.parseExpression())}return e},e.prototype.parseBinary=function(e){for(var t=this.parseLeftHandSide(0);this.tkn&T$BinaryOp;){var i=this.tkn;if((i&T$Precedence)<=e)break;this.nextToken(),t=new Binary(TokenValues[i&T$TokenMask],t,this.parseBinary(i&T$Precedence))}return t},e.prototype.parseLeftHandSide=function(e){var t=void 0;e:switch(this.tkn){case T$Plus:return this.nextToken(),this.parseLeftHandSide(0);case T$Minus:return this.nextToken(),new Binary("-",new LiteralPrimitive(0),this.parseLeftHandSide(0));case T$Bang:case T$TypeofKeyword:case T$VoidKeyword:var i=TokenValues[this.tkn&T$TokenMask];return this.nextToken(),new Unary(i,this.parseLeftHandSide(0));case T$ParentScope:do{if(this.nextToken(),e++,this.opt(T$Period))this.tkn===T$Period&&this.err();else{if(this.tkn&T$AccessScopeTerminal){t=new AccessThis(e&C$Ancestor),e=e&C$ShorthandProp|C$This;break e}this.err()}}while(this.tkn===T$ParentScope);case T$Identifier:t=new AccessScope(this.val,e&C$Ancestor),this.nextToken(),e=e&C$ShorthandProp|C$Scope;break;case T$ThisScope:this.nextToken(),t=new AccessThis(0),e=e&C$ShorthandProp|C$This;break;case T$LParen:this.nextToken(),t=this.parseExpression(),this.expect(T$RParen),e=C$Primary;break;case T$LBracket:this.nextToken();var r=[];if(this.tkn!==T$RBracket)do{r.push(this.parseExpression())}while(this.opt(T$Comma));this.expect(T$RBracket),t=new LiteralArray(r),e=C$Primary;break;case T$LBrace:var n=[],o=[];for(this.nextToken();this.tkn!==T$RBrace;){if(this.tkn&T$IdentifierOrKeyword){var s=this.ch,a=this.tkn,l=this.idx;n.push(this.val),this.nextToken(),this.opt(T$Colon)?o.push(this.parseExpression()):(this.ch=s,this.tkn=a,this.idx=l,o.push(this.parseLeftHandSide(C$ShorthandProp)))}else this.tkn&T$Literal?(n.push(this.val),this.nextToken(),this.expect(T$Colon),o.push(this.parseExpression())):this.err();this.tkn!==T$RBrace&&this.expect(T$Comma)}this.expect(T$RBrace),t=new LiteralObject(n,o),e=C$Primary;break;case T$StringLiteral:t=new LiteralString(this.val),this.nextToken(),e=C$Primary;break;case T$TemplateTail:t=new LiteralTemplate([this.val]),this.nextToken(),e=C$Primary;break;case T$TemplateContinuation:t=this.parseTemplate(0),e=C$Primary;break;case T$NumericLiteral:t=new LiteralPrimitive(this.val),this.nextToken();break;case T$NullKeyword:case T$UndefinedKeyword:case T$TrueKeyword:case T$FalseKeyword:t=new LiteralPrimitive(TokenValues[this.tkn&T$TokenMask]),this.nextToken(),e=C$Primary;break;default:this.idx>=this.len?this.err("Unexpected end of expression"):this.err()}if(e&C$ShorthandProp)return t;for(var c=this.val;this.tkn&T$MemberOrCallExpression;)switch(this.tkn){case T$Period:if(this.nextToken(),this.tkn&T$IdentifierOrKeyword||this.err(),c=this.val,this.nextToken(),e=e&C$Primary|(e&(C$This|C$Scope))<<1|e&C$Member|(e&C$Keyed)>>1|(e&C$Call)>>2,this.tkn===T$LParen)continue;t=e&C$Scope?new AccessScope(c,t.ancestor):new AccessMember(t,c);continue;case T$LBracket:this.nextToken(),e=C$Keyed,t=new AccessKeyed(t,this.parseExpression()),this.expect(T$RBracket);break;case T$LParen:this.nextToken();for(var u=[];this.tkn!==T$RParen&&(u.push(this.parseExpression()),this.opt(T$Comma)););this.expect(T$RParen),t=e&C$Scope?new CallScope(c,u,t.ancestor):e&(C$Member|C$Primary)?new CallMember(t,c,u):new CallFunction(t,u),e=C$Call;break;case T$TemplateTail:t=new LiteralTemplate([this.val],[],[this.raw],t),this.nextToken();break;case T$TemplateContinuation:t=this.parseTemplate(e|C$Tagged,t)}return t},e.prototype.parseTemplate=function(e,t){var i=[this.val],r=e&C$Tagged?[this.raw]:void 0;this.expect(T$TemplateContinuation);for(var n=[this.parseExpression()];(this.tkn=this.scanTemplateTail())!==T$TemplateTail;)i.push(this.val),e&C$Tagged&&r.push(this.raw),this.expect(T$TemplateContinuation),n.push(this.parseExpression());return i.push(this.val),e&C$Tagged&&r.push(this.raw),this.nextToken(),new LiteralTemplate(i,n,r,t)},e.prototype.nextToken=function(){for(;this.idx<this.len;)if(this.ch<=32)this.next();else{if(this.start=this.idx,36===this.ch||this.ch>=97&&this.ch<=122)return void(this.tkn=this.scanIdentifier());if(null!==(this.tkn=CharScanners[this.ch](this)))return}this.tkn=T$EOF},e.prototype.next=function(){return this.ch=this.src.charCodeAt(++this.idx)},e.prototype.scanIdentifier=function(){for(;AsciiIdParts.has(this.next())||this.ch>127&&IdParts[this.ch];);return KeywordLookup[this.val=this.raw]||T$Identifier},e.prototype.scanNumber=function(e){if(e)this.val=0;else for(this.val=this.ch-48;this.next()<=57&&this.ch>=48;)this.val=10*this.val+this.ch-48;if(e||46===this.ch){e||this.next();for(var t=this.idx,i=this.ch-48;this.next()<=57&&this.ch>=48;)i=10*i+this.ch-48;this.val=this.val+i/Math.pow(10,this.idx-t)}if(101===this.ch||69===this.ch){var r=this.idx;for(this.next(),45!==this.ch&&43!==this.ch||this.next(),this.ch>=48&&this.ch<=57||(this.idx=r,this.err("Invalid exponent"));this.next()<=57&&this.ch>=48;);this.val=parseFloat(this.src.slice(this.start,this.idx))}return T$NumericLiteral},e.prototype.scanString=function(){var e=this.ch;this.next();for(var t=void 0,i=this.idx;this.ch!==e;)if(92===this.ch){t||(t=[]),t.push(this.src.slice(i,this.idx)),this.next();var r=void 0;if(117===this.ch)if(this.next(),this.idx+4<this.len){var n=this.src.slice(this.idx,this.idx+4);/[A-Z0-9]{4}/i.test(n)||this.err("Invalid unicode escape [\\u"+n+"]"),r=parseInt(n,16),this.idx+=4,this.ch=this.src.charCodeAt(this.idx)}else this.err();else r=unescape(this.ch),this.next();t.push(fromCharCode(r)),i=this.idx}else 0===this.ch||this.idx>=this.len?this.err("Unterminated quote"):this.next();var o=this.src.slice(i,this.idx);this.next();var s=o;return null!=t&&(t.push(o),s=t.join("")),this.val=s,T$StringLiteral},e.prototype.scanTemplate=function(){for(var e=!0,t="";96!==this.next();)if(36===this.ch){if(this.idx+1<this.len&&123===this.src.charCodeAt(this.idx+1)){this.idx++,e=!1;break}t+="$"}else 92===this.ch?t+=fromCharCode(unescape(this.next())):0===this.ch||this.idx>=this.len?this.err("Unterminated template literal"):t+=fromCharCode(this.ch);return this.next(),this.val=t,e?T$TemplateTail:T$TemplateContinuation},e.prototype.scanTemplateTail=function(){return this.idx>=this.len&&this.err("Unterminated template"),this.idx--,this.scanTemplate()},e.prototype.err=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected token "+this.raw,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.start;throw new Error("Parser Error: "+e+" at column "+t+" in expression ["+this.src+"]")},e.prototype.opt=function(e){return this.tkn===e&&(this.nextToken(),!0)},e.prototype.expect=function(e){this.tkn===e?this.nextToken():this.err("Missing expected token "+TokenValues[e&T$TokenMask],this.idx)},e}();function unescape(e){switch(e){case 102:return 12;case 110:return 10;case 114:return 13;case 116:return 9;case 118:return 11;default:return e}}var C$This=1024,C$Scope=2048,C$Member=4096,C$Keyed=8192,C$Call=16384,C$Primary=32768,C$ShorthandProp=65536,C$Tagged=1<<17,C$Ancestor=511,T$TokenMask=63,T$PrecShift=6,T$Precedence=7<<T$PrecShift,T$ExpressionTerminal=2048,T$ClosingToken=4096,T$OpeningToken=8192,T$AccessScopeTerminal=16384,T$Keyword=32768,T$EOF=65536|T$AccessScopeTerminal|T$ExpressionTerminal,T$Identifier=1<<17,T$IdentifierOrKeyword=T$Identifier|T$Keyword,T$Literal=1<<18,T$NumericLiteral=1<<19|T$Literal,T$StringLiteral=1<<20|T$Literal,T$BinaryOp=1<<21,T$UnaryOp=1<<22,T$MemberExpression=1<<23,T$MemberOrCallExpression=1<<24,T$TemplateTail=1<<25|T$MemberOrCallExpression,T$TemplateContinuation=1<<26|T$MemberOrCallExpression,T$FalseKeyword=0|T$Keyword|T$Literal,T$TrueKeyword=1|T$Keyword|T$Literal,T$NullKeyword=2|T$Keyword|T$Literal,T$UndefinedKeyword=3|T$Keyword|T$Literal,T$ThisScope=4|T$IdentifierOrKeyword,T$ParentScope=5|T$IdentifierOrKeyword,T$LParen=6|T$OpeningToken|T$AccessScopeTerminal|T$MemberOrCallExpression,T$LBrace=7|T$OpeningToken,T$Period=8|T$MemberExpression|T$MemberOrCallExpression,T$RBrace=9|T$AccessScopeTerminal|T$ClosingToken|T$ExpressionTerminal,T$RParen=10|T$AccessScopeTerminal|T$ClosingToken|T$ExpressionTerminal,T$Comma=11|T$AccessScopeTerminal,T$LBracket=12|T$OpeningToken|T$AccessScopeTerminal|T$MemberExpression|T$MemberOrCallExpression,T$RBracket=13|T$ClosingToken|T$ExpressionTerminal,T$Colon=14|T$AccessScopeTerminal,T$Question=15,T$Ampersand=18|T$AccessScopeTerminal,T$Bar=19|T$AccessScopeTerminal,T$BarBar=20|1<<T$PrecShift|T$BinaryOp,T$AmpersandAmpersand=21|2<<T$PrecShift|T$BinaryOp,T$Caret=22|3<<T$PrecShift|T$BinaryOp,T$EqEq=23|4<<T$PrecShift|T$BinaryOp,T$BangEq=24|4<<T$PrecShift|T$BinaryOp,T$EqEqEq=25|4<<T$PrecShift|T$BinaryOp,T$BangEqEq=26|4<<T$PrecShift|T$BinaryOp,T$Lt=27|5<<T$PrecShift|T$BinaryOp,T$Gt=28|5<<T$PrecShift|T$BinaryOp,T$LtEq=29|5<<T$PrecShift|T$BinaryOp,T$GtEq=30|5<<T$PrecShift|T$BinaryOp,T$InKeyword=31|5<<T$PrecShift|T$BinaryOp|T$Keyword,T$InstanceOfKeyword=32|5<<T$PrecShift|T$BinaryOp|T$Keyword,T$Plus=33|6<<T$PrecShift|T$BinaryOp|T$UnaryOp,T$Minus=34|6<<T$PrecShift|T$BinaryOp|T$UnaryOp,T$TypeofKeyword=35|T$UnaryOp|T$Keyword,T$VoidKeyword=36|T$UnaryOp|T$Keyword,T$Star=37|7<<T$PrecShift|T$BinaryOp,T$Percent=38|7<<T$PrecShift|T$BinaryOp,T$Slash=39|7<<T$PrecShift|T$BinaryOp,T$Eq=40,T$Bang=41|T$UnaryOp,KeywordLookup=Object.create(null);KeywordLookup.true=T$TrueKeyword,KeywordLookup.null=T$NullKeyword,KeywordLookup.false=T$FalseKeyword,KeywordLookup.undefined=T$UndefinedKeyword,KeywordLookup.$this=T$ThisScope,KeywordLookup.$parent=T$ParentScope,KeywordLookup.in=T$InKeyword,KeywordLookup.instanceof=T$InstanceOfKeyword,KeywordLookup.typeof=T$TypeofKeyword,KeywordLookup.void=T$VoidKeyword;var TokenValues=[!1,!0,null,void 0,"$this","$parent","(","{",".","}",")",",","[","]",":","?","'",'"',"&","|","||","&&","^","==","!=","===","!==","<",">","<=",">=","in","instanceof","+","-","typeof","void","*","%","/","=","!"],codes={AsciiIdPart:[36,0,48,58,65,91,95,0,97,123],IdStart:[36,0,65,91,95,0,97,123,170,0,186,0,192,215,216,247,248,697,736,741,7424,7462,7468,7517,7522,7526,7531,7544,7545,7615,7680,7936,8305,0,8319,0,8336,8349,8490,8492,8498,0,8526,0,8544,8585,11360,11392,42786,42888,42891,42927,42928,42936,42999,43008,43824,43867,43868,43877,64256,64263,65313,65339,65345,65371],Digit:[48,58],Skip:[0,33,127,161]};function decompress(e,t,i,r){for(var n=i.length,o=0;o<n;o+=2){var s=i[o],a=i[o+1];if(a=a>0?a:s+1,e)for(var l=s;l<a;)e[l]=r,l++;if(t)for(var c=s;c<a;c++)t.add(c)}}function returnToken(e){return function(t){return t.next(),e}}function unexpectedCharacter(e){return e.err("Unexpected character ["+fromCharCode(e.ch)+"]"),null}var AsciiIdParts=new Set;decompress(null,AsciiIdParts,codes.AsciiIdPart,!0);var IdParts=new Uint8Array(65535);decompress(IdParts,null,codes.IdStart,1),decompress(IdParts,null,codes.Digit,1);for(var CharScanners=new Array(65535),ci=0;ci<65535;)CharScanners[ci]=unexpectedCharacter,ci++;decompress(CharScanners,null,codes.Skip,function(e){return e.next(),null}),decompress(CharScanners,null,codes.IdStart,function(e){return e.scanIdentifier()}),decompress(CharScanners,null,codes.Digit,function(e){return e.scanNumber(!1)}),CharScanners[34]=CharScanners[39]=function(e){return e.scanString()},CharScanners[96]=function(e){return e.scanTemplate()},CharScanners[33]=function(e){return 61!==e.next()?T$Bang:61!==e.next()?T$BangEq:(e.next(),T$BangEqEq)},CharScanners[61]=function(e){return 61!==e.next()?T$Eq:61!==e.next()?T$EqEq:(e.next(),T$EqEqEq)},CharScanners[38]=function(e){return 38!==e.next()?T$Ampersand:(e.next(),T$AmpersandAmpersand)},CharScanners[124]=function(e){return 124!==e.next()?T$Bar:(e.next(),T$BarBar)},CharScanners[46]=function(e){return e.next()<=57&&e.ch>=48?e.scanNumber(!0):T$Period},CharScanners[60]=function(e){return 61!==e.next()?T$Lt:(e.next(),T$LtEq)},CharScanners[62]=function(e){return 61!==e.next()?T$Gt:(e.next(),T$GtEq)},CharScanners[37]=returnToken(T$Percent),CharScanners[40]=returnToken(T$LParen),CharScanners[41]=returnToken(T$RParen),CharScanners[42]=returnToken(T$Star),CharScanners[43]=returnToken(T$Plus),CharScanners[44]=returnToken(T$Comma),CharScanners[45]=returnToken(T$Minus),CharScanners[47]=returnToken(T$Slash),CharScanners[58]=returnToken(T$Colon),CharScanners[63]=returnToken(T$Question),CharScanners[91]=returnToken(T$LBracket),CharScanners[93]=returnToken(T$RBracket),CharScanners[94]=returnToken(T$Caret),CharScanners[123]=returnToken(T$LBrace),CharScanners[125]=returnToken(T$RBrace);var mapProto=Map.prototype;function _getMapObserver(e,t){return ModifyMapObserver.for(e,t)}var ModifyMapObserver=function(e){function t(t,i){return _possibleConstructorReturn(this,e.call(this,t,i))}return _inherits(t,e),t.for=function(e,i){return"__map_observer__"in i||Reflect.defineProperty(i,"__map_observer__",{value:t.create(e,i),enumerable:!1,configurable:!1}),i.__map_observer__},t.create=function(e,i){var r=new t(e,i),n=mapProto;return n.set===i.set&&n.delete===i.delete&&n.clear===i.clear||(n={set:i.set,delete:i.delete,clear:i.clear}),i.set=function(){var e=i.has(arguments[0]),t=e?"update":"add",o=i.get(arguments[0]),s=n.set.apply(i,arguments);return e&&o===i.get(arguments[0])||r.addChangeRecord({type:t,object:i,key:arguments[0],oldValue:o}),s},i.delete=function(){var e=i.has(arguments[0]),t=i.get(arguments[0]),o=n.delete.apply(i,arguments);return e&&r.addChangeRecord({type:"delete",object:i,key:arguments[0],oldValue:t}),o},i.clear=function(){var e=n.clear.apply(i,arguments);return r.addChangeRecord({type:"clear",object:i}),e},r},t}(ModifyCollectionObserver),emLogger=getLogger("event-manager");function findOriginalEventTarget(e){return e.path&&e.path[0]||e.deepPath&&e.deepPath[0]||e.target}function stopPropagation(){this.standardStopPropagation(),this.propagationStopped=!0}function handleCapturedEvent(e){e.propagationStopped=!1;for(var t=findOriginalEventTarget(e),i=[];t;){if(t.capturedCallbacks){var r=t.capturedCallbacks[e.type];r&&(e.stopPropagation!==stopPropagation&&(e.standardStopPropagation=e.stopPropagation,e.stopPropagation=stopPropagation),i.push(r))}t=t.parentNode}for(var n=i.length-1;n>=0&&!e.propagationStopped;n--){var o=i[n];"handleEvent"in o?o.handleEvent(e):o(e)}}var CapturedHandlerEntry=function(){function e(e){this.eventName=e,this.count=0}return e.prototype.increment=function(){this.count++,1===this.count&&DOM.addEventListener(this.eventName,handleCapturedEvent,!0)},e.prototype.decrement=function(){0===this.count?emLogger.warn("The same EventListener was disposed multiple times."):0==--this.count&&DOM.removeEventListener(this.eventName,handleDelegatedEvent,!1)},e}();function handleDelegatedEvent(e){e.propagationStopped=!1;for(var t=findOriginalEventTarget(e);t&&!e.propagationStopped;){if(t.delegatedCallbacks){var i=t.delegatedCallbacks[e.type];i&&(e.stopPropagation!==stopPropagation&&(e.standardStopPropagation=e.stopPropagation,e.stopPropagation=stopPropagation),"handleEvent"in i?i.handleEvent(e):i(e))}t=t.parentNode}}var DelegateHandlerEntry=function(){function e(e){this.eventName=e,this.count=0}return e.prototype.increment=function(){this.count++,1===this.count&&DOM.addEventListener(this.eventName,handleDelegatedEvent,!1)},e.prototype.decrement=function(){0===this.count?emLogger.warn("The same EventListener was disposed multiple times."):0==--this.count&&DOM.removeEventListener(this.eventName,handleDelegatedEvent,!1)},e}(),DelegationEntryHandler=function(){function e(e,t,i){this.entry=e,this.lookup=t,this.targetEvent=i}return e.prototype.dispose=function(){this.lookup[this.targetEvent]?(this.entry.decrement(),this.lookup[this.targetEvent]=null):emLogger.warn("Calling .dispose() on already disposed eventListener")},e}(),EventHandler=function(){function e(e,t,i){this.target=e,this.targetEvent=t,this.callback=i}return e.prototype.dispose=function(){this.target.removeEventListener(this.targetEvent,this.callback)},e}(),DefaultEventStrategy=function(){function e(){this.delegatedHandlers={},this.capturedHandlers={}}return e.prototype.subscribe=function(e,t,i,r,n){var o=void 0,s=void 0,a=void 0;if(r===delegationStrategy.bubbling){o=this.delegatedHandlers,a=o[t]||(o[t]=new DelegateHandlerEntry(t));var l=e.delegatedCallbacks||(e.delegatedCallbacks={});return l[t]?emLogger.warn("Overriding previous callback for event listener",{event:t,callback:i,previousCallback:l[t]}):a.increment(),l[t]=i,!0===n?new DelegationEntryHandler(a,l,t):function(){a.decrement(),l[t]=null}}if(r===delegationStrategy.capturing){s=this.capturedHandlers,a=s[t]||(s[t]=new CapturedHandlerEntry(t));var c=e.capturedCallbacks||(e.capturedCallbacks={});return c[t]?emLogger.error("already have a callback for event",{event:t,callback:i}):a.increment(),c[t]=i,!0===n?new DelegationEntryHandler(a,c,t):function(){a.decrement(),c[t]=null}}return e.addEventListener(t,i),!0===n?new EventHandler(e,t,i):function(){e.removeEventListener(t,i)}},e}(),delegationStrategy={none:0,capturing:1,bubbling:2},EventManager=function(){function e(){this.elementHandlerLookup={},this.eventStrategyLookup={},this.registerElementConfig({tagName:"input",properties:{value:["change","input"],checked:["change","input"],files:["change","input"]}}),this.registerElementConfig({tagName:"textarea",properties:{value:["change","input"]}}),this.registerElementConfig({tagName:"select",properties:{value:["change"]}}),this.registerElementConfig({tagName:"content editable",properties:{value:["change","input","blur","keyup","paste"]}}),this.registerElementConfig({tagName:"scrollable element",properties:{scrollTop:["scroll"],scrollLeft:["scroll"]}}),this.defaultEventStrategy=new DefaultEventStrategy}return e.prototype.registerElementConfig=function(e){var t=e.tagName.toLowerCase(),i=e.properties,r=void 0,n=this.elementHandlerLookup[t]={};for(r in i)i.hasOwnProperty(r)&&(n[r]=i[r])},e.prototype.registerEventStrategy=function(e,t){this.eventStrategyLookup[e]=t},e.prototype.getElementHandler=function(e,t){var i=void 0,r=this.elementHandlerLookup;if(e.tagName){if(r[i=e.tagName.toLowerCase()]&&r[i][t])return new EventSubscriber(r[i][t]);if("textContent"===t||"innerHTML"===t)return new EventSubscriber(r["content editable"].value);if("scrollTop"===t||"scrollLeft"===t)return new EventSubscriber(r["scrollable element"][t])}return null},e.prototype.addEventListener=function(e,t,i,r,n){return(this.eventStrategyLookup[t]||this.defaultEventStrategy).subscribe(e,t,i,r,n)},e}(),EventSubscriber=function(){function e(e){this.events=e,this.element=null,this.handler=null}return e.prototype.subscribe=function(e,t){this.element=e,this.handler=t;for(var i=this.events,r=0,n=i.length;n>r;++r)e.addEventListener(i[r],t)},e.prototype.dispose=function(){if(null!==this.element){for(var e=this.element,t=this.handler,i=this.events,r=0,n=i.length;n>r;++r)e.removeEventListener(i[r],t);this.element=this.handler=null}},e}(),DirtyChecker=function(){function e(){this.tracked=[],this.checkDelay=120}return e.prototype.addProperty=function(e){var t=this.tracked;t.push(e),1===t.length&&this.scheduleDirtyCheck()},e.prototype.removeProperty=function(e){var t=this.tracked;t.splice(t.indexOf(e),1)},e.prototype.scheduleDirtyCheck=function(){var e=this;setTimeout(function(){return e.check()},this.checkDelay)},e.prototype.check=function(){for(var e=this.tracked,t=e.length;t--;){var i=e[t];i.isDirty()&&i.call()}e.length&&this.scheduleDirtyCheck()},e}(),DirtyCheckProperty=(_dec5$1=subscriberCollection())(_class5$1=function(){function e(e,t,i){this.dirtyChecker=e,this.obj=t,this.propertyName=i}return e.prototype.getValue=function(){return this.obj[this.propertyName]},e.prototype.setValue=function(e){this.obj[this.propertyName]=e},e.prototype.call=function(){var e=this.oldValue,t=this.getValue();this.callSubscribers(t,e),this.oldValue=t},e.prototype.isDirty=function(){return this.oldValue!==this.obj[this.propertyName]},e.prototype.subscribe=function(e,t){this.hasSubscribers()||(this.oldValue=this.getValue(),this.dirtyChecker.addProperty(this)),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&this.dirtyChecker.removeProperty(this)},e}())||_class5$1,logger=getLogger("property-observation"),propertyAccessor={getValue:function(e,t){return e[t]},setValue:function(e,t,i){t[i]=e}},PrimitiveObserver=function(){function e(e,t){this.doNotCache=!0,this.primitive=e,this.propertyName=t}return e.prototype.getValue=function(){return this.primitive[this.propertyName]},e.prototype.setValue=function(){var e=_typeof$4(this.primitive);throw new Error("The "+this.propertyName+" property of a "+e+" ("+this.primitive+") cannot be assigned.")},e.prototype.subscribe=function(){},e.prototype.unsubscribe=function(){},e}(),SetterObserver=(_dec6$1=subscriberCollection())(_class7$1=function(){function e(e,t,i){this.taskQueue=e,this.obj=t,this.propertyName=i,this.queued=!1,this.observing=!1}return e.prototype.getValue=function(){return this.obj[this.propertyName]},e.prototype.setValue=function(e){this.obj[this.propertyName]=e},e.prototype.getterValue=function(){return this.currentValue},e.prototype.setterValue=function(e){var t=this.currentValue;t!==e&&(this.queued||(this.oldValue=t,this.queued=!0,this.taskQueue.queueMicroTask(this)),this.currentValue=e)},e.prototype.call=function(){var e=this.oldValue,t=this.currentValue;this.queued=!1,this.callSubscribers(t,e)},e.prototype.subscribe=function(e,t){this.observing||this.convertProperty(),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)},e.prototype.convertProperty=function(){this.observing=!0,this.currentValue=this.obj[this.propertyName],this.setValue=this.setterValue,this.getValue=this.getterValue,Reflect.defineProperty(this.obj,this.propertyName,{configurable:!0,enumerable:!(this.propertyName in this.obj)||this.obj.propertyIsEnumerable(this.propertyName),get:this.getValue.bind(this),set:this.setValue.bind(this)})||logger.warn("Cannot observe property '"+this.propertyName+"' of object",this.obj)},e}())||_class7$1,XLinkAttributeObserver=function(){function e(e,t,i){this.element=e,this.propertyName=t,this.attributeName=i}return e.prototype.getValue=function(){return this.element.getAttributeNS("http://www.w3.org/1999/xlink",this.attributeName)},e.prototype.setValue=function(e){return this.element.setAttributeNS("http://www.w3.org/1999/xlink",this.attributeName,e)},e.prototype.subscribe=function(){throw new Error('Observation of a "'+this.element.nodeName+'" element\'s "'+this.propertyName+'" property is not supported.')},e}(),dataAttributeAccessor={getValue:function(e,t){return e.getAttribute(t)},setValue:function(e,t,i){null==e?t.removeAttribute(i):t.setAttribute(i,e)}},DataAttributeObserver=function(){function e(e,t){this.element=e,this.propertyName=t}return e.prototype.getValue=function(){return this.element.getAttribute(this.propertyName)},e.prototype.setValue=function(e){return null==e?this.element.removeAttribute(this.propertyName):this.element.setAttribute(this.propertyName,e)},e.prototype.subscribe=function(){throw new Error('Observation of a "'+this.element.nodeName+'" element\'s "'+this.propertyName+'" property is not supported.')},e}(),StyleObserver=function(){function e(e,t){this.element=e,this.propertyName=t,this.styles=null,this.version=0}return e.prototype.getValue=function(){return this.element.style.cssText},e.prototype._setProperty=function(e,t){var i="";null!=t&&"function"==typeof t.indexOf&&-1!==t.indexOf("!important")&&(i="important",t=t.replace("!important","")),this.element.style.setProperty(e,t,i)},e.prototype.setValue=function(e){var t=this.styles||{},i=void 0,r=this.version;if(null!=e)if(e instanceof Object){var n=void 0;for(i in e)e.hasOwnProperty(i)&&(n=e[i],t[i=i.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})]=r,this._setProperty(i,n))}else if(e.length)for(var o=/\s*([\w\-]+)\s*:\s*((?:(?:[\w\-]+\(\s*(?:"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[\w\-]+\(\s*(?:^"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^\)]*)\),?|[^\)]*)\),?|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^;]*),?\s*)+);?/g,s=void 0;null!==(s=o.exec(e));)(i=s[1])&&(t[i]=r,this._setProperty(i,s[2]));if(this.styles=t,this.version+=1,0!==r)for(i in r-=1,t)t.hasOwnProperty(i)&&t[i]===r&&this.element.style.removeProperty(i)},e.prototype.subscribe=function(){throw new Error('Observation of a "'+this.element.nodeName+'" element\'s "'+this.propertyName+'" property is not supported.')},e}(),ValueAttributeObserver=(_dec7$1=subscriberCollection())(_class8=function(){function e(e,t,i){this.element=e,this.propertyName=t,this.handler=i,"files"===t&&(this.setValue=function(){})}return e.prototype.getValue=function(){return this.element[this.propertyName]},e.prototype.setValue=function(e){e=null==e?"":e,this.element[this.propertyName]!==e&&(this.element[this.propertyName]=e,this.notify())},e.prototype.notify=function(){var e=this.oldValue,t=this.getValue();this.callSubscribers(t,e),this.oldValue=t},e.prototype.handleEvent=function(){this.notify()},e.prototype.subscribe=function(e,t){this.hasSubscribers()||(this.oldValue=this.getValue(),this.handler.subscribe(this.element,this)),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&this.handler.dispose()},e}())||_class8,checkedArrayContext="CheckedObserver:array",checkedValueContext="CheckedObserver:value",CheckedObserver=(_dec8=subscriberCollection())(_class9=function(){function e(e,t,i){this.element=e,this.handler=t,this.observerLocator=i}return e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(e){this.initialSync&&this.value===e||(this.arrayObserver&&(this.arrayObserver.unsubscribe(checkedArrayContext,this),this.arrayObserver=null),"checkbox"===this.element.type&&Array.isArray(e)&&(this.arrayObserver=this.observerLocator.getArrayObserver(e),this.arrayObserver.subscribe(checkedArrayContext,this)),this.oldValue=this.value,this.value=e,this.synchronizeElement(),this.notify(),this.initialSync||(this.initialSync=!0,this.observerLocator.taskQueue.queueMicroTask(this)))},e.prototype.call=function(e,t){this.synchronizeElement(),this.valueObserver||(this.valueObserver=this.element.__observers__.model||this.element.__observers__.value,this.valueObserver&&this.valueObserver.subscribe(checkedValueContext,this))},e.prototype.synchronizeElement=function(){var e=this.value,t=this.element,i=t.hasOwnProperty("model")?t.model:t.value,r="radio"===t.type,n=t.matcher||function(e,t){return e===t};t.checked=r&&!!n(e,i)||!r&&!0===e||!r&&Array.isArray(e)&&-1!==e.findIndex(function(e){return!!n(e,i)})},e.prototype.synchronizeValue=function(){var e=this.value,t=this.element,i=t.hasOwnProperty("model")?t.model:t.value,r=void 0,n=t.matcher||function(e,t){return e===t};if("checkbox"===t.type){if(Array.isArray(e))return r=e.findIndex(function(e){return!!n(e,i)}),void(t.checked&&-1===r?e.push(i):t.checked||-1===r||e.splice(r,1));e=t.checked}else{if(!t.checked)return;e=i}this.oldValue=this.value,this.value=e,this.notify()},e.prototype.notify=function(){var e=this.oldValue,t=this.value;t!==e&&this.callSubscribers(t,e)},e.prototype.handleEvent=function(){this.synchronizeValue()},e.prototype.subscribe=function(e,t){this.hasSubscribers()||this.handler.subscribe(this.element,this),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&this.handler.dispose()},e.prototype.unbind=function(){this.arrayObserver&&(this.arrayObserver.unsubscribe(checkedArrayContext,this),this.arrayObserver=null),this.valueObserver&&this.valueObserver.unsubscribe(checkedValueContext,this)},e}())||_class9,selectArrayContext="SelectValueObserver:array",SelectValueObserver=(_dec9=subscriberCollection())(_class10=function(){function e(e,t,i){this.element=e,this.handler=t,this.observerLocator=i}return e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(e){if(null!=e&&this.element.multiple&&!Array.isArray(e))throw new Error("Only null or Array instances can be bound to a multi-select.");this.value!==e&&(this.arrayObserver&&(this.arrayObserver.unsubscribe(selectArrayContext,this),this.arrayObserver=null),Array.isArray(e)&&(this.arrayObserver=this.observerLocator.getArrayObserver(e),this.arrayObserver.subscribe(selectArrayContext,this)),this.oldValue=this.value,this.value=e,this.synchronizeOptions(),this.notify(),this.initialSync||(this.initialSync=!0,this.observerLocator.taskQueue.queueMicroTask(this)))},e.prototype.call=function(e,t){this.synchronizeOptions()},e.prototype.synchronizeOptions=function(){var e=this.value,t=void 0;Array.isArray(e)&&(t=!0);for(var i=this.element.options,r=i.length,n=this.element.matcher||function(e,t){return e===t},o=function(){var o=i.item(r),s=o.hasOwnProperty("model")?o.model:o.value;if(t)return o.selected=-1!==e.findIndex(function(e){return!!n(s,e)}),"continue";o.selected=!!n(s,e)};r--;)o()},e.prototype.synchronizeValue=function(){for(var e=this,t=this.element.options,i=0,r=[],n=0,o=t.length;n<o;n++){var s=t.item(n);s.selected&&(r.push(s.hasOwnProperty("model")?s.model:s.value),i++)}if(this.element.multiple){if(Array.isArray(this.value)){var a=function(){for(var t=e.element.matcher||function(e,t){return e===t},i=0,n=function(){var n=e.value[i];-1===r.findIndex(function(e){return t(n,e)})?e.value.splice(i,1):i++};i<e.value.length;)n();i=0;for(var o=function(){var n=r[i];-1===e.value.findIndex(function(e){return t(n,e)})&&e.value.push(n),i++};i<r.length;)o();return{v:void 0}}();if("object"===(void 0===a?"undefined":_typeof$4(a)))return a.v}}else r=0===i?null:r[0];r!==this.value&&(this.oldValue=this.value,this.value=r,this.notify())},e.prototype.notify=function(){var e=this.oldValue,t=this.value;this.callSubscribers(t,e)},e.prototype.handleEvent=function(){this.synchronizeValue()},e.prototype.subscribe=function(e,t){this.hasSubscribers()||this.handler.subscribe(this.element,this),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&this.handler.dispose()},e.prototype.bind=function(){var e=this;this.domObserver=DOM.createMutationObserver(function(){e.synchronizeOptions(),e.synchronizeValue()}),this.domObserver.observe(this.element,{childList:!0,subtree:!0,characterData:!0})},e.prototype.unbind=function(){this.domObserver.disconnect(),this.domObserver=null,this.arrayObserver&&(this.arrayObserver.unsubscribe(selectArrayContext,this),this.arrayObserver=null)},e}())||_class10,ClassObserver=function(){function e(e){this.element=e,this.doNotCache=!0,this.value="",this.version=0}return e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(e){var t=this.nameIndex||{},i=this.version,r=void 0,n=void 0;if(null!=e&&e.length)for(var o=0,s=(r=e.split(/\s+/)).length;o<s;o++)""!==(n=r[o])&&(t[n]=i,this.element.classList.add(n));if(this.value=e,this.nameIndex=t,this.version+=1,0!==i)for(n in i-=1,t)t.hasOwnProperty(n)&&t[n]===i&&this.element.classList.remove(n)},e.prototype.subscribe=function(){throw new Error('Observation of a "'+this.element.nodeName+'" element\'s "class" property is not supported.')},e}();function hasDeclaredDependencies(e){return!!(e&&e.get&&e.get.dependencies)}function declarePropertyDependencies(e,t,i){Object.getOwnPropertyDescriptor(e.prototype,t).get.dependencies=i}function computedFrom(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e,i,r){return r.get.dependencies=t,r}}var ComputedExpression=function(e){function t(t,i){var r=_possibleConstructorReturn(this,e.call(this));return r.name=t,r.dependencies=i,r.isAssignable=!0,r}return _inherits(t,e),t.prototype.evaluate=function(e,t){return e.bindingContext[this.name]},t.prototype.assign=function(e,t){e.bindingContext[this.name]=t},t.prototype.accept=function(e){throw new Error("not implemented")},t.prototype.connect=function(e,t){for(var i=this.dependencies,r=i.length;r--;)i[r].connect(e,t)},t}(Expression);function createComputedObserver(e,t,i,r){var n=i.get.dependencies;if(!(n instanceof ComputedExpression)){for(var o=n.length;o--;)n[o]=r.parser.parse(n[o]);n=i.get.dependencies=new ComputedExpression(t,n)}var s={bindingContext:e,overrideContext:createOverrideContext(e)};return new ExpressionObserver(s,n,r)}var svgElements=void 0,svgPresentationElements=void 0,svgPresentationAttributes=void 0,svgAnalyzer=void 0;if("undefined"==typeof FEATURE_NO_SVG){svgElements={a:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","target","transform","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],altGlyph:["class","dx","dy","externalResourcesRequired","format","glyphRef","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],altGlyphDef:["id","xml:base","xml:lang","xml:space"],altGlyphItem:["id","xml:base","xml:lang","xml:space"],animate:["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],animateColor:["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],animateMotion:["accumulate","additive","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keyPoints","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","origin","path","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","rotate","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],animateTransform:["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","type","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],circle:["class","cx","cy","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","r","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],clipPath:["class","clipPathUnits","externalResourcesRequired","id","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],"color-profile":["id","local","name","rendering-intent","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],cursor:["externalResourcesRequired","id","requiredExtensions","requiredFeatures","systemLanguage","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],defs:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],desc:["class","id","style","xml:base","xml:lang","xml:space"],ellipse:["class","cx","cy","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rx","ry","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],feBlend:["class","height","id","in","in2","mode","result","style","width","x","xml:base","xml:lang","xml:space","y"],feColorMatrix:["class","height","id","in","result","style","type","values","width","x","xml:base","xml:lang","xml:space","y"],feComponentTransfer:["class","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"],feComposite:["class","height","id","in","in2","k1","k2","k3","k4","operator","result","style","width","x","xml:base","xml:lang","xml:space","y"],feConvolveMatrix:["bias","class","divisor","edgeMode","height","id","in","kernelMatrix","kernelUnitLength","order","preserveAlpha","result","style","targetX","targetY","width","x","xml:base","xml:lang","xml:space","y"],feDiffuseLighting:["class","diffuseConstant","height","id","in","kernelUnitLength","result","style","surfaceScale","width","x","xml:base","xml:lang","xml:space","y"],feDisplacementMap:["class","height","id","in","in2","result","scale","style","width","x","xChannelSelector","xml:base","xml:lang","xml:space","y","yChannelSelector"],feDistantLight:["azimuth","elevation","id","xml:base","xml:lang","xml:space"],feFlood:["class","height","id","result","style","width","x","xml:base","xml:lang","xml:space","y"],feFuncA:["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"],feFuncB:["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"],feFuncG:["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"],feFuncR:["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"],feGaussianBlur:["class","height","id","in","result","stdDeviation","style","width","x","xml:base","xml:lang","xml:space","y"],feImage:["class","externalResourcesRequired","height","id","preserveAspectRatio","result","style","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],feMerge:["class","height","id","result","style","width","x","xml:base","xml:lang","xml:space","y"],feMergeNode:["id","xml:base","xml:lang","xml:space"],feMorphology:["class","height","id","in","operator","radius","result","style","width","x","xml:base","xml:lang","xml:space","y"],feOffset:["class","dx","dy","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"],fePointLight:["id","x","xml:base","xml:lang","xml:space","y","z"],feSpecularLighting:["class","height","id","in","kernelUnitLength","result","specularConstant","specularExponent","style","surfaceScale","width","x","xml:base","xml:lang","xml:space","y"],feSpotLight:["id","limitingConeAngle","pointsAtX","pointsAtY","pointsAtZ","specularExponent","x","xml:base","xml:lang","xml:space","y","z"],feTile:["class","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"],feTurbulence:["baseFrequency","class","height","id","numOctaves","result","seed","stitchTiles","style","type","width","x","xml:base","xml:lang","xml:space","y"],filter:["class","externalResourcesRequired","filterRes","filterUnits","height","id","primitiveUnits","style","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],font:["class","externalResourcesRequired","horiz-adv-x","horiz-origin-x","horiz-origin-y","id","style","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"],"font-face":["accent-height","alphabetic","ascent","bbox","cap-height","descent","font-family","font-size","font-stretch","font-style","font-variant","font-weight","hanging","id","ideographic","mathematical","overline-position","overline-thickness","panose-1","slope","stemh","stemv","strikethrough-position","strikethrough-thickness","underline-position","underline-thickness","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","widths","x-height","xml:base","xml:lang","xml:space"],"font-face-format":["id","string","xml:base","xml:lang","xml:space"],"font-face-name":["id","name","xml:base","xml:lang","xml:space"],"font-face-src":["id","xml:base","xml:lang","xml:space"],"font-face-uri":["id","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],foreignObject:["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xml:base","xml:lang","xml:space","y"],g:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],glyph:["arabic-form","class","d","glyph-name","horiz-adv-x","id","lang","orientation","style","unicode","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"],glyphRef:["class","dx","dy","format","glyphRef","id","style","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],hkern:["g1","g2","id","k","u1","u2","xml:base","xml:lang","xml:space"],image:["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],line:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","x1","x2","xml:base","xml:lang","xml:space","y1","y2"],linearGradient:["class","externalResourcesRequired","gradientTransform","gradientUnits","id","spreadMethod","style","x1","x2","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y1","y2"],marker:["class","externalResourcesRequired","id","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","style","viewBox","xml:base","xml:lang","xml:space"],mask:["class","externalResourcesRequired","height","id","maskContentUnits","maskUnits","requiredExtensions","requiredFeatures","style","systemLanguage","width","x","xml:base","xml:lang","xml:space","y"],metadata:["id","xml:base","xml:lang","xml:space"],"missing-glyph":["class","d","horiz-adv-x","id","style","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"],mpath:["externalResourcesRequired","id","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],path:["class","d","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","pathLength","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],pattern:["class","externalResourcesRequired","height","id","patternContentUnits","patternTransform","patternUnits","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","viewBox","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],polygon:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","points","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],polyline:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","points","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],radialGradient:["class","cx","cy","externalResourcesRequired","fx","fy","gradientTransform","gradientUnits","id","r","spreadMethod","style","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],rect:["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rx","ry","style","systemLanguage","transform","width","x","xml:base","xml:lang","xml:space","y"],script:["externalResourcesRequired","id","type","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],set:["attributeName","attributeType","begin","dur","end","externalResourcesRequired","fill","id","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],stop:["class","id","offset","style","xml:base","xml:lang","xml:space"],style:["id","media","title","type","xml:base","xml:lang","xml:space"],svg:["baseProfile","class","contentScriptType","contentStyleType","externalResourcesRequired","height","id","onabort","onactivate","onclick","onerror","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onresize","onscroll","onunload","onzoom","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","version","viewBox","width","x","xml:base","xml:lang","xml:space","y","zoomAndPan"],switch:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],symbol:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","preserveAspectRatio","style","viewBox","xml:base","xml:lang","xml:space"],text:["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","transform","x","xml:base","xml:lang","xml:space","y"],textPath:["class","externalResourcesRequired","id","lengthAdjust","method","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","spacing","startOffset","style","systemLanguage","textLength","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],title:["class","id","style","xml:base","xml:lang","xml:space"],tref:["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","x","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],tspan:["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","x","xml:base","xml:lang","xml:space","y"],use:["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],view:["externalResourcesRequired","id","preserveAspectRatio","viewBox","viewTarget","xml:base","xml:lang","xml:space","zoomAndPan"],vkern:["g1","g2","id","k","u1","u2","xml:base","xml:lang","xml:space"]},svgPresentationElements={a:!0,altGlyph:!0,animate:!0,animateColor:!0,circle:!0,clipPath:!0,defs:!0,ellipse:!0,feBlend:!0,feColorMatrix:!0,feComponentTransfer:!0,feComposite:!0,feConvolveMatrix:!0,feDiffuseLighting:!0,feDisplacementMap:!0,feFlood:!0,feGaussianBlur:!0,feImage:!0,feMerge:!0,feMorphology:!0,feOffset:!0,feSpecularLighting:!0,feTile:!0,feTurbulence:!0,filter:!0,font:!0,foreignObject:!0,g:!0,glyph:!0,glyphRef:!0,image:!0,line:!0,linearGradient:!0,marker:!0,mask:!0,"missing-glyph":!0,path:!0,pattern:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,svg:!0,switch:!0,symbol:!0,text:!0,textPath:!0,tref:!0,tspan:!0,use:!0},svgPresentationAttributes={"alignment-baseline":!0,"baseline-shift":!0,"clip-path":!0,"clip-rule":!0,clip:!0,"color-interpolation-filters":!0,"color-interpolation":!0,"color-profile":!0,"color-rendering":!0,color:!0,cursor:!0,direction:!0,display:!0,"dominant-baseline":!0,"enable-background":!0,"fill-opacity":!0,"fill-rule":!0,fill:!0,filter:!0,"flood-color":!0,"flood-opacity":!0,"font-family":!0,"font-size-adjust":!0,"font-size":!0,"font-stretch":!0,"font-style":!0,"font-variant":!0,"font-weight":!0,"glyph-orientation-horizontal":!0,"glyph-orientation-vertical":!0,"image-rendering":!0,kerning:!0,"letter-spacing":!0,"lighting-color":!0,"marker-end":!0,"marker-mid":!0,"marker-start":!0,mask:!0,opacity:!0,overflow:!0,"pointer-events":!0,"shape-rendering":!0,"stop-color":!0,"stop-opacity":!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-miterlimit":!0,"stroke-opacity":!0,"stroke-width":!0,stroke:!0,"text-anchor":!0,"text-decoration":!0,"text-rendering":!0,"unicode-bidi":!0,visibility:!0,"word-spacing":!0,"writing-mode":!0};var createElement=function(e){var t=DOM.createElement("div");return t.innerHTML=e,t.firstChild};svgAnalyzer=function(){function e(){"altglyph"===createElement("<svg><altGlyph /></svg>").firstElementChild.nodeName&&elements.altGlyph&&(elements.altglyph=elements.altGlyph,delete elements.altGlyph,elements.altglyphdef=elements.altGlyphDef,delete elements.altGlyphDef,elements.altglyphitem=elements.altGlyphItem,delete elements.altGlyphItem,elements.glyphref=elements.glyphRef,delete elements.glyphRef)}return e.prototype.isStandardSvgAttribute=function(e,t){return presentationElements[e]&&presentationAttributes[t]||elements[e]&&-1!==elements[e].indexOf(t)},e}()}var elements=svgElements,presentationElements=svgPresentationElements,presentationAttributes=svgPresentationAttributes,SVGAnalyzer=svgAnalyzer||function(){function e(){}return e.prototype.isStandardSvgAttribute=function(){return!1},e}(),ObserverLocator=(_temp=_class12=function(){function e(e,t,i,r,n){this.taskQueue=e,this.eventManager=t,this.dirtyChecker=i,this.svgAnalyzer=r,this.parser=n,this.adapters=[],this.logger=getLogger("observer-locator")}return e.prototype.getObserver=function(e,t){var i,r=e.__observers__;return r&&t in r?r[t]:((i=this.createPropertyObserver(e,t)).doNotCache||(void 0===r&&(r=this.getOrCreateObserversLookup(e)),r[t]=i),i)},e.prototype.getOrCreateObserversLookup=function(e){return e.__observers__||this.createObserversLookup(e)},e.prototype.createObserversLookup=function(e){var t={};return Reflect.defineProperty(e,"__observers__",{enumerable:!1,configurable:!1,writable:!1,value:t})||this.logger.warn("Cannot add observers to object",e),t},e.prototype.addAdapter=function(e){this.adapters.push(e)},e.prototype.getAdapterObserver=function(e,t,i){for(var r=0,n=this.adapters.length;r<n;r++){var o=this.adapters[r].getObserver(e,t,i);if(o)return o}return null},e.prototype.createPropertyObserver=function(e,t){var i,r=void 0,n=void 0;if(!(e instanceof Object))return new PrimitiveObserver(e,t);if(e instanceof DOM.Element){if("class"===t)return new ClassObserver(e);if("style"===t||"css"===t)return new StyleObserver(e,t);if(r=this.eventManager.getElementHandler(e,t),"value"===t&&"select"===e.tagName.toLowerCase())return new SelectValueObserver(e,r,this);if("checked"===t&&"input"===e.tagName.toLowerCase())return new CheckedObserver(e,r,this);if(r)return new ValueAttributeObserver(e,t,r);if(n=/^xlink:(.+)$/.exec(t))return new XLinkAttributeObserver(e,t,n[1]);if("role"===t&&(e instanceof DOM.Element||e instanceof DOM.SVGElement)||/^\w+:|^data-|^aria-/.test(t)||e instanceof DOM.SVGElement&&this.svgAnalyzer.isStandardSvgAttribute(e.nodeName,t))return new DataAttributeObserver(e,t)}if(hasDeclaredDependencies(i=Object.getPropertyDescriptor(e,t)))return createComputedObserver(e,t,i,this);if(i){var o=i.get||i.set;if(o){if(o.getObserver)return o.getObserver(e);var s=this.getAdapterObserver(e,t,i);return s||new DirtyCheckProperty(this.dirtyChecker,e,t)}}return e instanceof Array?"length"===t?this.getArrayObserver(e).getLengthObserver():new DirtyCheckProperty(this.dirtyChecker,e,t):e instanceof Map?"size"===t?this.getMapObserver(e).getLengthObserver():new DirtyCheckProperty(this.dirtyChecker,e,t):e instanceof Set?"size"===t?this.getSetObserver(e).getLengthObserver():new DirtyCheckProperty(this.dirtyChecker,e,t):new SetterObserver(this.taskQueue,e,t)},e.prototype.getAccessor=function(e,t){if(e instanceof DOM.Element){if("class"===t||"style"===t||"css"===t||"value"===t&&("input"===e.tagName.toLowerCase()||"select"===e.tagName.toLowerCase())||"checked"===t&&"input"===e.tagName.toLowerCase()||"model"===t&&"input"===e.tagName.toLowerCase()||/^xlink:.+$/.exec(t))return this.getObserver(e,t);if(/^\w+:|^data-|^aria-/.test(t)||e instanceof DOM.SVGElement&&this.svgAnalyzer.isStandardSvgAttribute(e.nodeName,t)||"img"===e.tagName.toLowerCase()&&"src"===t||"a"===e.tagName.toLowerCase()&&"href"===t)return dataAttributeAccessor}return propertyAccessor},e.prototype.getArrayObserver=function(e){return _getArrayObserver(this.taskQueue,e)},e.prototype.getMapObserver=function(e){return _getMapObserver(this.taskQueue,e)},e.prototype.getSetObserver=function(e){return _getSetObserver(this.taskQueue,e)},e}(),_class12.inject=[TaskQueue,EventManager,DirtyChecker,SVGAnalyzer,Parser],_temp),ObjectObservationAdapter=function(){function e(){}return e.prototype.getObserver=function(e,t,i){throw new Error("BindingAdapters must implement getObserver(object, propertyName).")},e}(),BindingExpression=function(){function e(e,t,i,r,n,o){this.observerLocator=e,this.targetProperty=t,this.sourceExpression=i,this.mode=r,this.lookupFunctions=n,this.attribute=o,this.discrete=!1}return e.prototype.createBinding=function(e){return new Binding(this.observerLocator,this.sourceExpression,e,this.targetProperty,this.mode,this.lookupFunctions)},e}(),Binding=(_dec10=connectable())(_class13=function(){function e(e,t,i,r,n,o){this.observerLocator=e,this.sourceExpression=t,this.target=i,this.targetProperty=r,this.mode=n,this.lookupFunctions=o}return e.prototype.updateTarget=function(e){this.targetObserver.setValue(e,this.target,this.targetProperty)},e.prototype.updateSource=function(e){this.sourceExpression.assign(this.source,e,this.lookupFunctions)},e.prototype.call=function(e,t,i){if(this.isBound){if(e===sourceContext)return i=this.targetObserver.getValue(this.target,this.targetProperty),(t=this.sourceExpression.evaluate(this.source,this.lookupFunctions))!==i&&this.updateTarget(t),void(this.mode!==bindingMode.oneTime&&(this._version++,this.sourceExpression.connect(this,this.source),this.unobserve(!1)));if(e!==targetContext)throw new Error("Unexpected call context "+e);t!==this.sourceExpression.evaluate(this.source,this.lookupFunctions)&&this.updateSource(t)}},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions);var t=this.mode;if(!this.targetObserver){var i=t===bindingMode.twoWay||t===bindingMode.fromView?"getObserver":"getAccessor";this.targetObserver=this.observerLocator[i](this.target,this.targetProperty)}if("bind"in this.targetObserver&&this.targetObserver.bind(),this.mode!==bindingMode.fromView){var r=this.sourceExpression.evaluate(e,this.lookupFunctions);this.updateTarget(r)}t!==bindingMode.oneTime&&(t===bindingMode.toView?enqueueBindingConnect(this):t===bindingMode.twoWay?(this.sourceExpression.connect(this,e),this.targetObserver.subscribe(targetContext,this)):t===bindingMode.fromView&&this.targetObserver.subscribe(targetContext,this))},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null,"unbind"in this.targetObserver&&this.targetObserver.unbind(),this.targetObserver.unsubscribe&&this.targetObserver.unsubscribe(targetContext,this),this.unobserve(!0))},e.prototype.connect=function(e){if(this.isBound){if(e){var t=this.sourceExpression.evaluate(this.source,this.lookupFunctions);this.updateTarget(t)}this.sourceExpression.connect(this,this.source)}},e}())||_class13,CallExpression=function(){function e(e,t,i,r){this.observerLocator=e,this.targetProperty=t,this.sourceExpression=i,this.lookupFunctions=r}return e.prototype.createBinding=function(e){return new Call(this.observerLocator,this.sourceExpression,e,this.targetProperty,this.lookupFunctions)},e}(),Call=function(){function e(e,t,i,r,n){this.sourceExpression=t,this.target=i,this.targetProperty=e.getObserver(i,r),this.lookupFunctions=n}return e.prototype.callSource=function(e){var t=this.source.overrideContext;Object.assign(t,e),t.$event=e;var i=this.sourceExpression.evaluate(this.source,this.lookupFunctions,!0);for(var r in delete t.$event,e)delete t[r];return i},e.prototype.bind=function(e){var t=this;if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions),this.targetProperty.setValue(function(e){return t.callSource(e)})},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null,this.targetProperty.setValue(null))},e}(),ValueConverterResource=function(){function e(e){this.name=e}return e.convention=function(t){if(t.endsWith("ValueConverter"))return new e(camelCase(t.substring(0,t.length-14)))},e.prototype.initialize=function(e,t){this.instance=e.get(t)},e.prototype.register=function(e,t){e.registerValueConverter(t||this.name,this.instance)},e.prototype.load=function(e,t){},e}();function valueConverter(e){if(void 0===e||"string"==typeof e)return function(t){metadata.define(metadata.resource,new ValueConverterResource(e),t)};metadata.define(metadata.resource,new ValueConverterResource,e)}var BindingBehaviorResource=function(){function e(e){this.name=e}return e.convention=function(t){if(t.endsWith("BindingBehavior"))return new e(camelCase(t.substring(0,t.length-15)))},e.prototype.initialize=function(e,t){this.instance=e.get(t)},e.prototype.register=function(e,t){e.registerBindingBehavior(t||this.name,this.instance)},e.prototype.load=function(e,t){},e}();function bindingBehavior(e){if(void 0===e||"string"==typeof e)return function(t){metadata.define(metadata.resource,new BindingBehaviorResource(e),t)};metadata.define(metadata.resource,new BindingBehaviorResource,e)}var ListenerExpression=function(){function e(e,t,i,r,n,o){this.eventManager=e,this.targetEvent=t,this.sourceExpression=i,this.delegationStrategy=r,this.discrete=!0,this.preventDefault=n,this.lookupFunctions=o}return e.prototype.createBinding=function(e){return new Listener(this.eventManager,this.targetEvent,this.delegationStrategy,this.sourceExpression,e,this.preventDefault,this.lookupFunctions)},e}(),Listener=function(){function e(e,t,i,r,n,o,s){this.eventManager=e,this.targetEvent=t,this.delegationStrategy=i,this.sourceExpression=r,this.target=n,this.preventDefault=o,this.lookupFunctions=s}return e.prototype.callSource=function(e){var t=this.source.overrideContext;t.$event=e;var i=this.sourceExpression.evaluate(this.source,this.lookupFunctions,!0);return delete t.$event,!0!==i&&this.preventDefault&&e.preventDefault(),i},e.prototype.handleEvent=function(e){this.callSource(e)},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions),this._handler=this.eventManager.addEventListener(this.target,this.targetEvent,this,this.delegationStrategy,!0)},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null,this._handler.dispose(),this._handler=null)},e}();function getAU(e){var t=e.au;if(void 0===t)throw new Error('No Aurelia APIs are defined for the element: "'+e.tagName+'".');return t}var NameExpression=function(){function e(e,t,i){this.sourceExpression=e,this.apiName=t,this.lookupFunctions=i,this.discrete=!0}return e.prototype.createBinding=function(t){return new NameBinder(this.sourceExpression,e.locateAPI(t,this.apiName),this.lookupFunctions)},e.locateAPI=function(e,t){switch(t){case"element":return e;case"controller":return getAU(e).controller;case"view-model":return getAU(e).controller.viewModel;case"view":return getAU(e).controller.view;default:var i=getAU(e)[t];if(void 0===i)throw new Error('Attempted to reference "'+t+"\", but it was not found amongst the target's API.");return i.viewModel}},e}(),NameBinder=function(){function e(e,t,i){this.sourceExpression=e,this.target=t,this.lookupFunctions=i}return e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions),this.sourceExpression.assign(this.source,this.target,this.lookupFunctions)},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.evaluate(this.source,this.lookupFunctions)===this.target&&this.sourceExpression.assign(this.source,null,this.lookupFunctions),this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null)},e}(),LookupFunctions={bindingBehaviors:function(e){return null},valueConverters:function(e){return null}},BindingEngine=(_temp2=_class14=function(){function e(e,t){this.observerLocator=e,this.parser=t}return e.prototype.createBindingExpression=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bindingMode.toView,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:LookupFunctions;return new BindingExpression(this.observerLocator,e,this.parser.parse(t),i,r)},e.prototype.propertyObserver=function(e,t){var i=this;return{subscribe:function(r){var n=i.observerLocator.getObserver(e,t);return n.subscribe(r),{dispose:function(){return n.unsubscribe(r)}}}}},e.prototype.collectionObserver=function(e){var t=this;return{subscribe:function(i){var r=void 0;if(e instanceof Array)r=t.observerLocator.getArrayObserver(e);else if(e instanceof Map)r=t.observerLocator.getMapObserver(e);else{if(!(e instanceof Set))throw new Error("collection must be an instance of Array, Map or Set.");r=t.observerLocator.getSetObserver(e)}return r.subscribe(i),{dispose:function(){return r.unsubscribe(i)}}}}},e.prototype.expressionObserver=function(e,t){var i={bindingContext:e,overrideContext:createOverrideContext(e)};return new ExpressionObserver(i,this.parser.parse(t),this.observerLocator,LookupFunctions)},e.prototype.parseExpression=function(e){return this.parser.parse(e)},e.prototype.registerAdapter=function(e){this.observerLocator.addAdapter(e)},e}(),_class14.inject=[ObserverLocator,Parser],_temp2),setProto=Set.prototype;function _getSetObserver(e,t){return ModifySetObserver.for(e,t)}var ModifySetObserver=function(e){function t(t,i){return _possibleConstructorReturn(this,e.call(this,t,i))}return _inherits(t,e),t.for=function(e,i){return"__set_observer__"in i||Reflect.defineProperty(i,"__set_observer__",{value:t.create(e,i),enumerable:!1,configurable:!1}),i.__set_observer__},t.create=function(e,i){var r=new t(e,i),n=setProto;return n.add===i.add&&n.delete===i.delete&&n.clear===i.clear||(n={add:i.add,delete:i.delete,clear:i.clear}),i.add=function(){var e=i.size,t=n.add.apply(i,arguments);return i.size===e||r.addChangeRecord({type:"add",object:i,value:Array.from(i).pop()}),t},i.delete=function(){var e=i.has(arguments[0]),t=n.delete.apply(i,arguments);return e&&r.addChangeRecord({type:"delete",object:i,value:arguments[0]}),t},i.clear=function(){var e=n.clear.apply(i,arguments);return r.addChangeRecord({type:"clear",object:i}),e},r},t}(ModifyCollectionObserver);function observable(e,t,i){function r(e,t,i,r){var n=void 0===t;n&&(e=e.prototype,t="string"==typeof r?r:r.name);var o="_"+t,s={configurable:!0,enumerable:!1,writable:!0},a=r&&r.changeHandler||t+"Changed";if(i?"function"==typeof i.initializer&&(s.value=i.initializer()):i={},"enumerable"in i||(i.enumerable=!0),delete i.value,delete i.writable,delete i.initializer,Reflect.defineProperty(e,o,s),i.get=function(){return this[o]},i.set=function(e){var i=this[o];e!==i&&(this[o]=e,Reflect.defineProperty(this,o,{enumerable:!1}),this[a]&&this[a](e,i,t))},i.get.dependencies=[o],!n)return i;Reflect.defineProperty(e,t,i)}return void 0===t?function(t,i,n){return r(t,i,n,e)}:r(e,t,i)}var signals={};function connectBindingToSignal(e,t){signals.hasOwnProperty(t)||(signals[t]=0),e.observeProperty(signals,t)}function signalBindings(e){signals.hasOwnProperty(e)&&signals[e]++}var _class$2,_temp$1,_dec$2,_class2$2,_dec2$2,_class3$2,_dec3$2,_class4$1,_dec4$2,_class5$2,_dec5$2,_class6$1,_dec6$2,_class7$2,_class8$1,_temp2$1,_class9$1,_temp3,_class11,_dec7$2,_class13$1,_dec8$1,_class14$1,_class15,_temp4,_dec9$1,_class16,_dec10$1,_class17,_dec11,_class18,_createClass$2=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},animationEvent={enterBegin:"animation:enter:begin",enterActive:"animation:enter:active",enterDone:"animation:enter:done",enterTimeout:"animation:enter:timeout",leaveBegin:"animation:leave:begin",leaveActive:"animation:leave:active",leaveDone:"animation:leave:done",leaveTimeout:"animation:leave:timeout",staggerNext:"animation:stagger:next",removeClassBegin:"animation:remove-class:begin",removeClassActive:"animation:remove-class:active",removeClassDone:"animation:remove-class:done",removeClassTimeout:"animation:remove-class:timeout",addClassBegin:"animation:add-class:begin",addClassActive:"animation:add-class:active",addClassDone:"animation:add-class:done",addClassTimeout:"animation:add-class:timeout",animateBegin:"animation:animate:begin",animateActive:"animation:animate:active",animateDone:"animation:animate:done",animateTimeout:"animation:animate:timeout",sequenceBegin:"animation:sequence:begin",sequenceDone:"animation:sequence:done"},Animator=function(){function e(){}return e.prototype.enter=function(e){return Promise.resolve(!1)},e.prototype.leave=function(e){return Promise.resolve(!1)},e.prototype.removeClass=function(e,t){return e.classList.remove(t),Promise.resolve(!1)},e.prototype.addClass=function(e,t){return e.classList.add(t),Promise.resolve(!1)},e.prototype.animate=function(e,t){return Promise.resolve(!1)},e.prototype.runSequence=function(e){},e.prototype.registerEffect=function(e,t){},e.prototype.unregisterEffect=function(e){},e}(),CompositionTransactionNotifier=function(){function e(e){this.owner=e,this.owner._compositionCount++}return e.prototype.done=function(){this.owner._compositionCount--,this.owner._tryCompleteTransaction()},e}(),CompositionTransactionOwnershipToken=function(){function e(e){this.owner=e,this.owner._ownershipToken=this,this.thenable=this._createThenable()}return e.prototype.waitForCompositionComplete=function(){return this.owner._tryCompleteTransaction(),this.thenable},e.prototype.resolve=function(){this._resolveCallback()},e.prototype._createThenable=function(){var e=this;return new Promise(function(t,i){e._resolveCallback=t})},e}(),CompositionTransaction=function(){function e(){this._ownershipToken=null,this._compositionCount=0}return e.prototype.tryCapture=function(){return null===this._ownershipToken?new CompositionTransactionOwnershipToken(this):null},e.prototype.enlist=function(){return new CompositionTransactionNotifier(this)},e.prototype._tryCompleteTransaction=function(){if(this._compositionCount<=0&&(this._compositionCount=0,null!==this._ownershipToken)){var e=this._ownershipToken;this._ownershipToken=null,e.resolve()}},e}(),capitalMatcher=/([A-Z])/g;function addHyphenAndLower(e){return"-"+e.toLowerCase()}function _hyphenate(e){return(e.charAt(0).toLowerCase()+e.slice(1)).replace(capitalMatcher,addHyphenAndLower)}function _isAllWhitespace(e){return!(e.auInterpolationTarget||/[^\t\n\r ]/.test(e.textContent))}var ViewEngineHooksResource=function(){function e(){}return e.prototype.initialize=function(e,t){this.instance=e.get(t)},e.prototype.register=function(e,t){e.registerViewEngineHooks(this.instance)},e.prototype.load=function(e,t){},e.convention=function(t){if(t.endsWith("ViewEngineHooks"))return new e},e}();function viewEngineHooks(e){var t=function(e){metadata.define(metadata.resource,new ViewEngineHooksResource,e)};return e?t(e):t}var ElementEvents=function(){function e(e){this.element=e,this.subscriptions={}}return e.prototype._enqueueHandler=function(e){this.subscriptions[e.eventName]=this.subscriptions[e.eventName]||[],this.subscriptions[e.eventName].push(e)},e.prototype._dequeueHandler=function(e){var t=void 0,i=this.subscriptions[e.eventName];return i&&(t=i.indexOf(e))>-1&&i.splice(t,1),e},e.prototype.publish=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=DOM.createCustomEvent(e,{cancelable:r,bubbles:i,detail:t});this.element.dispatchEvent(n)},e.prototype.subscribe=function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("function"==typeof t)return new EventHandlerImpl(this,e,t,i,!1)},e.prototype.subscribeOnce=function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("function"==typeof t)return new EventHandlerImpl(this,e,t,i,!0)},e.prototype.dispose=function(e){if(e&&"string"==typeof e){var t=this.subscriptions[e];if(t)for(;t.length;){var i=t.pop();i&&i.dispose()}}else this.disposeAll()},e.prototype.disposeAll=function(){for(var e in this.subscriptions)this.dispose(e)},e}(),EventHandlerImpl=function(){function e(e,t,i,r,n){this.owner=e,this.eventName=t,this.handler=i,this.capture="boolean"==typeof r?r:r.capture,this.bubbles=!this.capture,this.captureOrOptions=r,this.once=n,e.element.addEventListener(t,this,r),e._enqueueHandler(this)}return e.prototype.handleEvent=function(e){(0,this.handler)(e),this.once&&this.dispose()},e.prototype.dispose=function(){this.owner.element.removeEventListener(this.eventName,this,this.captureOrOptions),this.owner._dequeueHandler(this),this.owner=this.handler=null},e}(),ResourceLoadContext=function(){function e(){this.dependencies={}}return e.prototype.addDependency=function(e){this.dependencies[e]=!0},e.prototype.hasDependency=function(e){return e in this.dependencies},e}(),ViewCompileInstruction=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.targetShadowDOM=e,this.compileSurrogate=t,this.associatedModuleId=null};ViewCompileInstruction.normal=new ViewCompileInstruction;var BehaviorInstruction=function(){function e(){}return e.enhance=function(){var t=new e;return t.enhance=!0,t},e.unitTest=function(t,i){var r=new e;return r.type=t,r.attributes=i||{},r},e.element=function(t,i){var r=new e;return r.type=i,r.attributes={},r.anchorIsContainer=!(t.hasAttribute("containerless")||i.containerless),r.initiatedByBehavior=!0,r},e.attribute=function(t,i){var r=new e;return r.attrName=t,r.type=i||null,r.attributes={},r},e.dynamic=function(t,i,r){var n=new e;return n.host=t,n.viewModel=i,n.viewFactory=r,n.inheritBindingContext=!0,n},e}(),biProto=BehaviorInstruction.prototype;biProto.initiatedByBehavior=!1,biProto.enhance=!1,biProto.partReplacements=null,biProto.viewFactory=null,biProto.originalAttrName=null,biProto.skipContentProcessing=!1,biProto.contentFactory=null,biProto.viewModel=null,biProto.anchorIsContainer=!1,biProto.host=null,biProto.attributes=null,biProto.type=null,biProto.attrName=null,biProto.inheritBindingContext=!1,BehaviorInstruction.normal=new BehaviorInstruction;var TargetInstruction=(_temp$1=_class$2=function(){function e(){}return e.shadowSlot=function(t){var i=new e;return i.parentInjectorId=t,i.shadowSlot=!0,i},e.contentExpression=function(t){var i=new e;return i.contentExpression=t,i},e.letElement=function(t){var i=new e;return i.expressions=t,i.letElement=!0,i},e.lifting=function(t,i){var r=new e;return r.parentInjectorId=t,r.expressions=e.noExpressions,r.behaviorInstructions=[i],r.viewFactory=i.viewFactory,r.providers=[i.type.target],r.lifting=!0,r},e.normal=function(t,i,r,n,o,s){var a=new e;return a.injectorId=t,a.parentInjectorId=i,a.providers=r,a.behaviorInstructions=n,a.expressions=o,a.anchorIsContainer=!s||s.anchorIsContainer,a.elementInstruction=s,a},e.surrogate=function(t,i,r,n){var o=new e;return o.expressions=r,o.behaviorInstructions=i,o.providers=t,o.values=n,o},e}(),_class$2.noExpressions=Object.freeze([]),_temp$1),tiProto=TargetInstruction.prototype;tiProto.injectorId=null,tiProto.parentInjectorId=null,tiProto.shadowSlot=!1,tiProto.slotName=null,tiProto.slotFallbackFactory=null,tiProto.contentExpression=null,tiProto.letElement=!1,tiProto.expressions=null,tiProto.expressions=null,tiProto.providers=null,tiProto.viewFactory=null,tiProto.anchorIsContainer=!1,tiProto.elementInstruction=null,tiProto.lifting=!1,tiProto.values=null;var viewStrategy=protocol.create("aurelia:view-strategy",{validate:function(e){return"function"==typeof e.loadViewFactory||"View strategies must implement: loadViewFactory(viewEngine: ViewEngine, compileInstruction: ViewCompileInstruction, loadContext?: ResourceLoadContext): Promise<ViewFactory>"},compose:function(e){"function"!=typeof e.makeRelativeTo&&(e.makeRelativeTo=PLATFORM.noop)}}),RelativeViewStrategy=(_dec$2=viewStrategy())(_class2$2=function(){function e(e){this.path=e,this.absolutePath=null}return e.prototype.loadViewFactory=function(e,t,i,r){return null===this.absolutePath&&this.moduleId&&(this.absolutePath=relativeToFile(this.path,this.moduleId)),t.associatedModuleId=this.moduleId,e.loadViewFactory(this.absolutePath||this.path,t,i,r)},e.prototype.makeRelativeTo=function(e){null===this.absolutePath&&(this.absolutePath=relativeToFile(this.path,e))},e}())||_class2$2,ConventionalViewStrategy=(_dec2$2=viewStrategy())(_class3$2=function(){function e(e,t){this.moduleId=t.moduleId,this.viewUrl=e.convertOriginToViewUrl(t)}return e.prototype.loadViewFactory=function(e,t,i,r){return t.associatedModuleId=this.moduleId,e.loadViewFactory(this.viewUrl,t,i,r)},e}())||_class3$2,NoViewStrategy=(_dec3$2=viewStrategy())(_class4$1=function(){function e(e,t){this.dependencies=e||null,this.dependencyBaseUrl=t||""}return e.prototype.loadViewFactory=function(e,t,i,r){var n=this.entry,o=this.dependencies;if(n&&n.factoryIsReady)return Promise.resolve(null);if(this.entry=n=new TemplateRegistryEntry(this.moduleId||this.dependencyBaseUrl),n.dependencies=[],n.templateIsLoaded=!0,null!==o)for(var s=0,a=o.length;s<a;++s){var l=o[s];"string"==typeof l||"function"==typeof l?n.addDependency(l):n.addDependency(l.from,l.as)}return t.associatedModuleId=this.moduleId,e.loadViewFactory(n,t,i,r)},e}())||_class4$1,TemplateRegistryViewStrategy=(_dec4$2=viewStrategy())(_class5$2=function(){function e(e,t){this.moduleId=e,this.entry=t}return e.prototype.loadViewFactory=function(e,t,i,r){var n=this.entry;return n.factoryIsReady?Promise.resolve(n.factory):(t.associatedModuleId=this.moduleId,e.loadViewFactory(n,t,i,r))},e}())||_class5$2,InlineViewStrategy=(_dec5$2=viewStrategy())(_class6$1=function(){function e(e,t,i){this.markup=e,this.dependencies=t||null,this.dependencyBaseUrl=i||""}return e.prototype.loadViewFactory=function(e,t,i,r){var n=this.entry,o=this.dependencies;if(n&&n.factoryIsReady)return Promise.resolve(n.factory);if(this.entry=n=new TemplateRegistryEntry(this.moduleId||this.dependencyBaseUrl),n.template=DOM.createTemplateFromMarkup(this.markup),null!==o)for(var s=0,a=o.length;s<a;++s){var l=o[s];"string"==typeof l||"function"==typeof l?n.addDependency(l):n.addDependency(l.from,l.as)}return t.associatedModuleId=this.moduleId,e.loadViewFactory(n,t,i,r)},e}())||_class6$1,StaticViewStrategy=(_dec6$2=viewStrategy())(_class7$2=function(){function e(e){("string"==typeof e||e instanceof DOM.Element&&"TEMPLATE"===e.tagName)&&(e={template:e}),this.template=e.template,this.dependencies=e.dependencies||[],this.factoryIsReady=!1,this.onReady=null,this.moduleId="undefined"}return e.prototype.loadViewFactory=function(e,t,i,r){var n=this;if(this.factoryIsReady)return Promise.resolve(this.factory);var o=this.dependencies;return o=(o="function"==typeof o?o():o)||[],o=Array.isArray(o)?o:[o],Promise.all(o).then(function(i){var o=e.container,s=e.appResources,a=e.viewCompiler,l=new ViewResources(s),c=void 0,u=[];r&&l.autoRegister(o,r);var h=i,d=Array.isArray(h),p=0;for(h=d?h:h[Symbol.iterator]();;){var f;if(d){if(p>=h.length)break;f=h[p++]}else{if((p=h.next()).done)break;f=p.value}var v=f;if("function"==typeof v)null!==(c=l.autoRegister(o,v)).elementName&&u.push(c);else{if(!v||"object"!==(void 0===v?"undefined":_typeof$5(v)))throw new Error('dependency neither function nor object. Received: "'+(void 0===v?"undefined":_typeof$5(v))+'"');for(var g in v){var m=v[g];"function"==typeof m&&null!==(c=l.autoRegister(o,m)).elementName&&u.push(c)}}}return Promise.all(u.map(function(e){return e.load(o,e.target)})).then(function(){var e=null!==n.template?a.compile(n.template,l,t):null;return n.factoryIsReady=!0,n.factory=e,e})})},e}())||_class7$2,ViewLocator=(_temp2$1=_class8$1=function(){function e(){}return e.prototype.getViewStrategy=function(t){if(!t)return null;if("object"===(void 0===t?"undefined":_typeof$5(t))&&"getViewStrategy"in t){var i=Origin.get(t.constructor);return"string"==typeof(t=t.getViewStrategy())&&(t=new RelativeViewStrategy(t)),viewStrategy.assert(t),i.moduleId&&t.makeRelativeTo(i.moduleId),t}if("string"==typeof t&&(t=new RelativeViewStrategy(t)),viewStrategy.validate(t))return t;if("function"!=typeof t&&(t=t.constructor),"$view"in t){var r=t.$view,n=void 0;return n=null===(r="function"==typeof r?r.call(t):r)?new NoViewStrategy:r instanceof StaticViewStrategy?r:new StaticViewStrategy(r),metadata.define(e.viewStrategyMetadataKey,n,t),n}var o=Origin.get(t),s=metadata.get(e.viewStrategyMetadataKey,t);if(s)o.moduleId&&(s.moduleId=o.moduleId);else{if(!o.moduleId)throw new Error("Cannot determine default view strategy for object.",t);s=this.createFallbackViewStrategy(o)}return s},e.prototype.createFallbackViewStrategy=function(e){return new ConventionalViewStrategy(this,e)},e.prototype.convertOriginToViewUrl=function(e){var t=e.moduleId;return(t.endsWith(".js")||t.endsWith(".ts")?t.substring(0,t.length-3):t)+".html"},e}(),_class8$1.viewStrategyMetadataKey="aurelia:view-strategy",_temp2$1);function mi(e){throw new Error("BindingLanguage must implement "+e+"().")}var BindingLanguage=function(){function e(){}return e.prototype.inspectAttribute=function(e,t,i,r){mi("inspectAttribute")},e.prototype.createAttributeInstruction=function(e,t,i,r){mi("createAttributeInstruction")},e.prototype.createLetExpressions=function(e,t){mi("createLetExpressions")},e.prototype.inspectTextContent=function(e,t){mi("inspectTextContent")},e}(),noNodes=Object.freeze([]),SlotCustomAttribute=function(){function e(e){this.element=e,this.element.auSlotAttribute=this}return e.inject=function(){return[DOM.Element]},e.prototype.valueChanged=function(e,t){},e}(),PassThroughSlot=function(){function e(e,t,i,r){this.anchor=e,this.anchor.viewSlot=this,this.name=t,this.destinationName=i,this.fallbackFactory=r,this.destinationSlot=null,this.projections=0,this.contentView=null,new SlotCustomAttribute(this.anchor).value=this.destinationName}return e.prototype.renderFallbackContent=function(e,t,i,r){if(null===this.contentView){this.contentView=this.fallbackFactory.create(this.ownerView.container),this.contentView.bind(this.ownerView.bindingContext,this.ownerView.overrideContext);var n=Object.create(null);n[this.destinationSlot.name]=this.destinationSlot,ShadowDOM.distributeView(this.contentView,n,i,r,this.destinationSlot.name)}},e.prototype.passThroughTo=function(e){this.destinationSlot=e},e.prototype.addNode=function(t,i,r,n){null!==this.contentView&&(this.contentView.removeNodes(),this.contentView.detached(),this.contentView.unbind(),this.contentView=null),i.viewSlot instanceof e?i.viewSlot.passThroughTo(this):(this.projections++,this.destinationSlot.addNode(t,i,r,n))},e.prototype.removeView=function(e,t){this.projections--,this.destinationSlot.removeView(e,t),this.needsFallbackRendering&&this.renderFallbackContent(null,noNodes,t)},e.prototype.removeAll=function(e){this.projections=0,this.destinationSlot.removeAll(e),this.needsFallbackRendering&&this.renderFallbackContent(null,noNodes,e)},e.prototype.projectFrom=function(e,t){this.destinationSlot.projectFrom(e,t)},e.prototype.created=function(e){this.ownerView=e},e.prototype.bind=function(e){this.contentView&&this.contentView.bind(e.bindingContext,e.overrideContext)},e.prototype.attached=function(){this.contentView&&this.contentView.attached()},e.prototype.detached=function(){this.contentView&&this.contentView.detached()},e.prototype.unbind=function(){this.contentView&&this.contentView.unbind()},_createClass$2(e,[{key:"needsFallbackRendering",get:function(){return this.fallbackFactory&&0===this.projections}}]),e}(),ShadowSlot=function(){function e(e,t,i){this.anchor=e,this.anchor.isContentProjectionSource=!0,this.anchor.viewSlot=this,this.name=t,this.fallbackFactory=i,this.contentView=null,this.projections=0,this.children=[],this.projectFromAnchors=null,this.destinationSlots=null}return e.prototype.addNode=function(e,t,i,r,n){if(null!==this.contentView&&(this.contentView.removeNodes(),this.contentView.detached(),this.contentView.unbind(),this.contentView=null),t.viewSlot instanceof PassThroughSlot)t.viewSlot.passThroughTo(this);else if(null!==this.destinationSlots)ShadowDOM.distributeNodes(e,[t],this.destinationSlots,this,r);else{t.auOwnerView=e,t.auProjectionSource=i,t.auAssignedSlot=this;var o=this._findAnchor(e,t,i,r);o.parentNode.insertBefore(t,o),this.children.push(t),this.projections++}},e.prototype.removeView=function(e,t){if(null!==this.destinationSlots)ShadowDOM.undistributeView(e,this.destinationSlots,this);else if(this.contentView&&this.contentView.hasSlots)ShadowDOM.undistributeView(e,this.contentView.slots,t);else{var i=this.children.find(function(e){return e.auSlotProjectFrom===t});if(i){for(var r=i.auProjectionChildren,n=0,o=r.length;n<o;++n){var s=r[n];s.auOwnerView===e&&(r.splice(n,1),e.fragment.appendChild(s),n--,o--,this.projections--)}this.needsFallbackRendering&&this.renderFallbackContent(e,noNodes,t)}}},e.prototype.removeAll=function(e){if(null!==this.destinationSlots)ShadowDOM.undistributeAll(this.destinationSlots,this);else if(this.contentView&&this.contentView.hasSlots)ShadowDOM.undistributeAll(this.contentView.slots,e);else{var t=this.children.find(function(t){return t.auSlotProjectFrom===e});if(t){for(var i=t.auProjectionChildren,r=0,n=i.length;r<n;++r){var o=i[r];o.auOwnerView.fragment.appendChild(o),this.projections--}t.auProjectionChildren=[],this.needsFallbackRendering&&this.renderFallbackContent(null,noNodes,e)}}},e.prototype._findAnchor=function(e,t,i,r){if(i){var n=this.children.find(function(e){return e.auSlotProjectFrom===i});if(n){if(void 0!==r)for(var o=n.auProjectionChildren,s=-1,a=void 0,l=0,c=o.length;l<c;++l){var u=o[l];if(u.auOwnerView!==a&&(s++,a=u.auOwnerView,s>=r&&a!==e))return o.splice(l,0,t),u}return n.auProjectionChildren.push(t),n}}return this.anchor},e.prototype.projectTo=function(e){this.destinationSlots=e},e.prototype.projectFrom=function(e,t){var i=DOM.createComment("anchor"),r=this.anchor.parentNode;i.auSlotProjectFrom=t,i.auOwnerView=e,i.auProjectionChildren=[],r.insertBefore(i,this.anchor),this.children.push(i),null===this.projectFromAnchors&&(this.projectFromAnchors=[]),this.projectFromAnchors.push(i)},e.prototype.renderFallbackContent=function(e,t,i,r){if(null===this.contentView&&(this.contentView=this.fallbackFactory.create(this.ownerView.container),this.contentView.bind(this.ownerView.bindingContext,this.ownerView.overrideContext),this.contentView.insertNodesBefore(this.anchor)),this.contentView.hasSlots){var n=this.contentView.slots,o=this.projectFromAnchors;if(null!==o)for(var s in n)for(var a=n[s],l=0,c=o.length;l<c;++l){var u=o[l];a.projectFrom(u.auOwnerView,u.auSlotProjectFrom)}this.fallbackSlots=n,ShadowDOM.distributeNodes(e,t,n,i,r)}},e.prototype.created=function(e){this.ownerView=e},e.prototype.bind=function(e){this.contentView&&this.contentView.bind(e.bindingContext,e.overrideContext)},e.prototype.attached=function(){this.contentView&&this.contentView.attached()},e.prototype.detached=function(){this.contentView&&this.contentView.detached()},e.prototype.unbind=function(){this.contentView&&this.contentView.unbind()},_createClass$2(e,[{key:"needsFallbackRendering",get:function(){return this.fallbackFactory&&0===this.projections}}]),e}(),ShadowDOM=(_temp3=_class9$1=function(){function e(){}return e.getSlotName=function(t){return void 0===t.auSlotAttribute?e.defaultSlotKey:t.auSlotAttribute.value},e.distributeView=function(t,i,r,n,o){var s=void 0;if(null===t)s=noNodes;else{var a=t.fragment.childNodes,l=a.length;s=new Array(l);for(var c=0;c<l;++c)s[c]=a[c]}e.distributeNodes(t,s,i,r,n,o)},e.undistributeView=function(e,t,i){for(var r in t)t[r].removeView(e,i)},e.undistributeAll=function(e,t){for(var i in e)e[i].removeAll(t)},e.distributeNodes=function(t,i,r,n,o,s){for(var a=0,l=i.length;a<l;++a){var c=i[a],u=c.nodeType;if(c.isContentProjectionSource){for(var h in c.viewSlot.projectTo(r),r)r[h].projectFrom(t,c.viewSlot);i.splice(a,1),l--,a--}else if(1===u||3===u||c.viewSlot instanceof PassThroughSlot)if(3===u&&_isAllWhitespace(c))i.splice(a,1),l--,a--;else{var d=r[s||e.getSlotName(c)];d&&(d.addNode(t,c,n,o),i.splice(a,1),l--,a--)}else i.splice(a,1),l--,a--}for(var p in r){var f=r[p];f.needsFallbackRendering&&f.renderFallbackContent(t,i,n,o)}},e}(),_class9$1.defaultSlotKey="__au-default-slot-key__",_temp3);function register(e,t,i,r){if(t){var n=e[t];if(n){if(n!==i)throw new Error("Attempted to register "+r+" when one with the same name already exists. Name: "+t+".")}else e[t]=i}}function validateBehaviorName(e,t){if(/[A-Z]/.test(e)){var i=_hyphenate(e);return getLogger("templating").warn("'"+e+"' is not a valid "+t+" name and has been converted to '"+i+"'. Upper-case letters are not allowed because the DOM is not case-sensitive."),i}return e}var conventionMark="__au_resource__",ViewResources=function(){function e(e,t){this.bindingLanguage=null,this.parent=e||null,this.hasParent=null!==this.parent,this.viewUrl=t||"",this.lookupFunctions={valueConverters:this.getValueConverter.bind(this),bindingBehaviors:this.getBindingBehavior.bind(this)},this.attributes=Object.create(null),this.elements=Object.create(null),this.valueConverters=Object.create(null),this.bindingBehaviors=Object.create(null),this.attributeMap=Object.create(null),this.values=Object.create(null),this.beforeCompile=this.afterCompile=this.beforeCreate=this.afterCreate=this.beforeBind=this.beforeUnbind=!1}return e.convention=function(e,t){var i=void 0;if(t&&conventionMark in t)return t;if("$resource"in e){var r=e.$resource;if("string"==typeof r)(i=t||new HtmlBehaviorResource)[conventionMark]=!0,i.elementName||(i.elementName=validateBehaviorName(r,"custom element"));else{"function"==typeof r&&(r=r.call(e)),"string"==typeof r&&(r={name:r});var n=(r=Object.assign({},r)).type||"element",o=r.name;switch(n){case"element":case"attribute":(i=t||new HtmlBehaviorResource)[conventionMark]=!0,"element"===n?i.elementName||(i.elementName=o?validateBehaviorName(o,"custom element"):_hyphenate(e.name)):i.attributeName||(i.attributeName=o?validateBehaviorName(o,"custom attribute"):_hyphenate(e.name)),"templateController"in r&&(r.liftsContent=r.templateController,delete r.templateController),"defaultBindingMode"in r&&void 0!==i.attributeDefaultBindingMode&&(r.attributeDefaultBindingMode=r.defaultBindingMode,delete r.defaultBindingMode),delete r.name,Object.assign(i,r);break;case"valueConverter":i=new ValueConverterResource(camelCase(o||e.name));break;case"bindingBehavior":i=new BindingBehaviorResource(camelCase(o||e.name));break;case"viewEngineHooks":i=new ViewEngineHooksResource}}if(i instanceof HtmlBehaviorResource){var s="string"==typeof r?void 0:r.bindables,a=i.properties;if(Array.isArray(s))for(var l=0,c=s.length;c>l;++l){var u=s[l];if(!u||"string"!=typeof u&&!u.name)throw new Error('Invalid bindable property at "'+l+'" for class "'+e.name+'". Expected either a string or an object with "name" property.');for(var h=new BindableProperty(u),d=!1,p=0,f=a.length;f>p;++p)if(a[p].name===h.name){d=!0;break}d||h.registerWith(e,i)}}}return i},e.prototype._tryAddHook=function(e,t){if("function"==typeof e[t]){for(var i=e[t].bind(e),r=1,n=void 0;void 0!==this[n=t+r.toString()];)r++;this[t]=!0,this[n]=i}},e.prototype._invokeHook=function(e,t,i,r,n){if(this.hasParent&&this.parent._invokeHook(e,t,i,r,n),this[e]){this[e+"1"](t,i,r,n);var o=e+"2";if(this[o]&&(this[o](t,i,r,n),this[o=e+"3"])){this[o](t,i,r,n);for(var s=4;void 0!==this[o=e+s.toString()];)this[o](t,i,r,n),s++}}},e.prototype.registerViewEngineHooks=function(e){this._tryAddHook(e,"beforeCompile"),this._tryAddHook(e,"afterCompile"),this._tryAddHook(e,"beforeCreate"),this._tryAddHook(e,"afterCreate"),this._tryAddHook(e,"beforeBind"),this._tryAddHook(e,"beforeUnbind")},e.prototype.getBindingLanguage=function(e){return this.bindingLanguage||(this.bindingLanguage=e)},e.prototype.patchInParent=function(e){var t=this.parent;this.parent=e||null,this.hasParent=null!==this.parent,null===e.parent&&(e.parent=t,e.hasParent=null!==t)},e.prototype.relativeToView=function(e){return relativeToFile(e,this.viewUrl)},e.prototype.registerElement=function(e,t){register(this.elements,e,t,"an Element")},e.prototype.getElement=function(e){return this.elements[e]||(this.hasParent?this.parent.getElement(e):null)},e.prototype.mapAttribute=function(e){return this.attributeMap[e]||(this.hasParent?this.parent.mapAttribute(e):null)},e.prototype.registerAttribute=function(e,t,i){this.attributeMap[e]=i,register(this.attributes,e,t,"an Attribute")},e.prototype.getAttribute=function(e){return this.attributes[e]||(this.hasParent?this.parent.getAttribute(e):null)},e.prototype.registerValueConverter=function(e,t){register(this.valueConverters,e,t,"a ValueConverter")},e.prototype.getValueConverter=function(e){return this.valueConverters[e]||(this.hasParent?this.parent.getValueConverter(e):null)},e.prototype.registerBindingBehavior=function(e,t){register(this.bindingBehaviors,e,t,"a BindingBehavior")},e.prototype.getBindingBehavior=function(e){return this.bindingBehaviors[e]||(this.hasParent?this.parent.getBindingBehavior(e):null)},e.prototype.registerValue=function(e,t){register(this.values,e,t,"a value")},e.prototype.getValue=function(e){return this.values[e]||(this.hasParent?this.parent.getValue(e):null)},e.prototype.autoRegister=function(t,i){var r=metadata.getOwn(metadata.resource,i);return r?r instanceof HtmlBehaviorResource&&(e.convention(i,r),null===r.attributeName&&null===r.elementName&&HtmlBehaviorResource.convention(i.name,r),null===r.attributeName&&null===r.elementName&&(r.elementName=_hyphenate(i.name))):((r=e.convention(i)||HtmlBehaviorResource.convention(i.name)||ValueConverterResource.convention(i.name)||BindingBehaviorResource.convention(i.name)||ViewEngineHooksResource.convention(i.name))||((r=new HtmlBehaviorResource).elementName=_hyphenate(i.name)),metadata.define(metadata.resource,r,i)),r.initialize(t,i),r.register(this),r},e}(),View=function(){function e(e,t,i,r,n,o,s){for(var a in this.container=e,this.viewFactory=t,this.resources=t.resources,this.fragment=i,this.firstChild=i.firstChild,this.lastChild=i.lastChild,this.controllers=r,this.bindings=n,this.children=o,this.slots=s,this.hasSlots=!1,this.fromCache=!1,this.isBound=!1,this.isAttached=!1,this.bindingContext=null,this.overrideContext=null,this.controller=null,this.viewModelScope=null,this.animatableElement=void 0,this._isUserControlled=!1,this.contentView=null,s){this.hasSlots=!0;break}}return e.prototype.returnToCache=function(){this.viewFactory.returnViewToCache(this)},e.prototype.created=function(){var e,t=void 0,i=this.controllers;for(t=0,e=i.length;t<e;++t)i[t].created(this)},e.prototype.bind=function(e,t,i){var r=void 0,n=void 0,o=void 0,s=void 0,a=void 0;if(!i||!this._isUserControlled){if(this.isBound){if(this.bindingContext===e)return;this.unbind()}for(this.isBound=!0,this.bindingContext=e,this.overrideContext=t||createOverrideContext(e),this.resources._invokeHook("beforeBind",this),s=0,a=(n=this.bindings).length;s<a;++s)n[s].bind(this);for(null!==this.viewModelScope&&(e.bind(this.viewModelScope.bindingContext,this.viewModelScope.overrideContext),this.viewModelScope=null),s=0,a=(r=this.controllers).length;s<a;++s)r[s].bind(this);for(s=0,a=(o=this.children).length;s<a;++s)o[s].bind(e,t,!0);this.hasSlots&&ShadowDOM.distributeView(this.contentView,this.slots)}},e.prototype.addBinding=function(e){this.bindings.push(e),this.isBound&&e.bind(this)},e.prototype.unbind=function(){var e=void 0,t=void 0,i=void 0,r=void 0,n=void 0;if(this.isBound){for(this.isBound=!1,this.resources._invokeHook("beforeUnbind",this),null!==this.controller&&this.controller.unbind(),r=0,n=(t=this.bindings).length;r<n;++r)t[r].unbind();for(r=0,n=(e=this.controllers).length;r<n;++r)e[r].unbind();for(r=0,n=(i=this.children).length;r<n;++r)i[r].unbind();this.bindingContext=null,this.overrideContext=null}},e.prototype.insertNodesBefore=function(e){e.parentNode.insertBefore(this.fragment,e)},e.prototype.appendNodesTo=function(e){e.appendChild(this.fragment)},e.prototype.removeNodes=function(){for(var e=this.fragment,t=this.firstChild,i=this.lastChild,r=void 0;t&&(r=t.nextSibling,e.appendChild(t),t!==i);)t=r},e.prototype.attached=function(){var e=void 0,t=void 0,i=void 0,r=void 0;if(!this.isAttached){for(this.isAttached=!0,null!==this.controller&&this.controller.attached(),i=0,r=(e=this.controllers).length;i<r;++i)e[i].attached();for(i=0,r=(t=this.children).length;i<r;++i)t[i].attached()}},e.prototype.detached=function(){var e=void 0,t=void 0,i=void 0,r=void 0;if(this.isAttached){for(this.isAttached=!1,null!==this.controller&&this.controller.detached(),i=0,r=(e=this.controllers).length;i<r;++i)e[i].detached();for(i=0,r=(t=this.children).length;i<r;++i)t[i].detached()}},e}();function getAnimatableElement(e){if(void 0!==e.animatableElement)return e.animatableElement;for(var t=e.firstChild;t&&1!==t.nodeType;)t=t.nextSibling;return t&&1===t.nodeType?e.animatableElement=t.classList.contains("au-animate")?t:null:e.animatableElement=null}var ViewSlot=function(){function e(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Animator.instance;this.anchor=e,this.anchorIsContainer=t,this.bindingContext=null,this.overrideContext=null,this.animator=i,this.children=[],this.isBound=!1,this.isAttached=!1,this.contentSelectors=null,e.viewSlot=this,e.isContentProjectionSource=!1}return e.prototype.animateView=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"enter",i=getAnimatableElement(e);if(null!==i)switch(t){case"enter":return this.animator.enter(i);case"leave":return this.animator.leave(i);default:throw new Error("Invalid animation direction: "+t)}},e.prototype.transformChildNodesIntoView=function(){var e=this.anchor;this.children.push({fragment:e,firstChild:e.firstChild,lastChild:e.lastChild,returnToCache:function(){},removeNodes:function(){for(var t=void 0;t=e.lastChild;)e.removeChild(t)},created:function(){},bind:function(){},unbind:function(){},attached:function(){},detached:function(){}})},e.prototype.bind=function(e,t){var i,r=void 0,n=void 0;if(this.isBound){if(this.bindingContext===e)return;this.unbind()}for(this.isBound=!0,this.bindingContext=e=e||this.bindingContext,this.overrideContext=t=t||this.overrideContext,r=0,i=(n=this.children).length;r<i;++r)n[r].bind(e,t,!0)},e.prototype.unbind=function(){if(this.isBound){var e,t=void 0,i=this.children;for(this.isBound=!1,this.bindingContext=null,this.overrideContext=null,t=0,e=i.length;t<e;++t)i[t].unbind()}},e.prototype.add=function(e){if(this.anchorIsContainer?e.appendNodesTo(this.anchor):e.insertNodesBefore(this.anchor),this.children.push(e),this.isAttached)return e.attached(),this.animateView(e,"enter")},e.prototype.insert=function(e,t){var i=this.children,r=i.length;return 0===e&&0===r||e>=r?this.add(t):(t.insertNodesBefore(i[e].firstChild),i.splice(e,0,t),this.isAttached?(t.attached(),this.animateView(t,"enter")):void 0)},e.prototype.move=function(e,t){if(e!==t){var i=this.children,r=i[e];r.removeNodes(),r.insertNodesBefore(i[t].firstChild),i.splice(e,1),i.splice(t,0,r)}},e.prototype.remove=function(e,t,i){return this.removeAt(this.children.indexOf(e),t,i)},e.prototype.removeMany=function(e,t,i){var r=this,n=this.children,o=e.length,s=void 0,a=[];e.forEach(function(e){if(i)e.removeNodes();else{var t=r.animateView(e,"leave");t?a.push(t.then(function(){return e.removeNodes()})):e.removeNodes()}});var l=function(){if(r.isAttached)for(s=0;s<o;++s)e[s].detached();if(t)for(s=0;s<o;++s)e[s].returnToCache();for(s=0;s<o;++s){var i=n.indexOf(e[s]);i>=0&&n.splice(i,1)}};return a.length>0?Promise.all(a).then(function(){return l()}):l()},e.prototype.removeAt=function(e,t,i){var r=this,n=this.children[e],o=function(){return e=r.children.indexOf(n),n.removeNodes(),r.children.splice(e,1),r.isAttached&&n.detached(),t&&n.returnToCache(),n};if(!i){var s=this.animateView(n,"leave");if(s)return s.then(function(){return o()})}return o()},e.prototype.removeAll=function(e,t){var i=this,r=this.children,n=r.length,o=void 0,s=[];r.forEach(function(e){if(t)e.removeNodes();else{var r=i.animateView(e,"leave");r?s.push(r.then(function(){return e.removeNodes()})):e.removeNodes()}});var a=function(){if(i.isAttached)for(o=0;o<n;++o)r[o].detached();if(e)for(o=0;o<n;++o){var t=r[o];t&&t.returnToCache()}i.children=[]};return s.length>0?Promise.all(s).then(function(){return a()}):a()},e.prototype.attached=function(){var e,t,i=void 0,r=void 0;if(!this.isAttached)for(this.isAttached=!0,i=0,e=(t=this.children).length;i<e;++i)(r=t[i]).attached(),this.animateView(r,"enter")},e.prototype.detached=function(){var e=void 0,t=void 0,i=void 0;if(this.isAttached)for(this.isAttached=!1,e=0,t=(i=this.children).length;e<t;++e)i[e].detached()},e.prototype.projectTo=function(e){var t=this;this.projectToSlots=e,this.add=this._projectionAdd,this.insert=this._projectionInsert,this.move=this._projectionMove,this.remove=this._projectionRemove,this.removeAt=this._projectionRemoveAt,this.removeMany=this._projectionRemoveMany,this.removeAll=this._projectionRemoveAll,this.children.forEach(function(i){return ShadowDOM.distributeView(i,e,t)})},e.prototype._projectionAdd=function(e){ShadowDOM.distributeView(e,this.projectToSlots,this),this.children.push(e),this.isAttached&&e.attached()},e.prototype._projectionInsert=function(e,t){0===e&&!this.children.length||e>=this.children.length?this.add(t):(ShadowDOM.distributeView(t,this.projectToSlots,this,e),this.children.splice(e,0,t),this.isAttached&&t.attached())},e.prototype._projectionMove=function(e,t){if(e!==t){var i=this.children,r=i[e];ShadowDOM.undistributeView(r,this.projectToSlots,this),ShadowDOM.distributeView(r,this.projectToSlots,this,t),i.splice(e,1),i.splice(t,0,r)}},e.prototype._projectionRemove=function(e,t){ShadowDOM.undistributeView(e,this.projectToSlots,this),this.children.splice(this.children.indexOf(e),1),this.isAttached&&e.detached(),t&&e.returnToCache()},e.prototype._projectionRemoveAt=function(e,t){var i=this.children[e];ShadowDOM.undistributeView(i,this.projectToSlots,this),this.children.splice(e,1),this.isAttached&&i.detached(),t&&i.returnToCache()},e.prototype._projectionRemoveMany=function(e,t){var i=this;e.forEach(function(e){return i.remove(e,t)})},e.prototype._projectionRemoveAll=function(e){ShadowDOM.undistributeAll(this.projectToSlots,this);for(var t=this.children,i=t.length,r=0;r<i;++r)e?t[r].returnToCache():this.isAttached&&t[r].detached();this.children=[]},e}(),ProviderResolver=resolver(_class11=function(){function e(){}return e.prototype.get=function(e,t){var i=t.__providerId__;return i in e?e[i]:e[i]=e.invoke(t)},e}())||_class11,providerResolverInstance=new ProviderResolver;function elementContainerGet(e){if(e===DOM.Element)return this.element;if(e===BoundViewFactory){if(this.boundViewFactory)return this.boundViewFactory;var t=this.instruction.viewFactory,i=this.partReplacements;return i&&(t=i[t.part]||t),this.boundViewFactory=new BoundViewFactory(this,t,i),this.boundViewFactory}return e===ViewSlot?(void 0===this.viewSlot&&(this.viewSlot=new ViewSlot(this.element,this.instruction.anchorIsContainer),this.element.isContentProjectionSource=this.instruction.lifting,this.children.push(this.viewSlot)),this.viewSlot):e===ElementEvents?this.elementEvents||(this.elementEvents=new ElementEvents(this.element)):e===CompositionTransaction?this.compositionTransaction||(this.compositionTransaction=this.parent.get(e)):e===ViewResources?this.viewResources:e===TargetInstruction?this.instruction:this.superGet(e)}function createElementContainer(e,t,i,r,n,o){var s,a=e.createChild(),l=void 0;for(a.element=t,a.instruction=i,a.children=r,a.viewResources=o,a.partReplacements=n,l=(s=i.providers).length;l--;)a._resolvers.set(s[l],providerResolverInstance);return a.superGet=a.get,a.get=elementContainerGet,a}function hasAttribute(e){return this._element.hasAttribute(e)}function getAttribute(e){return this._element.getAttribute(e)}function setAttribute(e,t){this._element.setAttribute(e,t)}function makeElementIntoAnchor(e,t){var i=DOM.createComment("anchor");if(t){var r=e.firstChild;r&&"AU-CONTENT"===r.tagName&&(i.contentElement=r),i._element=e,i.hasAttribute=hasAttribute,i.getAttribute=getAttribute,i.setAttribute=setAttribute}return DOM.replaceNode(i,e),i}function applyInstructions(e,t,i,r,n,o,s,a,l){var c=i.behaviorInstructions,u=i.expressions,h=void 0,d=void 0,p=void 0,f=void 0,v=void 0;if(i.contentExpression)return n.push(i.contentExpression.createBinding(t.nextSibling)),t.nextSibling.auInterpolationTarget=!0,void t.parentNode.removeChild(t);if(i.shadowSlot){var g=DOM.createComment("slot"),m=void 0;return m=i.slotDestination?new PassThroughSlot(g,i.slotName,i.slotDestination,i.slotFallbackFactory):new ShadowSlot(g,i.slotName,i.slotFallbackFactory),DOM.replaceNode(g,t),s[i.slotName]=m,void r.push(m)}if(i.letElement){for(d=0,p=u.length;d<p;++d)n.push(u[d].createBinding());t.parentNode.removeChild(t)}else{if(c.length)for(i.anchorIsContainer||(t=makeElementIntoAnchor(t,i.elementInstruction)),e[i.injectorId]=h=createElementContainer(e[i.parentInjectorId],t,i,o,a,l),d=0,p=c.length;d<p;++d)v=(f=c[d]).type.create(h,f,t,n),r.push(v);for(d=0,p=u.length;d<p;++d)n.push(u[d].createBinding(t))}}function styleStringToObject(e,t){var i=e.split(";"),r=void 0,n=void 0,o=void 0,s=void 0,a=void 0;for(t=t||{},n=0;n<i.length;n++)r=(o=i[n]).indexOf(":"),s=o.substring(0,r).trim(),a=o.substring(r+1).trim(),t[s]=a;return t}function styleObjectToString(e){var t="";for(var i in e)t+=i+":"+e[i]+";";return t}function applySurrogateInstruction(e,t,i,r,n,o){var s=i.behaviorInstructions,a=i.expressions,l=i.providers,c=i.values,u=void 0,h=void 0,d=void 0,p=void 0,f=void 0;for(u=l.length;u--;)e._resolvers.set(l[u],providerResolverInstance);for(var v in c)if(f=t.getAttribute(v)){if("class"===v)t.setAttribute("class",f+" "+c[v]);else if("style"===v){var g=styleStringToObject(c[v]);styleStringToObject(f,g),t.setAttribute("style",styleObjectToString(g))}}else t.setAttribute(v,c[v]);if(s.length)for(u=0,h=s.length;u<h;++u)(p=(d=s[u]).type.create(e,d,t,n)).contentView&&o.push(p.contentView),r.push(p);for(u=0,h=a.length;u<h;++u)n.push(a[u].createBinding(t))}var BoundViewFactory=function(){function e(e,t,i){this.parentContainer=e,this.viewFactory=t,this.factoryCreateInstruction={partReplacements:i}}return e.prototype.create=function(){var e=this.viewFactory.create(this.parentContainer.createChild(),this.factoryCreateInstruction);return e._isUserControlled=!0,e},e.prototype.setCacheSize=function(e,t){this.viewFactory.setCacheSize(e,t)},e.prototype.getCachedView=function(){return this.viewFactory.getCachedView()},e.prototype.returnViewToCache=function(e){this.viewFactory.returnViewToCache(e)},_createClass$2(e,[{key:"isCaching",get:function(){return this.viewFactory.isCaching}}]),e}(),ViewFactory=function(){function e(e,t,i){this.isCaching=!1,this.template=e,this.instructions=t,this.resources=i,this.cacheSize=-1,this.cache=null}return e.prototype.setCacheSize=function(e,t){e&&("*"===e?e=Number.MAX_VALUE:"string"==typeof e&&(e=parseInt(e,10))),-1!==this.cacheSize&&t||(this.cacheSize=e),this.cacheSize>0?this.cache=[]:this.cache=null,this.isCaching=this.cacheSize>0},e.prototype.getCachedView=function(){return null!==this.cache&&this.cache.pop()||null},e.prototype.returnViewToCache=function(e){e.isAttached&&e.detached(),e.isBound&&e.unbind(),null!==this.cache&&this.cache.length<this.cacheSize&&(e.fromCache=!0,this.cache.push(e))},e.prototype.create=function(e,t,i){t=t||BehaviorInstruction.normal;var r=this.getCachedView();if(null!==r)return r;var n,o=t.enhance?this.template:this.template.cloneNode(!0),s=o.querySelectorAll(".au-target"),a=this.instructions,l=this.resources,c=[],u=[],h=[],d=Object.create(null),p={root:e},f=t.partReplacements,v=void 0,g=void 0,m=void 0,b=void 0;for(this.resources._invokeHook("beforeCreate",this,e,o,t),i&&null!==this.surrogateInstruction&&applySurrogateInstruction(e,i,this.surrogateInstruction,c,u,h),t.enhance&&o.hasAttribute("au-target-id")&&(b=a[(m=o).getAttribute("au-target-id")],applyInstructions(p,m,b,c,u,h,d,f,l)),v=0,n=s.length;v<n;++v)b=a[(m=s[v]).getAttribute("au-target-id")],applyInstructions(p,m,b,c,u,h,d,f,l);return g=new View(e,this,o,c,u,h,d),t.initiatedByBehavior||g.created(),this.resources._invokeHook("afterCreate",g),g},e}(),nextInjectorId=0;function getNextInjectorId(){return++nextInjectorId}var lastAUTargetID=0;function getNextAUTargetID(){return(++lastAUTargetID).toString()}function makeIntoInstructionTarget(e){var t=e.getAttribute("class"),i=getNextAUTargetID();return e.setAttribute("class",t?t+" au-target":"au-target"),e.setAttribute("au-target-id",i),i}function makeShadowSlot(e,t,i,r,n){var o=DOM.createElement("au-shadow-slot");DOM.replaceNode(o,i);var s=makeIntoInstructionTarget(o),a=TargetInstruction.shadowSlot(n);if(a.slotName=i.getAttribute("name")||ShadowDOM.defaultSlotKey,a.slotDestination=i.getAttribute("slot"),i.innerHTML.trim()){for(var l=DOM.createDocumentFragment(),c=void 0;c=i.firstChild;)l.appendChild(c);a.slotFallbackFactory=e.compile(l,t)}return r[s]=a,o}var defaultLetHandler=BindingLanguage.prototype.createLetExpressions,ViewCompiler=(_dec7$2=inject(BindingLanguage,ViewResources))(_class13$1=function(){function e(e,t){this.bindingLanguage=e,this.resources=t}return e.prototype.compile=function(e,t,i){t=t||this.resources,i=i||ViewCompileInstruction.normal;var r=void 0,n=void 0,o=void 0;(e="string"==typeof e?DOM.createTemplateFromMarkup(e):e).content?(n=e.getAttribute("part"),o=e.getAttribute("view-cache"),r=DOM.adoptNode(e.content)):r=e,i.targetShadowDOM=i.targetShadowDOM&&FEATURE.shadowDOM,t._invokeHook("beforeCompile",r,t,i);var s={};this._compileNode(r,t,s,e,"root",!i.targetShadowDOM);var a=r.firstChild;if(a&&1===a.nodeType){var l=a.getAttribute("au-target-id");if(l){var c=s[l];(c.shadowSlot||c.lifting||c.elementInstruction&&!c.elementInstruction.anchorIsContainer)&&r.insertBefore(DOM.createComment("view"),a)}}var u=new ViewFactory(r,s,t);return u.surrogateInstruction=i.compileSurrogate?this._compileSurrogate(e,t):null,u.part=n,o&&u.setCacheSize(o),t._invokeHook("afterCompile",u),u},e.prototype._compileNode=function(e,t,i,r,n,o){switch(e.nodeType){case 1:return this._compileElement(e,t,i,r,n,o);case 3:var s=t.getBindingLanguage(this.bindingLanguage).inspectTextContent(t,e.wholeText);if(s){var a=DOM.createElement("au-marker"),l=makeIntoInstructionTarget(a);for((e.parentNode||r).insertBefore(a,e),e.textContent=" ",i[l]=TargetInstruction.contentExpression(s);e.nextSibling&&3===e.nextSibling.nodeType;)(e.parentNode||r).removeChild(e.nextSibling)}else for(;e.nextSibling&&3===e.nextSibling.nodeType;)e=e.nextSibling;return e.nextSibling;case 11:for(var c=e.firstChild;c;)c=this._compileNode(c,t,i,e,n,o)}return e.nextSibling},e.prototype._compileSurrogate=function(e,t){var i=e.tagName.toLowerCase(),r=e.attributes,n=t.getBindingLanguage(this.bindingLanguage),o=void 0,s=void 0,a=void 0,l=void 0,c=void 0,u=void 0,h=void 0,d=void 0,p=void 0,f=void 0,v=[],g=void 0,m=[],b={},y=!1,w=[];for(l=0,c=r.length;l<c;++l){if(h=(u=r[l]).name,d=u.value,p=n.inspectAttribute(t,i,h,d),(f=t.getAttribute(p.attrName))&&(o=t.mapAttribute(p.attrName))&&(s=f.attributes[o])&&(p.defaultBindingMode=s.defaultBindingMode,p.command||p.expression||(p.command=s.hasOptions?"options":null),p.command&&"options"!==p.command&&f.primaryProperty)){var x=f.primaryProperty;h=p.attrName=x.attribute,p.defaultBindingMode=x.defaultBindingMode}if(a=n.createAttributeInstruction(t,e,p,void 0,f))if(a.alteredAttr&&(f=t.getAttribute(a.attrName)),a.discrete)v.push(a);else if(f){if(a.type=f,this._configureProperties(a,t),f.liftsContent)throw new Error("You cannot place a template controller on a surrogate element.");m.push(a)}else v.push(a.attributes[a.attrName]);else if(f){if((a=BehaviorInstruction.attribute(h,f)).attributes[t.mapAttribute(h)]=d,f.liftsContent)throw new Error("You cannot place a template controller on a surrogate element.");m.push(a)}else"id"!==h&&"part"!==h&&"replace-part"!==h&&(y=!0,b[h]=d)}if(v.length||m.length||y){for(l=0,c=m.length;l<c;++l)(a=m[l]).type.compile(this,t,e,a),w.push(a.type.target);for(l=0,c=v.length;l<c;++l)void 0!==(g=v[l]).attrToRemove&&e.removeAttribute(g.attrToRemove);return TargetInstruction.surrogate(w,m,v,b)}return null},e.prototype._compileElement=function(e,t,i,r,n,o){var s=e.tagName.toLowerCase(),a=e.attributes,l=[],c=void 0,u=[],h=[],d=t.getBindingLanguage(this.bindingLanguage),p=void 0,f=void 0,v=void 0,g=void 0,m=void 0,b=void 0,y=void 0,w=void 0,x=void 0,_=void 0,S=void 0,C=void 0,T=void 0,k=void 0,O=void 0,E=void 0;if("slot"===s)return o&&(e=makeShadowSlot(this,t,e,i,n)),e.nextSibling;if("template"===s){if(!("content"in e))throw new Error("You cannot place a template element within "+e.namespaceURI+" namespace");(f=this.compile(e,t)).part=e.getAttribute("part")}else{if(v=t.getElement(e.getAttribute("as-element")||s),"let"===s&&!v&&d.createLetExpressions!==defaultLetHandler)return l=d.createLetExpressions(t,e),i[makeIntoInstructionTarget(e)]=TargetInstruction.letElement(l),e.nextSibling;v&&(g=BehaviorInstruction.element(e,v),v.processAttributes(this,t,e,a,g),u.push(g))}for(b=0,y=a.length;b<y;++b){if(S=x=(w=a[b]).name,_=w.value,T=d.inspectAttribute(t,s,x,_),o&&"slot"===T.attrName&&(T.attrName=x="au-slot"),m=null,v=t.getAttribute(T.attrName)){if((O=t.mapAttribute(T.attrName))&&(k=v.attributes[O])&&(T.defaultBindingMode=k.defaultBindingMode,T.command||T.expression||(T.command=k.hasOptions?"options":null),T.command&&"options"!==T.command&&v.primaryProperty)){var A=v.primaryProperty;x=T.attrName=A.attribute,T.defaultBindingMode=A.defaultBindingMode}}else g&&(m=g.type.attributes[T.attrName])&&(T.defaultBindingMode=m.defaultBindingMode);if(C=m?d.createAttributeInstruction(t,e,T,g):d.createAttributeInstruction(t,e,T,void 0,v))if(C.alteredAttr&&(v=t.getAttribute(C.attrName)),C.discrete)l.push(C);else if(v){if(C.type=v,this._configureProperties(C,t),v.liftsContent){C.originalAttrName=S,p=C;break}u.push(C)}else m?g.attributes[T.attrName].targetProperty=m.name:l.push(C.attributes[C.attrName]);else if(v){if((C=BehaviorInstruction.attribute(x,v)).attributes[t.mapAttribute(x)]=_,v.liftsContent){C.originalAttrName=S,p=C;break}u.push(C)}else m&&(g.attributes[x]=_)}if(p)p.viewFactory=f,i[makeIntoInstructionTarget(e=p.type.compile(this,t,e,p,r))]=TargetInstruction.lifting(n,p);else{var R=!1;if(l.length||u.length){for(E=!!u.length&&getNextInjectorId(),b=0,y=u.length;b<y;++b)(C=u[b]).type.compile(this,t,e,C,r),h.push(C.type.target),R=R||C.skipContentProcessing;for(b=0,y=l.length;b<y;++b)void 0!==(c=l[b]).attrToRemove&&e.removeAttribute(c.attrToRemove);i[makeIntoInstructionTarget(e)]=TargetInstruction.normal(E,n,h,u,l,g)}if(R)return e.nextSibling;for(var P=e.firstChild;P;)P=this._compileNode(P,t,i,e,E||n,o)}return e.nextSibling},e.prototype._configureProperties=function(e,t){var i=e.type,r=e.attrName,n=e.attributes,o=void 0,s=void 0,a=void 0,l=t.mapAttribute(r);for(s in l&&r in n&&l!==r&&(n[l]=n[r],delete n[r]),n)null!==(a=n[s])&&"object"===(void 0===a?"undefined":_typeof$5(a))&&(o=i.attributes[s],a.targetProperty=void 0!==o?o.name:s)},e}())||_class13$1,ResourceModule=function(){function e(e){this.id=e,this.moduleInstance=null,this.mainResource=null,this.resources=null,this.viewStrategy=null,this.isInitialized=!1,this.onLoaded=null,this.loadContext=null}return e.prototype.initialize=function(e){var t=this.mainResource,i=this.resources,r=this.viewStrategy;if(!this.isInitialized){this.isInitialized=!0,void 0!==t&&(t.metadata.viewStrategy=r,t.initialize(e));for(var n=0,o=i.length;n<o;++n)(t=i[n]).metadata.viewStrategy=r,t.initialize(e)}},e.prototype.register=function(e,t){var i=this.mainResource,r=this.resources;void 0!==i&&(i.register(e,t),t=null);for(var n=0,o=r.length;n<o;++n)r[n].register(e,t),t=null},e.prototype.load=function(e,t){if(null!==this.onLoaded)return this.loadContext===t?Promise.resolve():this.onLoaded;var i=this.mainResource,r=this.resources,n=void 0;if(void 0!==i){(n=new Array(r.length+1))[0]=i.load(e,t);for(var o=0,s=r.length;o<s;++o)n[o+1]=r[o].load(e,t)}else{n=new Array(r.length);for(var a=0,l=r.length;a<l;++a)n[a]=r[a].load(e,t)}return this.loadContext=t,this.onLoaded=Promise.all(n),this.onLoaded},e}(),ResourceDescription=function(){function e(e,t,i){i||(i=metadata.get(metadata.resource,t))||((i=new HtmlBehaviorResource).elementName=_hyphenate(e),metadata.define(metadata.resource,i,t)),i instanceof HtmlBehaviorResource?void 0===i.elementName?i.elementName=_hyphenate(e):void 0===i.attributeName?i.attributeName=_hyphenate(e):null===i.attributeName&&null===i.elementName&&HtmlBehaviorResource.convention(e,i):i.name||(i.name=_hyphenate(e)),this.metadata=i,this.value=t}return e.prototype.initialize=function(e){this.metadata.initialize(e,this.value)},e.prototype.register=function(e,t){this.metadata.register(e,t)},e.prototype.load=function(e,t){return this.metadata.load(e,this.value,t)},e}(),ModuleAnalyzer=function(){function e(){this.cache=Object.create(null)}return e.prototype.getAnalysis=function(e){return this.cache[e]},e.prototype.analyze=function(e,t,i){var r=void 0,n=void 0,o=void 0,s=void 0,a=void 0,l=void 0,c=[],u=void 0,h=void 0,d=void 0;if(d=this.cache[e])return d;for(a in d=new ResourceModule(e),this.cache[e]=d,"function"==typeof t&&(t={default:t}),i&&(r=new ResourceDescription(i,t[i])),t)l=t[a],a!==i&&"function"==typeof l&&((s=metadata.get(metadata.resource,l))?(s instanceof HtmlBehaviorResource&&(ViewResources.convention(l,s),null===s.attributeName&&null===s.elementName&&HtmlBehaviorResource.convention(a,s),null===s.attributeName&&null===s.elementName&&(s.elementName=_hyphenate(a))),!r&&s instanceof HtmlBehaviorResource&&null!==s.elementName?r=new ResourceDescription(a,l,s):c.push(new ResourceDescription(a,l,s))):viewStrategy.decorates(l)?h=l:l instanceof TemplateRegistryEntry?h=new TemplateRegistryViewStrategy(e,l):(u=ViewResources.convention(l))?(null===u.elementName||r?c.push(new ResourceDescription(a,l,u)):r=new ResourceDescription(a,l,u),metadata.define(metadata.resource,u,l)):(u=HtmlBehaviorResource.convention(a))?(null===u.elementName||r?c.push(new ResourceDescription(a,l,u)):r=new ResourceDescription(a,l,u),metadata.define(metadata.resource,u,l)):(u=ValueConverterResource.convention(a)||BindingBehaviorResource.convention(a)||ViewEngineHooksResource.convention(a))?(c.push(new ResourceDescription(a,l,u)),metadata.define(metadata.resource,u,l)):n||(n=l,o=a));return!r&&n&&(r=new ResourceDescription(o,n)),d.moduleInstance=t,d.mainResource=r,d.resources=c,d.viewStrategy=h,d},e}(),logger$1=getLogger("templating");function ensureRegistryEntry(e,t){return t instanceof TemplateRegistryEntry?Promise.resolve(t):e.loadTemplate(t)}var ProxyViewFactory=function(){function e(e){var t=this;e.then(function(e){return t.viewFactory=e})}return e.prototype.create=function(e,t,i,r){return this.viewFactory.create(e,t,i,r)},e.prototype.setCacheSize=function(e,t){this.viewFactory.setCacheSize(e,t)},e.prototype.getCachedView=function(){return this.viewFactory.getCachedView()},e.prototype.returnViewToCache=function(e){this.viewFactory.returnViewToCache(e)},_createClass$2(e,[{key:"isCaching",get:function(){return this.viewFactory.isCaching}}]),e}(),auSlotBehavior=null,ViewEngine=(_dec8$1=inject(Loader,Container,ViewCompiler,ModuleAnalyzer,ViewResources))((_temp4=_class15=function(){function e(e,t,i,r,n){this.loader=e,this.container=t,this.viewCompiler=i,this.moduleAnalyzer=r,this.appResources=n,this._pluginMap={},null===auSlotBehavior&&((auSlotBehavior=new HtmlBehaviorResource).attributeName="au-slot",metadata.define(metadata.resource,auSlotBehavior,SlotCustomAttribute)),auSlotBehavior.initialize(t,SlotCustomAttribute),auSlotBehavior.register(n)}return e.prototype.addResourcePlugin=function(e,t){var i=e.replace(".","")+"-resource-plugin";this._pluginMap[e]=i,this.loader.addPlugin(i,t)},e.prototype.loadViewFactory=function(e,t,i,r){var n=this;return i=i||new ResourceLoadContext,ensureRegistryEntry(this.loader,e).then(function(e){var o=e.address;return e.onReady?i.hasDependency(o)?null===e.template?e.onReady:Promise.resolve(new ProxyViewFactory(e.onReady)):(i.addDependency(o),e.onReady):(i.addDependency(o),e.onReady=n.loadTemplateResources(e,t,i,r).then(function(i){if(e.resources=i,null===e.template)return e.factory=null;var r=n.viewCompiler.compile(e.template,i,t);return e.factory=r}),e.onReady)})},e.prototype.loadTemplateResources=function(t,i,r,n){var o=new ViewResources(this.appResources,t.address),s=t.dependencies,a=void 0,l=void 0;if(i=i||ViewCompileInstruction.normal,0===s.length&&!i.associatedModuleId)return Promise.resolve(o);if(a=s.map(function(e){return e.src}),l=s.map(function(e){return e.name}),logger$1.debug("importing resources for "+t.address,a),n){var c=metadata.get(e.viewModelRequireMetadataKey,n);if(c){for(var u=a.length,h=0,d=c.length;h<d;++h){var p=c[h],f="function"==typeof p?Origin.get(p).moduleId:relativeToFile(p.src||p,t.address);-1===a.indexOf(f)&&(a.push(f),l.push(p.as))}logger$1.debug("importing ViewModel resources for "+i.associatedModuleId,a.slice(u))}}return this.importViewResources(a,l,o,i,r)},e.prototype.importViewModelResource=function(e,t){var i=this;return this.loader.loadModule(e).then(function(r){var n=Origin.get(r).moduleId,o=i.moduleAnalyzer.analyze(n,r,t);if(!o.mainResource)throw new Error('No view model found in module "'+e+'".');return o.initialize(i.container),o.mainResource})},e.prototype.importViewResources=function(e,t,i,r,n){var o=this;return n=n||new ResourceLoadContext,r=r||ViewCompileInstruction.normal,e=e.map(function(e){return o._applyLoaderPlugin(e)}),this.loader.loadAllModules(e).then(function(e){var s=void 0,a=void 0,l=void 0,c=void 0,u=void 0,h=void 0,d=o.container,p=o.moduleAnalyzer,f=new Array(e.length);for(s=0,a=e.length;s<a;++s)u=e[s],c=Origin.get(u).moduleId,(l=p.analyze(c,u)).initialize(d),l.register(i,t[s]),f[s]=l;for(r.associatedModuleId&&(h=p.getAnalysis(r.associatedModuleId))&&h.register(i),s=0,a=f.length;s<a;++s)f[s]=f[s].load(d,n);return Promise.all(f).then(function(){return i})})},e.prototype._applyLoaderPlugin=function(e){var t=e.lastIndexOf(".");if(-1!==t){var i=e.substring(t),r=this._pluginMap[i];return void 0===r?e:this.loader.applyPluginToUrl(e,r)}return e},e}(),_class15.viewModelRequireMetadataKey="aurelia:view-model-require",_class14$1=_temp4))||_class14$1,Controller=function(){function e(e,t,i,r){this.behavior=e,this.instruction=t,this.viewModel=i,this.isAttached=!1,this.view=null,this.isBound=!1,this.scope=null,this.container=r,this.elementEvents=r.elementEvents||null;var n,o=e.observerLocator.getOrCreateObserversLookup(i),s=e.handlesBind,a=t.attributes,l=this.boundProperties=[],c=e.properties,u=void 0;for(e._ensurePropertiesDefined(i,o),u=0,n=c.length;u<n;++u)c[u]._initialize(i,o,a,s,l)}return e.prototype.created=function(e){this.behavior.handlesCreated&&this.viewModel.created(e,this.view)},e.prototype.automate=function(e,t){this.view.bindingContext=this.viewModel,this.view.overrideContext=e||createOverrideContext(this.viewModel),this.view._isUserControlled=!0,this.behavior.handlesCreated&&this.viewModel.created(t||null,this.view),this.bind(this.view)},e.prototype.bind=function(e){var t,i=this.behavior.handlesBind,r=this.boundProperties,n=void 0,o=void 0,s=void 0,a=void 0;if(this.isBound){if(this.scope===e)return;this.unbind()}for(this.isBound=!0,this.scope=e,n=0,t=r.length;n<t;++n)a=(s=(o=r[n]).observer).selfSubscriber,s.publishing=!1,i&&(s.selfSubscriber=null),o.binding.bind(e),s.call(),s.publishing=!0,s.selfSubscriber=a;var l=void 0;null!==this.view?(i&&(this.view.viewModelScope=e),this.viewModel===e.overrideContext.bindingContext?l=e.overrideContext:this.instruction.inheritBindingContext?l=createOverrideContext(this.viewModel,e.overrideContext):(l=createOverrideContext(this.viewModel)).__parentOverrideContext=e.overrideContext,this.view.bind(this.viewModel,l)):i&&(l=e.overrideContext,void 0!==e.overrideContext.__parentOverrideContext&&this.viewModel.viewFactory&&this.viewModel.viewFactory.factoryCreateInstruction.partReplacements&&((l=Object.assign({},e.overrideContext)).parentOverrideContext=e.overrideContext.__parentOverrideContext),this.viewModel.bind(e.bindingContext,l))},e.prototype.unbind=function(){if(this.isBound){var e,t=this.boundProperties,i=void 0;for(this.isBound=!1,this.scope=null,null!==this.view&&this.view.unbind(),this.behavior.handlesUnbind&&this.viewModel.unbind(),null!==this.elementEvents&&this.elementEvents.disposeAll(),i=0,e=t.length;i<e;++i)t[i].binding.unbind()}},e.prototype.attached=function(){this.isAttached||(this.isAttached=!0,this.behavior.handlesAttached&&this.viewModel.attached(),null!==this.view&&this.view.attached())},e.prototype.detached=function(){this.isAttached&&(this.isAttached=!1,null!==this.view&&this.view.detached(),this.behavior.handlesDetached&&this.viewModel.detached())},e}(),BehaviorPropertyObserver=(_dec9$1=subscriberCollection())(_class16=function(){function e(e,t,i,r,n){this.taskQueue=e,this.obj=t,this.propertyName=i,this.notqueued=!0,this.publishing=!1,this.selfSubscriber=r,this.currentValue=this.oldValue=n}return e.prototype.getValue=function(){return this.currentValue},e.prototype.setValue=function(e){var t=this.currentValue;Object.is(e,t)||(this.oldValue=t,this.currentValue=e,this.publishing&&this.notqueued&&(this.taskQueue.flushing?this.call():(this.notqueued=!1,this.taskQueue.queueMicroTask(this))))},e.prototype.call=function(){var e=this.oldValue,t=this.currentValue;this.notqueued=!0,Object.is(t,e)||(this.selfSubscriber&&this.selfSubscriber(t,e),this.callSubscribers(t,e),this.oldValue=t)},e.prototype.subscribe=function(e,t){this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)},e}())||_class16;function getObserver(e,t){var i=e.__observers__;if(void 0===i){var r=Object.getPrototypeOf(e).constructor,n=metadata.get(metadata.resource,r);n.isInitialized||n.initialize(Container.instance||new Container,e.constructor),i=n.observerLocator.getOrCreateObserversLookup(e),n._ensurePropertiesDefined(e,i)}return i[t]}var BindableProperty=function(){function e(e){"string"==typeof e?this.name=e:Object.assign(this,e),this.attribute=this.attribute||_hyphenate(this.name);var t=this.defaultBindingMode;null==t?this.defaultBindingMode=bindingMode.oneWay:"string"==typeof t&&(this.defaultBindingMode=bindingMode[t]||bindingMode.oneWay),this.changeHandler=this.changeHandler||null,this.owner=null,this.descriptor=null}return e.prototype.registerWith=function(e,t,i){if(t.properties.push(this),t.attributes[this.attribute]=this,this.owner=t,i)return this.descriptor=i,this._configureDescriptor(i)},e.prototype._configureDescriptor=function(e){var t=this.name;return e.configurable=!0,e.enumerable=!0,"initializer"in e&&(this.defaultValue=e.initializer,delete e.initializer,delete e.writable),"value"in e&&(this.defaultValue=e.value,delete e.value,delete e.writable),e.get=function(){return getObserver(this,t).getValue()},e.set=function(e){getObserver(this,t).setValue(e)},e.get.getObserver=function(e){return getObserver(e,t)},e},e.prototype.defineOn=function(e,t){var i=this.name,r=void 0;null===this.changeHandler&&(r=i+"Changed")in e.prototype&&(this.changeHandler=r),null===this.descriptor&&Object.defineProperty(e.prototype,i,this._configureDescriptor(t,{}))},e.prototype.createObserver=function(e){var t=null,i=this.defaultValue,r=this.changeHandler,n=this.name,o=void 0;if(!this.hasOptions){if(r in e)t="propertyChanged"in e?function(t,i){e[r](t,i),e.propertyChanged(n,t,i)}:function(t,i){return e[r](t,i)};else if("propertyChanged"in e)t=function(t,i){return e.propertyChanged(n,t,i)};else if(null!==r)throw new Error("Change handler "+r+" was specified but not declared on the class.");return void 0!==i&&(o="function"==typeof i?i.call(e):i),new BehaviorPropertyObserver(this.owner.taskQueue,e,this.name,t,o)}},e.prototype._initialize=function(e,t,i,r,n){var o=void 0,s=void 0,a=void 0,l=this.defaultValue;if(this.isDynamic)for(var c in i)this._createDynamicProperty(e,t,r,c,i[c],n);else this.hasOptions||(s=t[this.name],null!==i&&(o=s.selfSubscriber,a=i[this.attribute],r&&(s.selfSubscriber=null),"string"==typeof a?(e[this.name]=a,s.call()):a?n.push({observer:s,binding:a.createBinding(e)}):void 0!==l&&s.call(),s.selfSubscriber=o),s.publishing=!0)},e.prototype._createDynamicProperty=function(e,t,i,r,n,o){var s=r+"Changed",a=null,l=void 0,c=void 0;s in e?a="propertyChanged"in e?function(t,i){e[s](t,i),e.propertyChanged(r,t,i)}:function(t,i){return e[s](t,i)}:"propertyChanged"in e&&(a=function(t,i){return e.propertyChanged(r,t,i)}),l=t[r]=new BehaviorPropertyObserver(this.owner.taskQueue,e,r,a),Object.defineProperty(e,r,{configurable:!0,enumerable:!0,get:l.getValue.bind(l),set:l.setValue.bind(l)}),i&&(l.selfSubscriber=null),"string"==typeof n?(e[r]=n,l.call()):n&&(c={observer:l,binding:n.createBinding(e)},o.push(c)),l.publishing=!0,l.selfSubscriber=a},e}(),lastProviderId=0;function nextProviderId(){return++lastProviderId}function doProcessContent(){return!0}function doProcessAttributes(){}var HtmlBehaviorResource=function(){function e(){this.elementName=null,this.attributeName=null,this.attributeDefaultBindingMode=void 0,this.liftsContent=!1,this.targetShadowDOM=!1,this.shadowDOMOptions=null,this.processAttributes=doProcessAttributes,this.processContent=doProcessContent,this.usesShadowDOM=!1,this.childBindings=null,this.hasDynamicOptions=!1,this.containerless=!1,this.properties=[],this.attributes={},this.isInitialized=!1,this.primaryProperty=null}return e.convention=function(t,i){var r=void 0;return t.endsWith("CustomAttribute")&&((r=i||new e).attributeName=_hyphenate(t.substring(0,t.length-15))),t.endsWith("CustomElement")&&((r=i||new e).elementName=_hyphenate(t.substring(0,t.length-13))),r},e.prototype.addChildBinding=function(e){null===this.childBindings&&(this.childBindings=[]),this.childBindings.push(e)},e.prototype.initialize=function(e,t){var i=t.prototype,r=this.properties,n=this.attributeName,o=this.attributeDefaultBindingMode,s=void 0,a=void 0,l=void 0;if(!this.isInitialized)if(this.isInitialized=!0,t.__providerId__=nextProviderId(),this.observerLocator=e.get(ObserverLocator),this.taskQueue=e.get(TaskQueue),this.target=t,this.usesShadowDOM=this.targetShadowDOM&&FEATURE.shadowDOM,this.handlesCreated="created"in i,this.handlesBind="bind"in i,this.handlesUnbind="unbind"in i,this.handlesAttached="attached"in i,this.handlesDetached="detached"in i,this.htmlName=this.elementName||this.attributeName,null!==n)if(0===r.length&&new BindableProperty({name:"value",changeHandler:"valueChanged"in i?"valueChanged":null,attribute:n,defaultBindingMode:o}).registerWith(t,this),l=r[0],1===r.length&&"value"===l.name)l.isDynamic=l.hasOptions=this.hasDynamicOptions,l.defineOn(t,this);else{for(s=0,a=r.length;s<a;++s)if(r[s].defineOn(t,this),r[s].primaryProperty){if(this.primaryProperty)throw new Error("Only one bindable property on a custom element can be defined as the default");this.primaryProperty=r[s]}(l=new BindableProperty({name:"value",changeHandler:"valueChanged"in i?"valueChanged":null,attribute:n,defaultBindingMode:o})).hasOptions=!0,l.registerWith(t,this)}else{for(s=0,a=r.length;s<a;++s)r[s].defineOn(t,this);this._copyInheritedProperties(e,t)}},e.prototype.register=function(e,t){var i=this;null!==this.attributeName&&(e.registerAttribute(t||this.attributeName,this,this.attributeName),Array.isArray(this.aliases)&&this.aliases.forEach(function(t){e.registerAttribute(t,i,i.attributeName)})),null!==this.elementName&&e.registerElement(t||this.elementName,this)},e.prototype.load=function(e,t,i,r,n){var o=this,s=void 0;return null!==this.elementName?(r=e.get(ViewLocator).getViewStrategy(r||this.viewStrategy||t),s=new ViewCompileInstruction(this.targetShadowDOM,!0),r.moduleId||(r.moduleId=Origin.get(t).moduleId),r.loadViewFactory(e.get(ViewEngine),s,i,t).then(function(e){return n&&o.viewFactory||(o.viewFactory=e),e})):Promise.resolve(this)},e.prototype.compile=function(e,t,i,r,n){if(this.liftsContent){if(!r.viewFactory){var o=DOM.createElement("template"),s=DOM.createDocumentFragment(),a=i.getAttribute("view-cache"),l=i.getAttribute("part");i.removeAttribute(r.originalAttrName),DOM.replaceNode(o,i,n),s.appendChild(i),r.viewFactory=e.compile(s,t),l&&(r.viewFactory.part=l,i.removeAttribute("part")),a&&(r.viewFactory.setCacheSize(a),i.removeAttribute("view-cache")),i=o}}else if(null!==this.elementName){var c={};if(this.processContent(e,t,i,r)&&i.hasChildNodes()){for(var u=i.firstChild,h=this.usesShadowDOM?null:DOM.createElement("au-content"),d=void 0,p=void 0;u;)d=u.nextSibling,"TEMPLATE"===u.tagName&&(p=u.getAttribute("replace-part"))?(c[p]=e.compile(u,t),DOM.removeNode(u,n),r.partReplacements=c):null!==h&&(3===u.nodeType&&_isAllWhitespace(u)?DOM.removeNode(u,n):h.appendChild(u)),u=d;null!==h&&h.hasChildNodes()&&i.appendChild(h),r.skipContentProcessing=!1}else r.skipContentProcessing=!0}else this.processContent(e,t,i,r)||(r.skipContentProcessing=!0);return i},e.prototype.create=function(e,t,i,r){var n=void 0,o=null;t=t||BehaviorInstruction.normal,i=i||null,r=r||null,null!==this.elementName&&i&&(this.usesShadowDOM?(n=i.attachShadow(this.shadowDOMOptions),e.registerInstance(DOM.boundary,n)):(n=i,this.targetShadowDOM&&e.registerInstance(DOM.boundary,n))),null!==i&&(i.au=o=i.au||{});var s=t.viewModel||e.get(this.target),a=new Controller(this,t,s,e),l=this.childBindings,c=void 0;if(this.liftsContent)o.controller=a;else if(null!==this.elementName){if(c=t.viewFactory||this.viewFactory,e.viewModel=s,c&&(a.view=c.create(e,t,i)),null!==i){if(o.controller=a,a.view){if(!this.usesShadowDOM&&(1===i.childNodes.length||i.contentElement)){var u=i.childNodes[0]||i.contentElement;a.view.contentView={fragment:u},u.parentNode&&DOM.removeNode(u)}if(t.anchorIsContainer){if(null!==l)for(var h=0,d=l.length;h<d;++h)a.view.addBinding(l[h].create(i,s,a));a.view.appendNodesTo(n)}else a.view.insertNodesBefore(n)}else if(null!==l)for(var p=0,f=l.length;p<f;++p)r.push(l[p].create(i,s,a))}else if(a.view){if(a.view.controller=a,null!==l)for(var v=0,g=l.length;v<g;++v)a.view.addBinding(l[v].create(t.host,s,a))}else if(null!==l)for(var m=0,b=l.length;m<b;++m)r.push(l[m].create(t.host,s,a))}else if(null!==l)for(var y=0,w=l.length;y<w;++y)r.push(l[y].create(i,s,a));return null!==o&&(o[this.htmlName]=a),t.initiatedByBehavior&&c&&a.view.created(),a},e.prototype._ensurePropertiesDefined=function(e,t){var i,r=void 0,n=void 0,o=void 0;if(!("__propertiesDefined__"in t))for(t.__propertiesDefined__=!0,n=0,i=(r=this.properties).length;n<i;++n)void 0!==(o=r[n].createObserver(e))&&(t[o.propertyName]=o)},e.prototype._copyInheritedProperties=function(e,t){for(var i=this,r=void 0,n=t;;){var o=Object.getPrototypeOf(t.prototype);if(!(t=o&&o.constructor))return;if(r=metadata.getOwn(metadata.resource,t))break}r.initialize(e,t);for(var s=function(e,t){var o=r.properties[e];if(i.properties.some(function(e){return e.name===o.name}))return"continue";new BindableProperty(o).registerWith(n,i)},a=0,l=r.properties.length;a<l;++a)s(a)},e}();function createChildObserverDecorator(e,t){return function(i,r,n){var o="string"==typeof r?i.constructor:i,s=metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,o);"string"==typeof e&&(e={selector:e,name:r}),n&&(n.writable=!0,n.configurable=!0),e.all=t,s.addChildBinding(new ChildObserver(e))}}function children(e){return createChildObserverDecorator(e,!0)}function child(e){return createChildObserverDecorator(e,!1)}var ChildObserver=function(){function e(e){this.name=e.name,this.changeHandler=e.changeHandler||this.name+"Changed",this.selector=e.selector,this.all=e.all}return e.prototype.create=function(e,t,i){return new ChildObserverBinder(this.selector,e,this.name,t,i,this.changeHandler,this.all)},e}(),noMutations=[];function trackMutation(e,t,i){var r=e.get(t);r||(r=[],e.set(t,r)),r.push(i)}function onChildChange(e,t){for(var i=t.binders,r=i.length,n=new Map,o=0,s=e.length;o<s;++o){for(var a=e[o],l=a.addedNodes,c=a.removedNodes,u=0,h=c.length;u<h;++u){var d=c[u];if(1===d.nodeType)for(var p=0;p<r;++p){var f=i[p];f.onRemove(d)&&trackMutation(n,f,a)}}for(var v=0,g=l.length;v<g;++v){var m=l[v];if(1===m.nodeType)for(var b=0;b<r;++b){var y=i[b];y.onAdd(m)&&trackMutation(n,y,a)}}}n.forEach(function(e,t){null!==t.changeHandler&&t.viewModel[t.changeHandler](e)})}var ChildObserverBinder=function(){function e(e,t,i,r,n,o,s){this.selector=e,this.viewHost=t,this.property=i,this.viewModel=r,this.controller=n,this.changeHandler=o in r?o:null,this.usesShadowDOM=n.behavior.usesShadowDOM,this.all=s,!this.usesShadowDOM&&n.view&&n.view.contentView?this.contentView=n.view.contentView:this.contentView=null}return e.prototype.matches=function(e){if(e.matches(this.selector)){if(null===this.contentView)return!0;var t=this.contentView,i=e.auAssignedSlot;if(i&&i.projectFromAnchors){for(var r=i.projectFromAnchors,n=0,o=r.length;n<o;++n)if(r[n].auOwnerView===t)return!0;return!1}return e.auOwnerView===t}return!1},e.prototype.bind=function(e){var t=this.viewHost,i=this.viewModel,r=t.__childObserver__;if(!r){r=t.__childObserver__=DOM.createMutationObserver(onChildChange);var n={childList:!0,subtree:!this.usesShadowDOM};r.observe(t,n),r.binders=[]}if(r.binders.push(this),this.usesShadowDOM){var o=t.firstElementChild;if(this.all){var s=i[this.property];for(s?s.splice(0):s=i[this.property]=[];o;)this.matches(o)&&s.push(o.au&&o.au.controller?o.au.controller.viewModel:o),o=o.nextElementSibling;null!==this.changeHandler&&this.viewModel[this.changeHandler](noMutations)}else for(;o;){if(this.matches(o)){var a=o.au&&o.au.controller?o.au.controller.viewModel:o;this.viewModel[this.property]=a,null!==this.changeHandler&&this.viewModel[this.changeHandler](a);break}o=o.nextElementSibling}}},e.prototype.onRemove=function(e){if(this.matches(e)){var t=e.au&&e.au.controller?e.au.controller.viewModel:e;if(this.all){var i=this.viewModel[this.property]||(this.viewModel[this.property]=[]),r=i.indexOf(t);return-1!==r&&i.splice(r,1),!0}return!1}return!1},e.prototype.onAdd=function(e){if(this.matches(e)){var t=e.au&&e.au.controller?e.au.controller.viewModel:e;if(this.all){var i=this.viewModel[this.property]||(this.viewModel[this.property]=[]);if("*"===this.selector)return i.push(t),!0;for(var r=0,n=e.previousElementSibling;n;)this.matches(n)&&r++,n=n.previousElementSibling;return i.splice(r,0,t),!0}this.viewModel[this.property]=t,null!==this.changeHandler&&this.viewModel[this.changeHandler](t)}return!1},e.prototype.unbind=function(){this.viewHost.__childObserver__&&(this.viewHost.__childObserver__.disconnect(),this.viewHost.__childObserver__=null,this.viewModel[this.property]=null)},e}();function remove(e,t){return Array.isArray(t)?e.removeMany(t,!0):e.remove(t,!0)}var SwapStrategies={before:function(e,t,i){return void 0===t?i():i().then(function(){return remove(e,t)})},with:function(e,t,i){return void 0===t?i():Promise.all([remove(e,t),i()])},after:function(e,t,i){return Promise.resolve(e.removeAll(!0)).then(i)}};function tryActivateViewModel(e){return e.skipActivation||"function"!=typeof e.viewModel.activate?Promise.resolve():e.viewModel.activate(e.model)||Promise.resolve()}var CompositionEngine=(_dec10$1=inject(ViewEngine,ViewLocator))(_class17=function(){function e(e,t){this.viewEngine=e,this.viewLocator=t}return e.prototype._swap=function(e,t){var i=SwapStrategies[e.swapOrder]||SwapStrategies.after,r=e.viewSlot.children.slice();return i(e.viewSlot,r,function(){return Promise.resolve(e.viewSlot.add(t)).then(function(){e.currentController&&e.currentController.unbind()})}).then(function(){e.compositionTransactionNotifier&&e.compositionTransactionNotifier.done()})},e.prototype._createControllerAndSwap=function(e){var t=this;return this.createController(e).then(function(i){return e.compositionTransactionOwnershipToken?e.compositionTransactionOwnershipToken.waitForCompositionComplete().then(function(){return i.automate(e.overrideContext,e.owningView),t._swap(e,i.view)}).then(function(){return i}):(i.automate(e.overrideContext,e.owningView),t._swap(e,i.view).then(function(){return i}))})},e.prototype.createController=function(e){var t=this,i=void 0,r=void 0,n=void 0,o=void 0;return this.ensureViewModel(e).then(tryActivateViewModel).then(function(){i=e.childContainer,r=e.viewModel,n=e.viewModelResource,o=n.metadata;var s=t.viewLocator.getViewStrategy(e.view||r);return e.viewResources&&s.makeRelativeTo(e.viewResources.viewUrl),o.load(i,n.value,null,s,!0)}).then(function(t){return o.create(i,BehaviorInstruction.dynamic(e.host,r,t))})},e.prototype.ensureViewModel=function(e){var t=e.childContainer=e.childContainer||e.container.createChild();if("string"==typeof e.viewModel)return e.viewModel=e.viewResources?e.viewResources.relativeToView(e.viewModel):e.viewModel,this.viewEngine.importViewModelResource(e.viewModel).then(function(i){return t.autoRegister(i.value),e.host&&t.registerInstance(DOM.Element,e.host),e.viewModel=t.viewModel=t.get(i.value),e.viewModelResource=i,e});var i=e.viewModel.constructor,r="function"==typeof e.viewModel;r&&(i=e.viewModel,t.autoRegister(i));var n=metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,i);return n.elementName=n.elementName||"dynamic-element",n.initialize(r?t:e.container||t,i),e.viewModelResource={metadata:n,value:i},e.host&&t.registerInstance(DOM.Element,e.host),t.viewModel=e.viewModel=r?t.get(i):e.viewModel,Promise.resolve(e)},e.prototype.compose=function(e){var t=this;e.childContainer=e.childContainer||e.container.createChild(),e.view=this.viewLocator.getViewStrategy(e.view);var i=e.childContainer.get(CompositionTransaction),r=i.tryCapture();return r?e.compositionTransactionOwnershipToken=r:e.compositionTransactionNotifier=i.enlist(),e.viewModel?this._createControllerAndSwap(e):e.view?(e.viewResources&&e.view.makeRelativeTo(e.viewResources.viewUrl),e.view.loadViewFactory(this.viewEngine,new ViewCompileInstruction).then(function(i){var r=i.create(e.childContainer);return r.bind(e.bindingContext,e.overrideContext),e.compositionTransactionOwnershipToken?e.compositionTransactionOwnershipToken.waitForCompositionComplete().then(function(){return t._swap(e,r)}).then(function(){return r}):t._swap(e,r).then(function(){return r})})):e.viewSlot?(e.viewSlot.removeAll(),e.compositionTransactionNotifier&&e.compositionTransactionNotifier.done(),Promise.resolve(null)):Promise.resolve(null)},e}())||_class17,ElementConfigResource=function(){function e(){}return e.prototype.initialize=function(e,t){},e.prototype.register=function(e,t){},e.prototype.load=function(e,t){var i=new t;e.get(EventManager).registerElementConfig(i)},e}();function resource(e){return function(t){"string"==typeof e||Object.getPrototypeOf(e)===Object.prototype?t.$resource=e:metadata.define(metadata.resource,e,t)}}function behavior(e){return function(t){if(e instanceof HtmlBehaviorResource)metadata.define(metadata.resource,e,t);else{var i=metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,t);Object.assign(i,e)}}}function customElement(e){return function(t){metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,t).elementName=validateBehaviorName(e,"custom element")}}function customAttribute(e,t,i){return function(r){var n=metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,r);n.attributeName=validateBehaviorName(e,"custom attribute"),n.attributeDefaultBindingMode=t,n.aliases=i}}function templateController(e){var t=function(e){metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,e).liftsContent=!0};return e?t(e):t}function bindable(e,t,i){var r=function(t,i,r){var n=i?t.constructor:t,o=metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,n);return i&&((e=e||{}).name=i),new BindableProperty(e).registerWith(n,o,r)};if(!e)return r;if(t){var n=e;return e=null,r(n,t,i)}return r}function dynamicOptions(e){var t=function(e){metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,e).hasDynamicOptions=!0};return e?t(e):t}var defaultShadowDOMOptions={mode:"open"};function useShadowDOM(e){var t="function"!=typeof e&&e?e:defaultShadowDOMOptions,i=function(e){var i=metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,e);i.targetShadowDOM=!0,i.shadowDOMOptions=t};return"function"==typeof e?i(e):i}function processAttributes(e){return function(t){metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,t).processAttributes=function(t,i,r,n,o){try{e(t,i,r,n,o)}catch(e){getLogger("templating").error(e)}}}}function doNotProcessContent(){return!1}function processContent(e){return function(t){metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,t).processContent=e?function(t,i,r,n){try{return e(t,i,r,n)}catch(e){return getLogger("templating").error(e),!1}}:doNotProcessContent}}function containerless(e){var t=function(e){metadata.getOrCreateOwn(metadata.resource,HtmlBehaviorResource,e).containerless=!0};return e?t(e):t}function useViewStrategy(e){return function(t){metadata.define(ViewLocator.viewStrategyMetadataKey,e,t)}}function useView(e){return useViewStrategy(new RelativeViewStrategy(e))}function inlineView(e,t,i){return useViewStrategy(new InlineViewStrategy(e,t,i))}function noView(e,t){var i=void 0,r=void 0;"function"==typeof e?i=e:(r=e,i=void 0);var n=function(e){metadata.define(ViewLocator.viewStrategyMetadataKey,new NoViewStrategy(r,t),e)};return i?n(i):n}function view(e){return function(t){t.$view=e}}function elementConfig(e){var t=function(e){metadata.define(metadata.resource,new ElementConfigResource,e)};return e?t(e):t}function viewResources(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){metadata.define(ViewEngine.viewModelRequireMetadataKey,t,e)}}var TemplatingEngine=(_dec11=inject(Container,ModuleAnalyzer,ViewCompiler,CompositionEngine))(_class18=function(){function e(e,t,i,r){this._container=e,this._moduleAnalyzer=t,this._viewCompiler=i,this._compositionEngine=r,e.registerInstance(Animator,Animator.instance=new Animator)}return e.prototype.configureAnimator=function(e){this._container.unregister(Animator),this._container.registerInstance(Animator,Animator.instance=e)},e.prototype.compose=function(e){return this._compositionEngine.compose(e)},e.prototype.enhance=function(e){e instanceof DOM.Element&&(e={element:e});var t={letExpressions:[]},i=e.resources||this._container.get(ViewResources);this._viewCompiler._compileNode(e.element,i,t,e.element.parentNode,"root",!0);var r=new ViewFactory(e.element,t,i),n=e.container||this._container.createChild(),o=r.create(n,BehaviorInstruction.enhance());return o.bind(e.bindingContext||{},e.overrideContext),o.firstChild=o.lastChild=o.fragment,o.fragment=DOM.createDocumentFragment(),o.attached(),o},e}())||_class18;function preventActionlessFormSubmit(){DOM.addEventListener("submit",e=>{const t=e.target,i=t.action;"form"!==t.tagName.toLowerCase()||i||e.preventDefault()})}let Aurelia=class e{constructor(t,i,r){this.loader=t||new PLATFORM.Loader,this.container=i||(new Container).makeGlobal(),this.resources=r||new ViewResources,this.use=new FrameworkConfiguration(this),this.logger=getLogger("aurelia"),this.hostConfigured=!1,this.host=null,this.use.instance(e,this),this.use.instance(Loader,this.loader),this.use.instance(ViewResources,this.resources)}start(){return this._started?this._started:(this.logger.info("Aurelia Starting"),this._started=this.use.apply().then(()=>{if(preventActionlessFormSubmit(),!this.container.hasResolver(BindingLanguage)){let e="You must configure Aurelia with a BindingLanguage implementation.";throw this.logger.error(e),new Error(e)}this.logger.info("Aurelia Started");let e=DOM.createCustomEvent("aurelia-started",{bubbles:!0,cancelable:!0});return DOM.dispatchEvent(e),this}))}enhance(e={},t=null){return this._configureHost(t||DOM.querySelectorAll("body")[0]),new Promise(t=>{let i=this.container.get(TemplatingEngine);this.root=i.enhance({container:this.container,element:this.host,resources:this.resources,bindingContext:e}),this.root.attached(),this._onAureliaComposed(),t(this)})}setRoot(e=null,t=null){let i={};this.root&&this.root.viewModel&&this.root.viewModel.router&&(this.root.viewModel.router.deactivate(),this.root.viewModel.router.reset()),this._configureHost(t);let r=this.container.get(TemplatingEngine);return delete this.container.get(CompositionTransaction).initialComposition,e||(e=this.configModuleId?relativeToFile("./app",this.configModuleId):"app"),i.viewModel=e,i.container=i.childContainer=this.container,i.viewSlot=this.hostSlot,i.host=this.host,r.compose(i).then(e=>(this.root=e,i.viewSlot.attached(),this._onAureliaComposed(),this))}_configureHost(e){if(!this.hostConfigured){if(e=e||this.host,this.host=e&&"string"!=typeof e?e:DOM.getElementById(e||"applicationHost"),!this.host)throw new Error("No applicationHost was specified.");this.hostConfigured=!0,this.host.aurelia=this,this.hostSlot=new ViewSlot(this.host,!0),this.hostSlot.transformChildNodesIntoView(),this.container.registerInstance(DOM.boundary,this.host)}}_onAureliaComposed(){let e=DOM.createCustomEvent("aurelia-composed",{bubbles:!0,cancelable:!0});setTimeout(()=>DOM.dispatchEvent(e),1)}};const logger$2=getLogger("aurelia"),extPattern=/\.[^\/.]+$/;function runTasks(e,t){let i,r=()=>(i=t.shift())?Promise.resolve(i(e)).then(r):Promise.resolve();return r()}function loadPlugin(e,t,i){if(logger$2.debug(`Loading plugin ${i.moduleId}.`),"string"==typeof i.moduleId){e.resourcesRelativeTo=i.resourcesRelativeTo;let n=i.moduleId;return i.resourcesRelativeTo.length>1?t.normalize(i.moduleId,i.resourcesRelativeTo[1]).then(e=>r(e)):r(n)}if("function"==typeof i.configure)return-1!==e.configuredPlugins.indexOf(i.configure)?Promise.resolve():(e.configuredPlugins.push(i.configure),Promise.resolve(i.configure.call(null,e,i.config||{})));throw new Error(invalidConfigMsg(i.moduleId||i.configure,"plugin"));function r(r){return t.loadModule(r).then(t=>{if("configure"in t)return-1!==e.configuredPlugins.indexOf(t.configure)?Promise.resolve():Promise.resolve(t.configure(e,i.config||{})).then(()=>{e.configuredPlugins.push(t.configure),e.resourcesRelativeTo=null,logger$2.debug(`Configured plugin ${i.moduleId}.`)});e.resourcesRelativeTo=null,logger$2.debug(`Loaded plugin ${i.moduleId}.`)})}}function loadResources(e,t,i){if(0===Object.keys(t).length)return Promise.resolve();let r=e.container.get(ViewEngine);return Promise.all(Object.keys(t).map(i=>(function(t){let i=t.moduleId,r=getExt(i);n(i)&&(i=o(i));return e.loader.normalize(i,t.relativeTo).then(e=>({name:t.moduleId,importId:n(t.moduleId)?s(e,r):e}))})(t[i]))).then(e=>{let t=[],n=[];return e.forEach(e=>{t.push(void 0),n.push(e.importId)}),r.importViewResources(n,t,i)});function n(e){let t=getExt(e);return!!t&&(""!==t&&(".js"!==t&&".ts"!==t))}function o(e){return e.replace(extPattern,"")}function s(e,t){return o(e)+"."+t}}function getExt(e){let t=e.match(extPattern);if(t&&t.length>0)return t[0].split(".")[1]}function loadBehaviors(e){return Promise.all(e.behaviorsToLoad.map(t=>t.load(e.container,t.target))).then(()=>{e.behaviorsToLoad=null})}function assertProcessed(e){if(e.processed)throw new Error("This config instance has already been applied. To load more plugins or global resources, create a new FrameworkConfiguration instance.")}function invalidConfigMsg(e,t){return`Invalid ${t} [${e}], ${t} must be specified as functions or relative module IDs.`}let FrameworkConfiguration=class{constructor(e){this.aurelia=e,this.container=e.container,this.info=[],this.processed=!1,this.preTasks=[],this.postTasks=[],this.behaviorsToLoad=[],this.configuredPlugins=[],this.resourcesToLoad={},this.preTask(()=>e.loader.normalize("aurelia-bootstrapper").then(e=>this.bootstrapperName=e)),this.postTask(()=>loadResources(e,this.resourcesToLoad,e.resources))}instance(e,t){return this.container.registerInstance(e,t),this}singleton(e,t){return this.container.registerSingleton(e,t),this}transient(e,t){return this.container.registerTransient(e,t),this}preTask(e){return assertProcessed(this),this.preTasks.push(e),this}postTask(e){return assertProcessed(this),this.postTasks.push(e),this}feature(e,t={}){switch(typeof e){case"string":let i=/\/index$/i.test(e),r=i||getExt(e)?e:e+"/index",n=i?e.substr(0,e.length-6):e;this.info.push({moduleId:r,resourcesRelativeTo:[n,""],config:t});break;case"function":this.info.push({configure:e,config:t||{}});break;default:throw new Error(invalidConfigMsg(e,"feature"))}return this}globalResources(e){assertProcessed(this);let t,i=Array.isArray(e)?e:arguments,r=this.resourcesRelativeTo||["",""];for(let e=0,n=i.length;e<n;++e)switch(typeof(t=i[e])){case"string":let n=r[0],o=r[1],s=t;(t.startsWith("./")||t.startsWith("../"))&&""!==n&&(s=join(n,t)),this.resourcesToLoad[s]={moduleId:s,relativeTo:o};break;case"function":let a=this.aurelia.resources.autoRegister(this.container,t);a instanceof HtmlBehaviorResource&&null!==a.elementName&&1===this.behaviorsToLoad.push(a)&&this.postTask(()=>loadBehaviors(this));break;default:throw new Error(invalidConfigMsg(t,"resource"))}return this}globalName(e,t){return assertProcessed(this),this.resourcesToLoad[e]={moduleId:t,relativeTo:""},this}plugin(e,t){let i;switch(assertProcessed(this),typeof e){case"string":i={moduleId:e,resourcesRelativeTo:[e,""],config:t||{}};break;case"function":i={configure:e,config:t||{}};break;default:throw new Error(invalidConfigMsg(e,"plugin"))}return this.info.push(i),this}_addNormalizedPlugin(e,t){let i={moduleId:e,resourcesRelativeTo:[e,""],config:t||{}};return this.info.push(i),this.preTask(()=>{let t=[e,this.bootstrapperName];return i.moduleId=e,i.resourcesRelativeTo=t,Promise.resolve()}),this}defaultBindingLanguage(){return this._addNormalizedPlugin("aurelia-templating-binding")}router(){return this._addNormalizedPlugin("aurelia-templating-router")}history(){return this._addNormalizedPlugin("aurelia-history-browser")}defaultResources(){return this._addNormalizedPlugin("aurelia-templating-resources")}eventAggregator(){return this._addNormalizedPlugin("aurelia-event-aggregator")}basicConfiguration(){return this.defaultBindingLanguage().defaultResources().eventAggregator()}standardConfiguration(){return this.basicConfiguration().history().router()}developmentLogging(e){let t=e?logLevel[e]:void 0;return void 0===t&&(t=logLevel.debug),this.preTask(()=>this.aurelia.loader.normalize("aurelia-logging-console",this.bootstrapperName).then(e=>this.aurelia.loader.loadModule(e).then(e=>{addAppender(new e.ConsoleAppender),setLevel(t)}))),this}apply(){return this.processed?Promise.resolve():runTasks(this,this.preTasks).then(()=>{let e,t=this.aurelia.loader,i=this.info,r=()=>(e=i.shift())?loadPlugin(this,t,e).then(r):(this.processed=!0,this.configuredPlugins=null,Promise.resolve());return r().then(()=>runTasks(this,this.postTasks))})}};const LogManager=TheLogManager;var _class$3,_temp$2,_dec$3,_class2$3,_dec2$3,_class3$3,_class4$2,_temp2$2,_class5$3,_temp3$1;function _possibleConstructorReturn$1(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var AttributeMap=(_temp$2=_class$3=function(){function e(e){this.elements=Object.create(null),this.allElements=Object.create(null),this.svg=e,this.registerUniversal("accesskey","accessKey"),this.registerUniversal("contenteditable","contentEditable"),this.registerUniversal("tabindex","tabIndex"),this.registerUniversal("textcontent","textContent"),this.registerUniversal("innerhtml","innerHTML"),this.registerUniversal("scrolltop","scrollTop"),this.registerUniversal("scrollleft","scrollLeft"),this.registerUniversal("readonly","readOnly"),this.register("label","for","htmlFor"),this.register("img","usemap","useMap"),this.register("input","maxlength","maxLength"),this.register("input","minlength","minLength"),this.register("input","formaction","formAction"),this.register("input","formenctype","formEncType"),this.register("input","formmethod","formMethod"),this.register("input","formnovalidate","formNoValidate"),this.register("input","formtarget","formTarget"),this.register("textarea","maxlength","maxLength"),this.register("td","rowspan","rowSpan"),this.register("td","colspan","colSpan"),this.register("th","rowspan","rowSpan"),this.register("th","colspan","colSpan")}return e.prototype.register=function(e,t,i){e=e.toLowerCase(),t=t.toLowerCase(),(this.elements[e]=this.elements[e]||Object.create(null))[t]=i},e.prototype.registerUniversal=function(e,t){e=e.toLowerCase(),this.allElements[e]=t},e.prototype.map=function(e,t){if(this.svg.isStandardSvgAttribute(e,t))return t;e=e.toLowerCase(),t=t.toLowerCase();var i=this.elements[e];return void 0!==i&&t in i?i[t]:t in this.allElements?this.allElements[t]:/(?:^data-)|(?:^aria-)|:/.test(t)?t:camelCase(t)},e}(),_class$3.inject=[SVGAnalyzer],_temp$2),InterpolationBindingExpression=function(){function e(e,t,i,r,n,o){this.observerLocator=e,this.targetProperty=t,this.parts=i,this.mode=r,this.lookupFunctions=n,this.attribute=this.attrToRemove=o,this.discrete=!1}return e.prototype.createBinding=function(e){return 3===this.parts.length?new ChildInterpolationBinding(e,this.observerLocator,this.parts[1],this.mode,this.lookupFunctions,this.targetProperty,this.parts[0],this.parts[2]):new InterpolationBinding(this.observerLocator,this.parts,e,this.targetProperty,this.mode,this.lookupFunctions)},e}();function validateTarget(e,t){if("style"===t)getLogger("templating-binding").info('Internet Explorer does not support interpolation in "style" attributes.  Use the style attribute\'s alias, "css" instead.');else if(e.parentElement&&"TEXTAREA"===e.parentElement.nodeName&&"textContent"===t)throw new Error('Interpolation binding cannot be used in the content of a textarea element.  Use <textarea value.bind="expression"></textarea> instead.')}var InterpolationBinding=function(){function e(e,t,i,r,n,o){validateTarget(i,r),this.observerLocator=e,this.parts=t,this.target=i,this.targetProperty=r,this.targetAccessor=e.getAccessor(i,r),this.mode=n,this.lookupFunctions=o}return e.prototype.interpolate=function(){if(this.isBound){for(var e="",t=this.parts,i=0,r=t.length;i<r;i++)e+=i%2==0?t[i]:this["childBinding"+i].value;this.targetAccessor.setValue(e,this.target,this.targetProperty)}},e.prototype.updateOneTimeBindings=function(){for(var e=1,t=this.parts.length;e<t;e+=2){var i=this["childBinding"+e];i.mode===bindingMode.oneTime&&i.call()}},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.source=e;for(var t=this.parts,i=1,r=t.length;i<r;i+=2){var n=new ChildInterpolationBinding(this,this.observerLocator,t[i],this.mode,this.lookupFunctions);n.bind(e),this["childBinding"+i]=n}this.isBound=!0,this.interpolate()},e.prototype.unbind=function(){if(this.isBound){this.isBound=!1,this.source=null;for(var e=1,t=this.parts.length;e<t;e+=2){this["childBinding"+e].unbind()}}},e}(),ChildInterpolationBinding=(_dec$3=connectable())(_class2$3=function(){function e(e,t,i,r,n,o,s,a){e instanceof InterpolationBinding?this.parent=e:(validateTarget(e,o),this.target=e,this.targetProperty=o,this.targetAccessor=t.getAccessor(e,o)),this.observerLocator=t,this.sourceExpression=i,this.mode=r,this.lookupFunctions=n,this.left=s,this.right=a}return e.prototype.updateTarget=function(e){(e=null==e?"":e.toString())!==this.value&&(this.value=e,this.parent?this.parent.interpolate():this.targetAccessor.setValue(this.left+e+this.right,this.target,this.targetProperty))},e.prototype.call=function(){this.isBound&&(this.rawValue=this.sourceExpression.evaluate(this.source,this.lookupFunctions),this.updateTarget(this.rawValue),this.mode!==bindingMode.oneTime&&(this._version++,this.sourceExpression.connect(this,this.source),this.rawValue instanceof Array&&this.observeArray(this.rawValue),this.unobserve(!1)))},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e;var t=this.sourceExpression;t.bind&&t.bind(this,e,this.lookupFunctions),this.rawValue=t.evaluate(e,this.lookupFunctions),this.updateTarget(this.rawValue),this.mode===bindingMode.oneWay&&enqueueBindingConnect(this)},e.prototype.unbind=function(){if(this.isBound){this.isBound=!1;var e=this.sourceExpression;e.unbind&&e.unbind(this,this.source),this.source=null,this.value=null,this.rawValue=null,this.unobserve(!0)}},e.prototype.connect=function(e){this.isBound&&(e&&(this.rawValue=this.sourceExpression.evaluate(this.source,this.lookupFunctions),this.updateTarget(this.rawValue)),this.sourceExpression.connect(this,this.source),this.rawValue instanceof Array&&this.observeArray(this.rawValue))},e}())||_class2$3,LetExpression=function(){function e(e,t,i,r,n){this.observerLocator=e,this.sourceExpression=i,this.targetProperty=t,this.lookupFunctions=r,this.toBindingContext=n}return e.prototype.createBinding=function(){return new LetBinding(this.observerLocator,this.sourceExpression,this.targetProperty,this.lookupFunctions,this.toBindingContext)},e}(),LetBinding=(_dec2$3=connectable())(_class3$3=function(){function e(e,t,i,r,n){this.observerLocator=e,this.sourceExpression=t,this.targetProperty=i,this.lookupFunctions=r,this.source=null,this.target=null,this.toBindingContext=n}return e.prototype.updateTarget=function(){var e=this.sourceExpression.evaluate(this.source,this.lookupFunctions);this.target[this.targetProperty]=e},e.prototype.call=function(e){if(this.isBound){if(e!==sourceContext)throw new Error("Unexpected call context "+e);this.updateTarget()}},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.target=this.toBindingContext?e.bindingContext:e.overrideContext,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions),enqueueBindingConnect(this)},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null,this.target=null,this.unobserve(!0))},e.prototype.connect=function(){this.isBound&&(this.updateTarget(),this.sourceExpression.connect(this,this.source))},e}())||_class3$3,LetInterpolationBindingExpression=function(){function e(e,t,i,r,n){this.observerLocator=e,this.targetProperty=t,this.parts=i,this.lookupFunctions=r,this.toBindingContext=n}return e.prototype.createBinding=function(){return new LetInterpolationBinding(this.observerLocator,this.targetProperty,this.parts,this.lookupFunctions,this.toBindingContext)},e}(),LetInterpolationBinding=function(){function e(e,t,i,r,n){this.observerLocator=e,this.parts=i,this.targetProperty=t,this.lookupFunctions=r,this.toBindingContext=n,this.target=null}return e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.target=this.toBindingContext?e.bindingContext:e.overrideContext,this.interpolationBinding=this.createInterpolationBinding(),this.interpolationBinding.bind(e)},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.source=null,this.target=null,this.interpolationBinding.unbind(),this.interpolationBinding=null)},e.prototype.createInterpolationBinding=function(){return 3===this.parts.length?new ChildInterpolationBinding(this.target,this.observerLocator,this.parts[1],bindingMode.oneWay,this.lookupFunctions,this.targetProperty,this.parts[0],this.parts[2]):new InterpolationBinding(this.observerLocator,this.parts,this.target,this.targetProperty,bindingMode.oneWay,this.lookupFunctions)},e}(),SyntaxInterpreter=(_temp2$2=_class4$2=function(){function e(e,t,i,r){this.parser=e,this.observerLocator=t,this.eventManager=i,this.attributeMap=r}return e.prototype.interpret=function(e,t,i,r,n){return i.command in this?this[i.command](e,t,i,r,n):this.handleUnknownCommand(e,t,i,r,n)},e.prototype.handleUnknownCommand=function(e,t,i,r,n){return getLogger("templating-binding").warn("Unknown binding command.",i),r},e.prototype.determineDefaultBindingMode=function(e,t,i){var r=e.tagName.toLowerCase();return"input"===r&&("value"===t||"files"===t)&&"checkbox"!==e.type&&"radio"!==e.type||"input"===r&&"checked"===t&&("checkbox"===e.type||"radio"===e.type)||("textarea"===r||"select"===r)&&"value"===t||("textcontent"===t||"innerhtml"===t)&&"true"===e.contentEditable||"scrolltop"===t||"scrollleft"===t?bindingMode.twoWay:i&&t in i.attributes&&i.attributes[t]&&i.attributes[t].defaultBindingMode>=bindingMode.oneTime?i.attributes[t].defaultBindingMode:bindingMode.oneWay},e.prototype.bind=function(e,t,i,r,n){var o=r||BehaviorInstruction.attribute(i.attrName);return o.attributes[i.attrName]=new BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,i.attrName),this.parser.parse(i.attrValue),void 0===i.defaultBindingMode||null===i.defaultBindingMode?this.determineDefaultBindingMode(t,i.attrName,n):i.defaultBindingMode,e.lookupFunctions),o},e.prototype.trigger=function(e,t,i){return new ListenerExpression(this.eventManager,i.attrName,this.parser.parse(i.attrValue),delegationStrategy.none,!0,e.lookupFunctions)},e.prototype.capture=function(e,t,i){return new ListenerExpression(this.eventManager,i.attrName,this.parser.parse(i.attrValue),delegationStrategy.capturing,!0,e.lookupFunctions)},e.prototype.delegate=function(e,t,i){return new ListenerExpression(this.eventManager,i.attrName,this.parser.parse(i.attrValue),delegationStrategy.bubbling,!0,e.lookupFunctions)},e.prototype.call=function(e,t,i,r){var n=r||BehaviorInstruction.attribute(i.attrName);return n.attributes[i.attrName]=new CallExpression(this.observerLocator,i.attrName,this.parser.parse(i.attrValue),e.lookupFunctions),n},e.prototype.options=function(e,t,i,r,n){var o,s=r||BehaviorInstruction.attribute(i.attrName),a=i.attrValue,l=this.language,c=null,u="",h=void 0,d=void 0,p=!1,f=!1,v=!1;for(d=0,o=a.length;d<o;++d){if(";"!==(h=a[d])||p)if(":"===h&&null===c)v=!0,c=u.trim(),u="";else{if("\\"===h){u+=h,f=!0;continue}u+=h,null!==c&&!1===f&&"'"===h&&(p=!p)}else v||(c=this._getPrimaryPropertyName(e,n)),i=l.inspectAttribute(e,"?",c,u.trim()),l.createAttributeInstruction(e,t,i,s,n),s.attributes[i.attrName]||(s.attributes[i.attrName]=i.attrValue),u="",c=null;f=!1}return v||(c=this._getPrimaryPropertyName(e,n)),null!==c&&(i=l.inspectAttribute(e,"?",c,u.trim()),l.createAttributeInstruction(e,t,i,s,n),s.attributes[i.attrName]||(s.attributes[i.attrName]=i.attrValue)),s},e.prototype._getPrimaryPropertyName=function(e,t){var i=e.getAttribute(t.attributeName);return i&&i.primaryProperty?i.primaryProperty.attribute:null},e.prototype.for=function(e,t,i,r){var n,o=void 0,s=void 0,a=void 0,l=void 0;if(2!==(o=(n=(l=i.attrValue).match(/^ *[[].+[\]]/))?l.split("of "):l.split(" of ")).length)throw new Error('Incorrect syntax for "for". The form is: "$local of $items" or "[$key, $value] of $items".');return a=r||BehaviorInstruction.attribute(i.attrName),n?(s=o[0].replace(/[[\]]/g,"").replace(/,/g," ").replace(/\s+/g," ").trim().split(" "),a.attributes.key=s[0],a.attributes.value=s[1]):a.attributes.local=o[0],a.attributes.items=new BindingExpression(this.observerLocator,"items",this.parser.parse(o[1]),bindingMode.oneWay,e.lookupFunctions),a},e.prototype["two-way"]=function(e,t,i,r){var n=r||BehaviorInstruction.attribute(i.attrName);return n.attributes[i.attrName]=new BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,i.attrName),this.parser.parse(i.attrValue),bindingMode.twoWay,e.lookupFunctions),n},e.prototype["to-view"]=function(e,t,i,r){var n=r||BehaviorInstruction.attribute(i.attrName);return n.attributes[i.attrName]=new BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,i.attrName),this.parser.parse(i.attrValue),bindingMode.toView,e.lookupFunctions),n},e.prototype["from-view"]=function(e,t,i,r){var n=r||BehaviorInstruction.attribute(i.attrName);return n.attributes[i.attrName]=new BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,i.attrName),this.parser.parse(i.attrValue),bindingMode.fromView,e.lookupFunctions),n},e.prototype["one-time"]=function(e,t,i,r){var n=r||BehaviorInstruction.attribute(i.attrName);return n.attributes[i.attrName]=new BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,i.attrName),this.parser.parse(i.attrValue),bindingMode.oneTime,e.lookupFunctions),n},e}(),_class4$2.inject=[Parser,ObserverLocator,EventManager,AttributeMap],_temp2$2);SyntaxInterpreter.prototype["one-way"]=SyntaxInterpreter.prototype["to-view"];var _dec$4,_class$4,_class2$4,_descriptor,_descriptor2,_descriptor3,_descriptor4,info={},TemplatingBindingLanguage=(_temp3$1=_class5$3=function(e){function t(t,i,r,n){var o=_possibleConstructorReturn$1(this,e.call(this));return o.parser=t,o.observerLocator=i,o.syntaxInterpreter=r,o.emptyStringExpression=o.parser.parse("''"),r.language=o,o.attributeMap=n,o.toBindingContextAttr="to-binding-context",o}return _inherits$1(t,e),t.prototype.inspectAttribute=function(e,t,i,r){var n=i.split(".");if(info.defaultBindingMode=null,2===n.length)info.attrName=n[0].trim(),info.attrValue=r,info.command=n[1].trim(),"ref"===info.command?(info.expression=new NameExpression(this.parser.parse(r),info.attrName,e.lookupFunctions),info.command=null,info.attrName="ref"):info.expression=null;else if("ref"===i)info.attrName=i,info.attrValue=r,info.command=null,info.expression=new NameExpression(this.parser.parse(r),"element",e.lookupFunctions);else{info.attrName=i,info.attrValue=r,info.command=null;var o=this.parseInterpolation(e,r);info.expression=null===o?null:new InterpolationBindingExpression(this.observerLocator,this.attributeMap.map(t,i),o,bindingMode.oneWay,e.lookupFunctions,i)}return info},t.prototype.createAttributeInstruction=function(e,t,i,r,n){var o=void 0;if(i.expression){if("ref"===i.attrName)return i.expression;(o=r||BehaviorInstruction.attribute(i.attrName)).attributes[i.attrName]=i.expression}else i.command&&(o=this.syntaxInterpreter.interpret(e,t,i,r,n));return o},t.prototype.createLetExpressions=function(e,t){for(var i=[],r=t.attributes,n=void 0,o=void 0,s=void 0,a=void 0,l=this.toBindingContextAttr,c=t.hasAttribute(l),u=0,h=r.length;h>u;++u)if(s=(n=r[u]).name,a=n.nodeValue,o=s.split("."),s!==l)if(2===o.length){if("bind"!==o[1]){getLogger("templating-binding-language").warn('Detected invalid let command. Expected "'+o[0]+'.bind", given "'+s+'"');continue}i.push(new LetExpression(this.observerLocator,camelCase(o[0]),this.parser.parse(a),e.lookupFunctions,c))}else s=camelCase(s),null===(o=this.parseInterpolation(e,a))&&getLogger("templating-binding-language").warn('Detected string literal in let bindings. Did you mean "'+s+".bind="+a+'" or "'+s+"=${"+a+'}" ?'),o?i.push(new LetInterpolationBindingExpression(this.observerLocator,s,o,e.lookupFunctions,c)):i.push(new LetExpression(this.observerLocator,s,new LiteralString(a),e.lookupFunctions,c));return i},t.prototype.inspectTextContent=function(e,t){var i=this.parseInterpolation(e,t);return null===i?null:new InterpolationBindingExpression(this.observerLocator,"textContent",i,bindingMode.oneWay,e.lookupFunctions,"textContent")},t.prototype.parseInterpolation=function(e,t){for(var i=t.indexOf("${",0),r=t.length,n=void 0,o=0,s=0,a=null,l=void 0,c=void 0,u=0;i>=0&&i<r-2;){s=1,l=i,i+=2;do{n=t[i],i++,"'"!==n&&'"'!==n?"\\"!==n?null===a&&("{"===n?s++:"}"===n&&s--):i++:null===a?a=n:a===n&&(a=null)}while(s>0&&i<r);if(0!==s)break;c=c||[],"\\"===t[l-1]&&"\\"!==t[l-2]?(c[u]=t.substring(o,l-1)+t.substring(l,i),c[++u]=this.emptyStringExpression,u++):(c[u]=t.substring(o,l),c[++u]=this.parser.parse(t.substring(l+2,i-1)),u++),o=i,i=t.indexOf("${",i)}return 0===u?null:(c[u]=t.substr(o),c)},t}(BindingLanguage),_class5$3.inject=[Parser,ObserverLocator,SyntaxInterpreter,AttributeMap],_temp3$1);function configure(e){e.container.registerSingleton(BindingLanguage,TemplatingBindingLanguage),e.container.registerAlias(BindingLanguage,TemplatingBindingLanguage)}function _initDefineProp(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function _applyDecoratedDescriptor(e,t,i,r,n){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}let Compose=(_dec$4=customElement("compose"))(_class$4=noView((_descriptor=_applyDecoratedDescriptor((_class2$4=class{static inject(){return[DOM.Element,Container,CompositionEngine,ViewSlot,ViewResources,TaskQueue]}constructor(e,t,i,r,n,o){_initDefineProp(this,"model",_descriptor,this),_initDefineProp(this,"view",_descriptor2,this),_initDefineProp(this,"viewModel",_descriptor3,this),_initDefineProp(this,"swapOrder",_descriptor4,this),this.element=e,this.container=t,this.compositionEngine=i,this.viewSlot=r,this.viewResources=n,this.taskQueue=o,this.currentController=null,this.currentViewModel=null,this.changes=Object.create(null)}created(e){this.owningView=e}bind(e,t){this.bindingContext=e,this.overrideContext=t,this.changes.view=this.view,this.changes.viewModel=this.viewModel,this.changes.model=this.model,this.pendingTask||processChanges(this)}unbind(){this.changes=Object.create(null),this.bindingContext=null,this.overrideContext=null;this.viewSlot.removeAll(!0,!0)}modelChanged(e,t){this.changes.model=e,requestUpdate(this)}viewChanged(e,t){this.changes.view=e,requestUpdate(this)}viewModelChanged(e,t){this.changes.viewModel=e,requestUpdate(this)}}).prototype,"model",[bindable],{enumerable:!0,initializer:null}),_descriptor2=_applyDecoratedDescriptor(_class2$4.prototype,"view",[bindable],{enumerable:!0,initializer:null}),_descriptor3=_applyDecoratedDescriptor(_class2$4.prototype,"viewModel",[bindable],{enumerable:!0,initializer:null}),_descriptor4=_applyDecoratedDescriptor(_class2$4.prototype,"swapOrder",[bindable],{enumerable:!0,initializer:null}),_class$4=_class2$4))||_class$4)||_class$4;function isEmpty(e){for(const t in e)return!1;return!0}function tryActivateViewModel$1(e,t){if(e&&"function"==typeof e.activate)return Promise.resolve(e.activate(t))}function createInstruction(e,t){return Object.assign(t,{bindingContext:e.bindingContext,overrideContext:e.overrideContext,owningView:e.owningView,container:e.container,viewSlot:e.viewSlot,viewResources:e.viewResources,currentController:e.currentController,host:e.element,swapOrder:e.swapOrder})}function processChanges(e){const t=e.changes;if(e.changes=Object.create(null),"view"in t||"viewModel"in t||!("model"in t)){let i={view:e.view,viewModel:e.currentViewModel||e.viewModel,model:e.model};i=Object.assign(i,t),i=createInstruction(e,i),e.pendingTask=e.compositionEngine.compose(i).then(t=>{e.currentController=t,e.currentViewModel=t?t.viewModel:null})}else if(e.pendingTask=tryActivateViewModel$1(e.currentViewModel,t.model),!e.pendingTask)return;e.pendingTask=e.pendingTask.then(()=>{completeCompositionTask(e)},t=>{throw completeCompositionTask(e),t})}function completeCompositionTask(e){e.pendingTask=null,isEmpty(e.changes)||processChanges(e)}function requestUpdate(e){e.pendingTask||e.updateRequested||(e.updateRequested=!0,e.taskQueue.queueMicroTask(()=>{e.updateRequested=!1,processChanges(e)}))}let IfCore=class{constructor(e,t){this.viewFactory=e,this.viewSlot=t,this.view=null,this.bindingContext=null,this.overrideContext=null,this.showing=!1,this.cache=!0}bind(e,t){this.bindingContext=e,this.overrideContext=t}unbind(){null!==this.view&&(this.view.unbind(),this.viewFactory.isCaching&&(this.showing?(this.showing=!1,this.viewSlot.remove(this.view,!0,!0)):this.view.returnToCache(),this.view=null))}_show(){if(!this.showing)return null===this.view&&(this.view=this.viewFactory.create()),this.view.isBound||this.view.bind(this.bindingContext,this.overrideContext),this.showing=!0,this.viewSlot.add(this.view);this.view.isBound||this.view.bind(this.bindingContext,this.overrideContext)}_hide(){if(!this.showing)return;this.showing=!1;let e=this.viewSlot.remove(this.view);if(e instanceof Promise)return e.then(()=>{this._unbindView()});this._unbindView()}_unbindView(){const e="false"!==this.cache&&!!this.cache;this.view.unbind(),e||(this.view=null)}};var _dec$5,_dec2$4,_dec3$3,_class$5,_class2$5,_descriptor$1,_descriptor2$1,_descriptor3$1;function _initDefineProp$1(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function _applyDecoratedDescriptor$1(e,t,i,r,n){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}let If=(_dec$5=customAttribute("if"),_dec2$4=inject(BoundViewFactory,ViewSlot),_dec3$3=bindable({primaryProperty:!0}),_dec$5(_class$5=templateController(_class$5=_dec2$4((_descriptor$1=_applyDecoratedDescriptor$1((_class2$5=class extends IfCore{constructor(...e){var t;return t=super(...e),_initDefineProp$1(this,"condition",_descriptor$1,this),_initDefineProp$1(this,"swapOrder",_descriptor2$1,this),_initDefineProp$1(this,"cache",_descriptor3$1,this),t}bind(e,t){super.bind(e,t),this.condition?this._show():this._hide()}conditionChanged(e){this._update(e)}_update(e){if(this.animating)return;let t;(t=this.elseVm?e?this._swap(this.elseVm,this):this._swap(this,this.elseVm):e?this._show():this._hide())&&(this.animating=!0,t.then(()=>{this.animating=!1,this.condition!==this.showing&&this._update(this.condition)}))}_swap(e,t){switch(this.swapOrder){case"before":return Promise.resolve(t._show()).then(()=>e._hide());case"with":return Promise.all([e._hide(),t._show()]);default:let i=e._hide();return i?i.then(()=>t._show()):t._show()}}}).prototype,"condition",[_dec3$3],{enumerable:!0,initializer:null}),_descriptor2$1=_applyDecoratedDescriptor$1(_class2$5.prototype,"swapOrder",[bindable],{enumerable:!0,initializer:null}),_descriptor3$1=_applyDecoratedDescriptor$1(_class2$5.prototype,"cache",[bindable],{enumerable:!0,initializer:function(){return!0}}),_class$5=_class2$5))||_class$5)||_class$5)||_class$5);var _dec$6,_dec2$5,_class$6;let Else=(_dec$6=customAttribute("else"))(_class$6=templateController(_class$6=(_dec2$5=inject(BoundViewFactory,ViewSlot))(_class$6=class extends IfCore{constructor(e,t){super(e,t),this._registerInIf()}bind(e,t){super.bind(e,t),this.ifVm.condition?this._hide():this._show()}_registerInIf(){let e=this.viewSlot.anchor.previousSibling;for(;e&&!e.au;)e=e.previousSibling;if(!e||!e.au.if)throw new Error("Can't find matching If for Else custom attribute.");this.ifVm=e.au.if.viewModel,this.ifVm.elseVm=this}})||_class$6)||_class$6)||_class$6;var _dec$7,_dec2$6,_class$7;let With=(_dec$7=customAttribute("with"))(_class$7=templateController(_class$7=(_dec2$6=inject(BoundViewFactory,ViewSlot))(_class$7=class{constructor(e,t){this.viewFactory=e,this.viewSlot=t,this.parentOverrideContext=null,this.view=null}bind(e,t){this.parentOverrideContext=t,this.valueChanged(this.value)}valueChanged(e){let t=createOverrideContext(e,this.parentOverrideContext);this.view?this.view.bind(e,t):(this.view=this.viewFactory.create(),this.view.bind(e,t),this.viewSlot.add(this.view))}unbind(){this.parentOverrideContext=null,this.view&&this.view.unbind()}})||_class$7)||_class$7)||_class$7,NullRepeatStrategy=class{instanceChanged(e,t){e.removeAllViews(!0)}getCollectionObserver(e,t){}};const oneTime=bindingMode.oneTime;function updateOverrideContexts(e,t){let i=e.length;for(t>0&&(t-=1);t<i;++t)updateOverrideContext(e[t].overrideContext,t,i)}function createFullOverrideContext(e,t,i,r,n){let o={},s=createOverrideContext(o,e.scope.overrideContext);return void 0!==n?(o[e.key]=n,o[e.value]=t):o[e.local]=t,updateOverrideContext(s,i,r),s}function updateOverrideContext(e,t,i){let r=0===t,n=t===i-1,o=t%2==0;e.$index=t,e.$first=r,e.$last=n,e.$middle=!(r||n),e.$odd=!o,e.$even=o}function getItemsSourceExpression(e,t){return e.behaviorInstructions.filter(e=>e.originalAttrName===t)[0].attributes.items.sourceExpression}function unwrapExpression(e){let t=!1;for(;e instanceof BindingBehavior;)e=e.expression;for(;e instanceof ValueConverter;)e=e.expression,t=!0;return t?e:null}function isOneTime(e){for(;e instanceof BindingBehavior;){if("oneTime"===e.name)return!0;e=e.expression}return!1}function updateOneTimeBinding(e){e.call&&e.mode===oneTime?e.call(sourceContext):e.updateOneTimeBindings&&e.updateOneTimeBindings()}function indexOf(e,t,i,r){if(!i)return e.indexOf(t);const n=e.length;for(let o=r||0;o<n;o++)if(i(e[o],t))return o;return-1}let ArrayRepeatStrategy=class{getCollectionObserver(e,t){return e.getArrayObserver(t)}instanceChanged(e,t){const i=t.length;if(!t||0===i)return void e.removeAllViews(!0,!e.viewsRequireLifecycle);const r=e.views(),n=r.length;if(0!==n)if(e.viewsRequireLifecycle){const o=r.slice(0),s=e.local,a=e.matcher();let l=[];const c=[];for(let e=0;e<n;e++){const i=o[e],r=i.bindingContext[s];-1===indexOf(t,r,a)?c.push(i):l.push(r)}let u,h;l.length>0?(h=e.removeViews(c,!0,!e.viewsRequireLifecycle),u=(()=>{for(let n=0;n<i;n++){const o=t[n],s=indexOf(l,o,a,n);let c;if(-1===s){const r=createFullOverrideContext(e,t[n],n,i);e.insertView(n,r.bindingContext,r),l.splice(n,0,void 0)}else s===n?(c=r[s],l[s]=void 0):(c=r[s],e.moveView(s,n),l.splice(s,1),l.splice(n,0,void 0));c&&updateOverrideContext(c.overrideContext,n,i)}this._inPlaceProcessItems(e,t)})):(h=e.removeAllViews(!0,!e.viewsRequireLifecycle),u=(()=>this._standardProcessInstanceChanged(e,t))),h instanceof Promise?h.then(u):u()}else this._inPlaceProcessItems(e,t);else this._standardProcessInstanceChanged(e,t)}_standardProcessInstanceChanged(e,t){for(let i=0,r=t.length;i<r;i++){let n=createFullOverrideContext(e,t[i],i,r);e.addView(n.bindingContext,n)}}_inPlaceProcessItems(e,t){let i=t.length,r=e.viewCount();for(;r>i;)r--,e.removeView(r,!0,!e.viewsRequireLifecycle);let n=e.local;for(let o=0;o<r;o++){let r=e.view(o),s=o===i-1,a=0!==o&&!s;r.bindingContext[n]===t[o]&&r.overrideContext.$middle===a&&r.overrideContext.$last===s||(r.bindingContext[n]=t[o],r.overrideContext.$middle=a,r.overrideContext.$last=s,e.updateBindings(r))}for(let n=r;n<i;n++){let r=createFullOverrideContext(e,t[n],n,i);e.addView(r.bindingContext,r)}}instanceMutated(e,t,i){if(e.__queuedSplices){for(let t=0,r=i.length;t<r;++t){let{index:r,removed:n,addedCount:o}=i[t];mergeSplice(e.__queuedSplices,r,n,o)}return void(e.__array=t.slice(0))}let r=this._runSplices(e,t.slice(0),i);if(r instanceof Promise){let t=e.__queuedSplices=[],i=()=>{if(!t.length)return e.__queuedSplices=void 0,void(e.__array=void 0);let r=this._runSplices(e,e.__array,t)||Promise.resolve();t=e.__queuedSplices=[],r.then(i)};r.then(i)}}_runSplices(e,t,i){let r=0,n=[];for(let t=0,o=i.length;t<o;++t){let o=i[t];for(let t=0,i=o.removed.length;t<i;++t){let t=e.removeView(o.index+r+n.length,!0);t instanceof Promise&&n.push(t)}r-=o.addedCount}if(n.length>0)return Promise.all(n).then(()=>{let r=this._handleAddedSplices(e,t,i);updateOverrideContexts(e.views(),r)});let o=this._handleAddedSplices(e,t,i);updateOverrideContexts(e.views(),o)}_handleAddedSplices(e,t,i){let r,n,o=t.length;for(let s=0,a=i.length;s<a;++s){let a=i[s],l=r=a.index,c=a.index+a.addedCount;for((null==n||n>a.index)&&(n=r);l<c;++l){let i=createFullOverrideContext(e,t[l],l,o);e.insertView(l,i.bindingContext,i)}}return n}},MapRepeatStrategy=class{getCollectionObserver(e,t){return e.getMapObserver(t)}instanceChanged(e,t){let i=e.removeAllViews(!0,!e.viewsRequireLifecycle);i instanceof Promise?i.then(()=>this._standardProcessItems(e,t)):this._standardProcessItems(e,t)}_standardProcessItems(e,t){let i,r=0;t.forEach((n,o)=>{i=createFullOverrideContext(e,n,r,t.size,o),e.addView(i.bindingContext,i),++r})}instanceMutated(e,t,i){let r,n,o,s,a,l,c,u,h=[];for(n=0,o=i.length;n<o;++n)switch(r=(c=i[n]).key,c.type){case"update":a=this._getViewIndexByKey(e,r),(u=e.removeView(a,!0,!e.viewsRequireLifecycle))instanceof Promise&&h.push(u),s=createFullOverrideContext(e,t.get(r),a,t.size,r),e.insertView(a,s.bindingContext,s);break;case"add":l=e.viewCount()<=t.size-1?e.viewCount():t.size-1,s=createFullOverrideContext(e,t.get(r),l,t.size,r),e.insertView(t.size-1,s.bindingContext,s);break;case"delete":if(void 0===c.oldValue)return;a=this._getViewIndexByKey(e,r),(u=e.removeView(a,!0,!e.viewsRequireLifecycle))instanceof Promise&&h.push(u);break;case"clear":e.removeAllViews(!0,!e.viewsRequireLifecycle);break;default:continue}h.length>0?Promise.all(h).then(()=>{updateOverrideContexts(e.views(),0)}):updateOverrideContexts(e.views(),0)}_getViewIndexByKey(e,t){let i,r,n;for(i=0,r=e.viewCount();i<r;++i)if((n=e.view(i)).bindingContext[e.key]===t)return i}},SetRepeatStrategy=class{getCollectionObserver(e,t){return e.getSetObserver(t)}instanceChanged(e,t){let i=e.removeAllViews(!0,!e.viewsRequireLifecycle);i instanceof Promise?i.then(()=>this._standardProcessItems(e,t)):this._standardProcessItems(e,t)}_standardProcessItems(e,t){let i,r=0;t.forEach(n=>{i=createFullOverrideContext(e,n,r,t.size),e.addView(i.bindingContext,i),++r})}instanceMutated(e,t,i){let r,n,o,s,a,l,c,u=[];for(n=0,o=i.length;n<o;++n)switch(r=(l=i[n]).value,l.type){case"add":let o=Math.max(t.size-1,0);s=createFullOverrideContext(e,r,o,t.size),e.insertView(o,s.bindingContext,s);break;case"delete":a=this._getViewIndexByValue(e,r),(c=e.removeView(a,!0,!e.viewsRequireLifecycle))instanceof Promise&&u.push(c);break;case"clear":e.removeAllViews(!0,!e.viewsRequireLifecycle);break;default:continue}u.length>0?Promise.all(u).then(()=>{updateOverrideContexts(e.views(),0)}):updateOverrideContexts(e.views(),0)}_getViewIndexByValue(e,t){let i,r,n;for(i=0,r=e.viewCount();i<r;++i)if((n=e.view(i)).bindingContext[e.local]===t)return i}},NumberRepeatStrategy=class{getCollectionObserver(){return null}instanceChanged(e,t){let i=e.removeAllViews(!0,!e.viewsRequireLifecycle);i instanceof Promise?i.then(()=>this._standardProcessItems(e,t)):this._standardProcessItems(e,t)}_standardProcessItems(e,t){let i,r,n,o,s=e.viewCount();if((o=s-(t=Math.floor(t)))>0)for(o>s&&(o=s),i=0,r=o;i<r;++i)e.removeView(s-(i+1),!0,!e.viewsRequireLifecycle);else{for(i=s,r=t;i<r;++i)n=createFullOverrideContext(e,i,i,r),e.addView(n.bindingContext,n);updateOverrideContexts(e.views(),0)}}},RepeatStrategyLocator=class{constructor(){this.matchers=[],this.strategies=[],this.addStrategy(e=>null==e,new NullRepeatStrategy),this.addStrategy(e=>e instanceof Array,new ArrayRepeatStrategy),this.addStrategy(e=>e instanceof Map,new MapRepeatStrategy),this.addStrategy(e=>e instanceof Set,new SetRepeatStrategy),this.addStrategy(e=>"number"==typeof e,new NumberRepeatStrategy)}addStrategy(e,t){this.matchers.push(e),this.strategies.push(t)}getStrategy(e){let t=this.matchers;for(let i=0,r=t.length;i<r;++i)if(t[i](e))return this.strategies[i];return null}};const lifecycleOptionalBehaviors=["focus","if","else","repeat","show","hide","with"];function behaviorRequiresLifecycle(e){let t=e.type,i=null!==t.elementName?t.elementName:t.attributeName;return-1===lifecycleOptionalBehaviors.indexOf(i)&&(t.handlesAttached||t.handlesBind||t.handlesCreated||t.handlesDetached||t.handlesUnbind)||t.viewFactory&&viewsRequireLifecycle(t.viewFactory)||e.viewFactory&&viewsRequireLifecycle(e.viewFactory)}function targetRequiresLifecycle(e){let t=e.behaviorInstructions;if(t){let e=t.length;for(;e--;)if(behaviorRequiresLifecycle(t[e]))return!0}return e.viewFactory&&viewsRequireLifecycle(e.viewFactory)}function viewsRequireLifecycle(e){if("_viewsRequireLifecycle"in e)return e._viewsRequireLifecycle;if(e._viewsRequireLifecycle=!1,e.viewFactory)return e._viewsRequireLifecycle=viewsRequireLifecycle(e.viewFactory),e._viewsRequireLifecycle;if(e.template.querySelector(".au-animate"))return e._viewsRequireLifecycle=!0,!0;for(let t in e.instructions)if(targetRequiresLifecycle(e.instructions[t]))return e._viewsRequireLifecycle=!0,!0;return e._viewsRequireLifecycle=!1,!1}let AbstractRepeater=class{constructor(e){Object.assign(this,{local:"items",viewsRequireLifecycle:!0},e)}viewCount(){throw new Error("subclass must implement `viewCount`")}views(){throw new Error("subclass must implement `views`")}view(e){throw new Error("subclass must implement `view`")}matcher(){throw new Error("subclass must implement `matcher`")}addView(e,t){throw new Error("subclass must implement `addView`")}insertView(e,t,i){throw new Error("subclass must implement `insertView`")}moveView(e,t){throw new Error("subclass must implement `moveView`")}removeAllViews(e,t){throw new Error("subclass must implement `removeAllViews`")}removeViews(e,t,i){throw new Error("subclass must implement `removeView`")}removeView(e,t,i){throw new Error("subclass must implement `removeView`")}updateBindings(e){throw new Error("subclass must implement `updateBindings`")}};var _dec$8,_dec2$7,_class$8,_class2$6,_descriptor$2,_descriptor2$2,_descriptor3$2,_descriptor4$1;function _initDefineProp$2(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function _applyDecoratedDescriptor$2(e,t,i,r,n){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}let Repeat=(_dec$8=customAttribute("repeat"))(_class$8=templateController(_class$8=(_dec2$7=inject(BoundViewFactory,TargetInstruction,ViewSlot,ViewResources,ObserverLocator,RepeatStrategyLocator))((_descriptor$2=_applyDecoratedDescriptor$2((_class2$6=class extends AbstractRepeater{constructor(e,t,i,r,n,o){super({local:"item",viewsRequireLifecycle:viewsRequireLifecycle(e)}),_initDefineProp$2(this,"items",_descriptor$2,this),_initDefineProp$2(this,"local",_descriptor2$2,this),_initDefineProp$2(this,"key",_descriptor3$2,this),_initDefineProp$2(this,"value",_descriptor4$1,this),this.viewFactory=e,this.instruction=t,this.viewSlot=i,this.lookupFunctions=r.lookupFunctions,this.observerLocator=n,this.key="key",this.value="value",this.strategyLocator=o,this.ignoreMutation=!1,this.sourceExpression=getItemsSourceExpression(this.instruction,"repeat.for"),this.isOneTime=isOneTime(this.sourceExpression),this.viewsRequireLifecycle=viewsRequireLifecycle(e)}call(e,t){this[e](this.items,t)}bind(e,t){this.scope={bindingContext:e,overrideContext:t},this.matcherBinding=this._captureAndRemoveMatcherBinding(),this.itemsChanged()}unbind(){this.scope=null,this.items=null,this.matcherBinding=null,this.viewSlot.removeAll(!0,!0),this._unsubscribeCollection()}_unsubscribeCollection(){this.collectionObserver&&(this.collectionObserver.unsubscribe(this.callContext,this),this.collectionObserver=null,this.callContext=null)}itemsChanged(){if(this._unsubscribeCollection(),!this.scope)return;let e=this.items;if(this.strategy=this.strategyLocator.getStrategy(e),!this.strategy)throw new Error(`Value for '${this.sourceExpression}' is non-repeatable`);this.isOneTime||this._observeInnerCollection()||this._observeCollection(),this.ignoreMutation=!0,this.strategy.instanceChanged(this,e),this.observerLocator.taskQueue.queueMicroTask(()=>{this.ignoreMutation=!1})}_getInnerCollection(){let e=unwrapExpression(this.sourceExpression);return e?e.evaluate(this.scope,null):null}handleCollectionMutated(e,t){this.collectionObserver&&(this.ignoreMutation||this.strategy.instanceMutated(this,e,t))}handleInnerCollectionMutated(e,t){if(!this.collectionObserver)return;if(this.ignoreMutation)return;this.ignoreMutation=!0;let i=this.sourceExpression.evaluate(this.scope,this.lookupFunctions);this.observerLocator.taskQueue.queueMicroTask(()=>this.ignoreMutation=!1),i===this.items?this.itemsChanged():this.items=i}_observeInnerCollection(){let e=this._getInnerCollection(),t=this.strategyLocator.getStrategy(e);return!!t&&(this.collectionObserver=t.getCollectionObserver(this.observerLocator,e),!!this.collectionObserver&&(this.callContext="handleInnerCollectionMutated",this.collectionObserver.subscribe(this.callContext,this),!0))}_observeCollection(){let e=this.items;this.collectionObserver=this.strategy.getCollectionObserver(this.observerLocator,e),this.collectionObserver&&(this.callContext="handleCollectionMutated",this.collectionObserver.subscribe(this.callContext,this))}_captureAndRemoveMatcherBinding(){if(this.viewFactory.viewFactory){const e=this.viewFactory.viewFactory.instructions,t=Object.keys(e);for(let i=0;i<t.length;i++){const r=e[t[i]].expressions;if(r)for(let e=0;i<r.length;i++)if("matcher"===r[e].targetProperty){const t=r[e];return r.splice(e,1),t}}}}viewCount(){return this.viewSlot.children.length}views(){return this.viewSlot.children}view(e){return this.viewSlot.children[e]}matcher(){return this.matcherBinding?this.matcherBinding.sourceExpression.evaluate(this.scope,this.matcherBinding.lookupFunctions):null}addView(e,t){let i=this.viewFactory.create();i.bind(e,t),this.viewSlot.add(i)}insertView(e,t,i){let r=this.viewFactory.create();r.bind(t,i),this.viewSlot.insert(e,r)}moveView(e,t){this.viewSlot.move(e,t)}removeAllViews(e,t){return this.viewSlot.removeAll(e,t)}removeViews(e,t,i){return this.viewSlot.removeMany(e,t,i)}removeView(e,t,i){return this.viewSlot.removeAt(e,t,i)}updateBindings(e){let t=e.bindings.length;for(;t--;)updateOneTimeBinding(e.bindings[t]);for(t=e.controllers.length;t--;){let i=e.controllers[t].boundProperties.length;for(;i--;){updateOneTimeBinding(e.controllers[t].boundProperties[i].binding)}}}}).prototype,"items",[bindable],{enumerable:!0,initializer:null}),_descriptor2$2=_applyDecoratedDescriptor$2(_class2$6.prototype,"local",[bindable],{enumerable:!0,initializer:null}),_descriptor3$2=_applyDecoratedDescriptor$2(_class2$6.prototype,"key",[bindable],{enumerable:!0,initializer:null}),_descriptor4$1=_applyDecoratedDescriptor$2(_class2$6.prototype,"value",[bindable],{enumerable:!0,initializer:null}),_class$8=_class2$6))||_class$8)||_class$8)||_class$8;const aureliaHideClassName="aurelia-hide",aureliaHideClass=".aurelia-hide { display:none !important; }";function injectAureliaHideStyleAtHead(){DOM.injectStyles(aureliaHideClass)}function injectAureliaHideStyleAtBoundary(e){FEATURE.shadowDOM&&e&&!e.hasAureliaHideStyle&&(e.hasAureliaHideStyle=!0,DOM.injectStyles(aureliaHideClass,e))}var _dec$9,_class$9;let Show=(_dec$9=customAttribute("show"))(_class$9=class{static inject(){return[DOM.Element,Animator,Optional.of(DOM.boundary,!0)]}constructor(e,t,i){this.element=e,this.animator=t,this.domBoundary=i}created(){injectAureliaHideStyleAtBoundary(this.domBoundary)}valueChanged(e){e?this.animator.removeClass(this.element,"aurelia-hide"):this.animator.addClass(this.element,"aurelia-hide")}bind(e){this.valueChanged(this.value)}})||_class$9;var _dec$a,_class$a;let Hide=(_dec$a=customAttribute("hide"))(_class$a=class{static inject(){return[DOM.Element,Animator,Optional.of(DOM.boundary,!0)]}constructor(e,t,i){this.element=e,this.animator=t,this.domBoundary=i}created(){injectAureliaHideStyleAtBoundary(this.domBoundary)}valueChanged(e){e?this.animator.addClass(this.element,"aurelia-hide"):this.animator.removeClass(this.element,"aurelia-hide")}bind(e){this.valueChanged(this.value)}})||_class$a;const SCRIPT_REGEX=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;let HTMLSanitizer=class{sanitize(e){return e.replace(SCRIPT_REGEX,"")}};var _dec$b,_dec2$8,_class$b;let SanitizeHTMLValueConverter=(_dec$b=valueConverter("sanitizeHTML"))(_class$b=(_dec2$8=inject(HTMLSanitizer))(_class$b=class{constructor(e){this.sanitizer=e}toView(e){return null==e?null:this.sanitizer.sanitize(e)}})||_class$b)||_class$b;var _dec$c,_dec2$9,_class$c;let Replaceable=(_dec$c=customAttribute("replaceable"))(_class$c=templateController(_class$c=(_dec2$9=inject(BoundViewFactory,ViewSlot))(_class$c=class{constructor(e,t){this.viewFactory=e,this.viewSlot=t,this.view=null}bind(e,t){null===this.view&&(this.view=this.viewFactory.create(),this.viewSlot.add(this.view)),this.view.bind(e,t)}unbind(){this.view.unbind()}})||_class$c)||_class$c)||_class$c;var _dec$d,_class$d;let Focus=(_dec$d=customAttribute("focus",bindingMode.twoWay))(_class$d=class{static inject(){return[DOM.Element,TaskQueue]}constructor(e,t){this.element=e,this.taskQueue=t,this.isAttached=!1,this.needsApply=!1}valueChanged(e){this.isAttached?this._apply():this.needsApply=!0}_apply(){this.value?this.taskQueue.queueMicroTask(()=>{this.value&&this.element.focus()}):this.element.blur()}attached(){this.isAttached=!0,this.needsApply&&(this.needsApply=!1,this._apply()),this.element.addEventListener("focus",this),this.element.addEventListener("blur",this)}detached(){this.isAttached=!1,this.element.removeEventListener("focus",this),this.element.removeEventListener("blur",this)}handleEvent(e){"focus"===e.type?this.value=!0:DOM.activeElement!==this.element&&(this.value=!1)}})||_class$d,cssUrlMatcher=/url\((?!['"]data)([^)]+)\)/gi;function fixupCSSUrls(e,t){if("string"!=typeof t)throw new Error(`Failed loading required CSS file: ${e}`);return t.replace(cssUrlMatcher,(t,i)=>{let r=i.charAt(0);return"'"!==r&&'"'!==r||(i=i.substr(1,i.length-2)),"url('"+relativeToFile(i,e)+"')"})}let CSSResource=class{constructor(e){this.address=e,this._scoped=null,this._global=!1,this._alreadyGloballyInjected=!1}initialize(e,t){this._scoped=new t(this)}register(e,t){"scoped"===t?e.registerViewEngineHooks(this._scoped):this._global=!0}load(e){return e.get(Loader).loadText(this.address).catch(e=>null).then(e=>{e=fixupCSSUrls(this.address,e),this._scoped.css=e,this._global&&(this._alreadyGloballyInjected=!0,DOM.injectStyles(e))})}},CSSViewEngineHooks=class{constructor(e){this.owner=e,this.css=null}beforeCompile(e,t,i){if(i.targetShadowDOM)DOM.injectStyles(this.css,e,!0);else if(FEATURE.scopedCSS){DOM.injectStyles(this.css,e,!0).setAttribute("scoped","scoped")}else this._global&&!this.owner._alreadyGloballyInjected&&(DOM.injectStyles(this.css),this.owner._alreadyGloballyInjected=!0)}};function _createCSSResource(e){var t;return resource(new CSSResource(e))(t=class extends CSSViewEngineHooks{})||t}var _dec$e,_class$e;let AttrBindingBehavior=(_dec$e=bindingBehavior("attr"))(_class$e=class{bind(e,t){e.targetObserver=new DataAttributeObserver(e.target,e.targetProperty)}unbind(e,t){}})||_class$e;var _dec$f,_dec2$a,_class$f,_dec3$4,_dec4$3,_class2$7,_dec5$3,_dec6$3,_class3$4,_dec7$3,_dec8$2,_class4$3,_dec9$2,_dec10$2,_class5$4;let modeBindingBehavior={bind(e,t,i){e.originalMode=e.mode,e.mode=this.mode},unbind(e,t){e.mode=e.originalMode,e.originalMode=null}},OneTimeBindingBehavior=(_dec$f=mixin(modeBindingBehavior))(_class$f=(_dec2$a=bindingBehavior("oneTime"))(_class$f=class{constructor(){this.mode=bindingMode.oneTime}})||_class$f)||_class$f,OneWayBindingBehavior=(_dec3$4=mixin(modeBindingBehavior))(_class2$7=(_dec4$3=bindingBehavior("oneWay"))(_class2$7=class{constructor(){this.mode=bindingMode.toView}})||_class2$7)||_class2$7,ToViewBindingBehavior=(_dec5$3=mixin(modeBindingBehavior))(_class3$4=(_dec6$3=bindingBehavior("toView"))(_class3$4=class{constructor(){this.mode=bindingMode.toView}})||_class3$4)||_class3$4,FromViewBindingBehavior=(_dec7$3=mixin(modeBindingBehavior))(_class4$3=(_dec8$2=bindingBehavior("fromView"))(_class4$3=class{constructor(){this.mode=bindingMode.fromView}})||_class4$3)||_class4$3,TwoWayBindingBehavior=(_dec9$2=mixin(modeBindingBehavior))(_class5$4=(_dec10$2=bindingBehavior("twoWay"))(_class5$4=class{constructor(){this.mode=bindingMode.twoWay}})||_class5$4)||_class5$4;var _dec$g,_class$g;function throttle(e){let t=this.throttleState,i=+new Date-t.last;if(i>=t.delay)return clearTimeout(t.timeoutId),t.timeoutId=null,t.last=+new Date,void this.throttledMethod(e);t.newValue=e,null===t.timeoutId&&(t.timeoutId=setTimeout(()=>{t.timeoutId=null,t.last=+new Date,this.throttledMethod(t.newValue)},t.delay-i))}let ThrottleBindingBehavior=(_dec$g=bindingBehavior("throttle"))(_class$g=class{bind(e,t,i=200){let r="updateTarget";e.callSource?r="callSource":e.updateSource&&e.mode===bindingMode.twoWay&&(r="updateSource"),e.throttledMethod=e[r],e.throttledMethod.originalName=r,e[r]=throttle,e.throttleState={delay:i,last:0,timeoutId:null}}unbind(e,t){e[e.throttledMethod.originalName]=e.throttledMethod,e.throttledMethod=null,clearTimeout(e.throttleState.timeoutId),e.throttleState=null}})||_class$g;var _dec$h,_class$h;const unset={};function debounceCallSource(e){const t=this.debounceState;clearTimeout(t.timeoutId),t.timeoutId=setTimeout(()=>this.debouncedMethod(e),t.delay)}function debounceCall(e,t,i){const r=this.debounceState;if(clearTimeout(r.timeoutId),e!==r.callContextToDebounce)return r.oldValue=unset,void this.debouncedMethod(e,t,i);r.oldValue===unset&&(r.oldValue=i),r.timeoutId=setTimeout(()=>{const i=r.oldValue;r.oldValue=unset,this.debouncedMethod(e,t,i)},r.delay)}let DebounceBindingBehavior=(_dec$h=bindingBehavior("debounce"))(_class$h=class{bind(e,t,i=200){const r=void 0!==e.callSource,n=r?"callSource":"call",o=r?debounceCallSource:debounceCall,s=e.mode,a=s===bindingMode.twoWay||s===bindingMode.fromView?targetContext:sourceContext;e.debouncedMethod=e[n],e.debouncedMethod.originalName=n,e[n]=o,e.debounceState={callContextToDebounce:a,delay:i,timeoutId:0,oldValue:unset}}unbind(e,t){e[e.debouncedMethod.originalName]=e.debouncedMethod,e.debouncedMethod=null,clearTimeout(e.debounceState.timeoutId),e.debounceState=null}})||_class$h;var _dec$i,_class$i;function findOriginalEventTarget$1(e){return e.path&&e.path[0]||e.deepPath&&e.deepPath[0]||e.target}function handleSelfEvent(e){let t=findOriginalEventTarget$1(e);this.target===t&&this.selfEventCallSource(e)}let SelfBindingBehavior=(_dec$i=bindingBehavior("self"))(_class$i=class{bind(e,t){if(!e.callSource||!e.targetEvent)throw new Error("Self binding behavior only supports event.");e.selfEventCallSource=e.callSource,e.callSource=handleSelfEvent}unbind(e,t){e.callSource=e.selfEventCallSource,e.selfEventCallSource=null}})||_class$i,BindingSignaler=class{constructor(){this.signals={}}signal(e){let t=this.signals[e];if(!t)return;let i=t.length;for(;i--;)t[i].call(sourceContext)}};var _dec$j,_class$j;let SignalBindingBehavior=(_dec$j=bindingBehavior("signal"))(_class$j=class{static inject(){return[BindingSignaler]}constructor(e){this.signals=e.signals}bind(e,t){if(!e.updateTarget)throw new Error("Only property bindings and string interpolation bindings can be signaled.  Trigger, delegate and call bindings cannot be signaled.");if(3===arguments.length){let t=arguments[2];(this.signals[t]||(this.signals[t]=[])).push(e),e.signalName=t}else{if(!(arguments.length>3))throw new Error("Signal name is required.");{let t=Array.prototype.slice.call(arguments,2),i=t.length;for(;i--;){let r=t[i];(this.signals[r]||(this.signals[r]=[])).push(e)}e.signalName=t}}}unbind(e,t){let i=e.signalName;if(e.signalName=null,Array.isArray(i)){let t=i,r=t.length;for(;r--;){let i=t[r],n=this.signals[i];n.splice(n.indexOf(e),1)}}else{let t=this.signals[i];t.splice(t.indexOf(e),1)}}})||_class$j;var _dec$k,_class$k;const eventNamesRequired="The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:'blur'\">",notApplicableMessage="The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.";let UpdateTriggerBindingBehavior=(_dec$k=bindingBehavior("updateTrigger"))(_class$k=class{bind(e,t,...i){if(0===i.length)throw new Error(eventNamesRequired);if(e.mode!==bindingMode.twoWay&&e.mode!==bindingMode.fromView)throw new Error(notApplicableMessage);let r=e.observerLocator.getObserver(e.target,e.targetProperty);if(!r.handler)throw new Error(notApplicableMessage);e.targetObserver=r,r.originalHandler=e.targetObserver.handler;let n=new EventSubscriber(i);r.handler=n}unbind(e,t){e.targetObserver.handler.dispose(),e.targetObserver.handler=e.targetObserver.originalHandler,e.targetObserver.originalHandler=null}})||_class$k;function _createDynamicElement(e,t,i){var r;let n=customElement(e)(r=useView(t)(r=class{bind(e){this.$parent=e}})||r)||r;for(let e=0,t=i.length;e<t;++e)bindable(i[e])(n);return n}function getElementName(e){return/([^\/^\?]+)\.html/i.exec(e)[1].toLowerCase()}function configure$1(e){let t=e.container.get(ViewEngine),i=e.aurelia.loader;t.addResourcePlugin(".html",{fetch:function(e){return i.loadTemplate(e).then(t=>{let i=t.template.getAttribute("bindable"),r=getElementName(e);return i?(i=i.split(",").map(e=>e.trim()),t.template.removeAttribute("bindable")):i=[],{[r]:_createDynamicElement(r,e,i)}})}})}function configure$2(e){injectAureliaHideStyleAtHead(),e.globalResources(Compose,If,Else,With,Repeat,Show,Hide,Replaceable,Focus,SanitizeHTMLValueConverter,OneTimeBindingBehavior,OneWayBindingBehavior,ToViewBindingBehavior,FromViewBindingBehavior,TwoWayBindingBehavior,ThrottleBindingBehavior,DebounceBindingBehavior,SelfBindingBehavior,SignalBindingBehavior,UpdateTriggerBindingBehavior,AttrBindingBehavior),configure$1(e);let t=e.container.get(ViewEngine),i={fetch:e=>({[e]:_createCSSResource(e)})};[".css",".less",".sass",".scss",".styl"].forEach(e=>t.addResourcePlugin(e,i))}var logger$3=getLogger("event-aggregator"),Handler=function(){function e(e,t){this.messageType=e,this.callback=t}return e.prototype.handle=function(e){e instanceof this.messageType&&this.callback.call(null,e)},e}();function invokeCallback(e,t,i){try{e(t,i)}catch(e){logger$3.error(e)}}function invokeHandler(e,t){try{e.handle(t)}catch(e){logger$3.error(e)}}var EventAggregator=function(){function e(){this.eventLookup={},this.messageHandlers=[]}return e.prototype.publish=function(e,t){var i=void 0,r=void 0;if(!e)throw new Error("Event was invalid.");if("string"==typeof e){if(i=this.eventLookup[e])for(r=(i=i.slice()).length;r--;)invokeCallback(i[r],t,e)}else for(r=(i=this.messageHandlers.slice()).length;r--;)invokeHandler(i[r],e)},e.prototype.subscribe=function(e,t){var i=void 0,r=void 0;if(!e)throw new Error("Event channel/type was invalid.");return"string"==typeof e?(i=t,r=this.eventLookup[e]||(this.eventLookup[e]=[])):(i=new Handler(e,t),r=this.messageHandlers),r.push(i),{dispose:function(){var e=r.indexOf(i);-1!==e&&r.splice(e,1)}}},e.prototype.subscribeOnce=function(e,t){var i=this.subscribe(e,function(e,r){return i.dispose(),t(e,r)});return i},e}();function includeEventsIn(e){var t=new EventAggregator;return e.subscribeOnce=function(e,i){return t.subscribeOnce(e,i)},e.subscribe=function(e,i){return t.subscribe(e,i)},e.publish=function(e,i){t.publish(e,i)},t}function configure$3(e){e.instance(EventAggregator,includeEventsIn(e.aurelia))}function mi$1(e){throw new Error("History must implement "+e+"().")}var _class$l,_temp$3,History=function(){function e(){}return e.prototype.activate=function(e){mi$1("activate")},e.prototype.deactivate=function(){mi$1("deactivate")},e.prototype.getAbsoluteRoot=function(){mi$1("getAbsoluteRoot")},e.prototype.navigate=function(e,t){mi$1("navigate")},e.prototype.navigateBack=function(){mi$1("navigateBack")},e.prototype.setTitle=function(e){mi$1("setTitle")},e.prototype.setState=function(e,t){mi$1("setState")},e.prototype.getState=function(e){mi$1("getState")},e.prototype.getHistoryIndex=function(){mi$1("getHistoryIndex")},e.prototype.go=function(e){mi$1("go")},e}();function _possibleConstructorReturn$2(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var LinkHandler=function(){function e(){}return e.prototype.activate=function(e){},e.prototype.deactivate=function(){},e}(),DefaultLinkHandler=function(e){function t(){var i=_possibleConstructorReturn$2(this,e.call(this));return i.handler=function(e){var r=t.getEventInfo(e),n=r.shouldHandleEvent,o=r.href;n&&(e.preventDefault(),i.history.navigate(o))},i}return _inherits$2(t,e),t.prototype.activate=function(e){e._hasPushState&&(this.history=e,DOM.addEventListener("click",this.handler,!0))},t.prototype.deactivate=function(){DOM.removeEventListener("click",this.handler)},t.getEventInfo=function(e){var i={shouldHandleEvent:!1,href:null,anchor:null},r=t.findClosestAnchor(e.target);if(!r||!t.targetIsThisWindow(r))return i;if(r.hasAttribute("download")||r.hasAttribute("router-ignore")||r.hasAttribute("data-router-ignore"))return i;if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return i;var n=r.getAttribute("href");i.anchor=r,i.href=n;var o=1===e.which,s=n&&!("#"===n.charAt(0)||/^[a-z]+:/i.test(n));return i.shouldHandleEvent=o&&s,i},t.findClosestAnchor=function(e){for(;e;){if("A"===e.tagName)return e;e=e.parentNode}},t.targetIsThisWindow=function(e){var t=e.getAttribute("target"),i=PLATFORM.global;return!t||t===i.name||"_self"===t},t}(LinkHandler);function configure$4(e){e.singleton(History,BrowserHistory),e.transient(LinkHandler,DefaultLinkHandler)}var BrowserHistory=(_temp$3=_class$l=function(e){function t(t){var i=_possibleConstructorReturn$2(this,e.call(this));return i._isActive=!1,i._checkUrlCallback=i._checkUrl.bind(i),i.location=PLATFORM.location,i.history=PLATFORM.history,i.linkHandler=t,i}return _inherits$2(t,e),t.prototype.activate=function(e){if(this._isActive)throw new Error("History has already been activated.");var t=!!e.pushState;this._isActive=!0,this.options=Object.assign({},{root:"/"},this.options,e),this.root=("/"+this.options.root+"/").replace(rootStripper,"/"),this._wantsHashChange=!1!==this.options.hashChange,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=void 0;if(this._hasPushState?i="popstate":this._wantsHashChange&&(i="hashchange"),PLATFORM.addEventListener(i,this._checkUrlCallback),this._wantsHashChange&&t){var r=this.location,n=r.pathname.replace(/[^\/]$/,"$&/")===this.root;if(!this._hasPushState&&!n)return this.fragment=this._getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&n&&r.hash&&(this.fragment=this._getHash().replace(routeStripper,""),this.history.replaceState({},DOM.title,this.root+this.fragment+r.search))}if(this.fragment||(this.fragment=this._getFragment()),this.linkHandler.activate(this),!this.options.silent)return this._loadUrl()},t.prototype.deactivate=function(){PLATFORM.removeEventListener("popstate",this._checkUrlCallback),PLATFORM.removeEventListener("hashchange",this._checkUrlCallback),this._isActive=!1,this.linkHandler.deactivate()},t.prototype.getAbsoluteRoot=function(){return""+createOrigin(this.location.protocol,this.location.hostname,this.location.port)+this.root},t.prototype.navigate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.trigger,r=void 0===i||i,n=t.replace,o=void 0!==n&&n;if(e&&absoluteUrl.test(e))return this.location.href=e,!0;if(!this._isActive)return!1;if(e=this._getFragment(e||""),this.fragment===e&&!o)return!1;this.fragment=e;var s=this.root+e;return""===e&&"/"!==s&&(s=s.slice(0,-1)),this._hasPushState?(s=s.replace("//","/"),this.history[o?"replaceState":"pushState"]({},DOM.title,s)):this._wantsHashChange?updateHash(this.location,e,o):this.location.assign(s),!r||this._loadUrl(e)},t.prototype.navigateBack=function(){this.history.back()},t.prototype.setTitle=function(e){DOM.title=e},t.prototype.setState=function(e,t){var i=Object.assign({},this.history.state),r=this.location,n=r.pathname,o=r.search,s=r.hash;i[e]=t,this.history.replaceState(i,null,""+n+o+s)},t.prototype.getState=function(e){return Object.assign({},this.history.state)[e]},t.prototype.getHistoryIndex=function(){var e=this.getState("HistoryIndex");return void 0===e&&(e=this.history.length-1,this.setState("HistoryIndex",e)),e},t.prototype.go=function(e){this.history.go(e)},t.prototype._getHash=function(){return this.location.hash.substr(1)},t.prototype._getFragment=function(e,t){var i=void 0;return e||(this._hasPushState||!this._wantsHashChange||t?(e=this.location.pathname+this.location.search,i=this.root.replace(trailingSlash,""),e.indexOf(i)||(e=e.substr(i.length))):e=this._getHash()),"/"+e.replace(routeStripper,"")},t.prototype._checkUrl=function(){this._getFragment()!==this.fragment&&this._loadUrl()},t.prototype._loadUrl=function(e){var t=this.fragment=this._getFragment(e);return!!this.options.routeHandler&&this.options.routeHandler(t)},t}(History),_class$l.inject=[LinkHandler],_temp$3),routeStripper=/^#?\/*|\s+$/g,rootStripper=/^\/+|\/+$/g,trailingSlash=/\/$/,absoluteUrl=/^([a-z][a-z0-9+\-.]*:)?\/\//i;function updateHash(e,t,i){if(i){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}function createOrigin(e,t,i){return e+"//"+t+(i?":"+i:"")}var State=function(){function e(e){this.charSpec=e,this.nextStates=[]}return e.prototype.get=function(e){var t=this.nextStates,i=Array.isArray(t),r=0;for(t=i?t:t[Symbol.iterator]();;){var n;if(i){if(r>=t.length)break;n=t[r++]}else{if((r=t.next()).done)break;n=r.value}var o=n;if(o.charSpec.validChars===e.validChars&&o.charSpec.invalidChars===e.invalidChars)return o}},e.prototype.put=function(t){var i=this.get(t);return i||(i=new e(t),this.nextStates.push(i),t.repeat&&i.nextStates.push(i),i)},e.prototype.match=function(e){for(var t=this.nextStates,i=[],r=0,n=t.length;r<n;r++){var o=t[r],s=o.charSpec;void 0!==s.validChars?-1!==s.validChars.indexOf(e)&&i.push(o):void 0!==s.invalidChars&&-1===s.invalidChars.indexOf(e)&&i.push(o)}return i},e}(),specials=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],escapeRegex=new RegExp("(\\"+specials.join("|\\")+")","g"),StaticSegment=function(){function e(e,t){this.string=e,this.caseSensitive=t}return e.prototype.eachChar=function(e){for(var t=this.string,i=0,r=t.length;i<r;++i){var n=t[i];e({validChars:this.caseSensitive?n:n.toUpperCase()+n.toLowerCase()})}},e.prototype.regex=function(){return this.string.replace(escapeRegex,"\\$1")},e.prototype.generate=function(){return this.string},e}(),DynamicSegment=function(){function e(e,t){this.name=e,this.optional=t}return e.prototype.eachChar=function(e){e({invalidChars:"/",repeat:!0})},e.prototype.regex=function(){return"([^/]+)"},e.prototype.generate=function(e,t){return t[this.name]=!0,e[this.name]},e}(),StarSegment=function(){function e(e){this.name=e}return e.prototype.eachChar=function(e){e({invalidChars:"",repeat:!0})},e.prototype.regex=function(){return"(.+)"},e.prototype.generate=function(e,t){return t[this.name]=!0,e[this.name]},e}(),EpsilonSegment=function(){function e(){}return e.prototype.eachChar=function(){},e.prototype.regex=function(){return""},e.prototype.generate=function(){return""},e}(),RouteRecognizer=function(){function e(){this.rootState=new State,this.names={},this.routes=new Map}return e.prototype.add=function(e){var t=this;if(!Array.isArray(e)){for(var i=this.rootState,r=[],n="^",o={statics:0,dynamics:0,stars:0},s=[],a=e.handler.name,l=!0,c=parse(e.path,s,o,e.caseSensitive),u=0,h=c.length;u<h;u++){var d=c[u];if(!(d instanceof EpsilonSegment)){for(var p=addSegment(i,d),f=p[0],v=p[1],g=0,m=r.length;g<m;g++)r[g].nextStates.push(f);d.optional?(r.push(v),n+="(?:/"+d.regex()+")?"):(i=v,n+="/"+d.regex(),r.length=0,l=!1)}}l&&(i=i.put({validChars:"/"}),n+="/?");var b=[{handler:e.handler,names:s}];if(this.routes.set(e.handler,{segments:c,handlers:b}),a)for(var y=Array.isArray(a)?a:[a],w=0;w<y.length;w++)y[w]in this.names||(this.names[y[w]]={segments:c,handlers:b});for(var x=0;x<r.length;x++){var _=r[x];_.handlers=b,_.regex=new RegExp(n+"$",e.caseSensitive?"":"i"),_.types=o}return i.handlers=b,i.regex=new RegExp(n+"$",e.caseSensitive?"":"i"),i.types=o,i}e.forEach(function(e){return t.add(e)})},e.prototype.getRoute=function(e){return"string"==typeof e?this.names[e]:this.routes.get(e)},e.prototype.handlersFor=function(e){var t=this.getRoute(e);if(!t)throw new Error("There is no route named "+e);return[].concat(t.handlers)},e.prototype.hasRoute=function(e){return!!this.getRoute(e)},e.prototype.generate=function(e,t){var i=this.getRoute(e);if(!i)throw new Error("There is no route named "+e);var r=i.handlers[0].handler;if(r.generationUsesHref)return r.href;for(var n=Object.assign({},t),o=i.segments,s={},a="",l=0,c=o.length;l<c;l++){var u=o[l];if(!(u instanceof EpsilonSegment)){var h=u.generate(n,s);if(null==h){if(!u.optional)throw new Error("A value is required for route parameter '"+u.name+"' in route '"+e+"'.")}else a+="/",a+=h}}for(var d in"/"!==a.charAt(0)&&(a="/"+a),s)delete n[d];var p=buildQueryString(n);return a+=p?"?"+p:""},e.prototype.recognize=function(e){var t=[this.rootState],i={},r=!1,n=e,o=n.indexOf("?");if(-1!==o){var s=n.substr(o+1,n.length);n=n.substr(0,o),i=parseQueryString(s)}"/"!==(n=decodeURI(n)).charAt(0)&&(n="/"+n);var a=n.length;a>1&&"/"===n.charAt(a-1)&&(n=n.substr(0,a-1),r=!0);for(var l=0,c=n.length;l<c&&(t=recognizeChar(t,n.charAt(l))).length;l++);for(var u=[],h=0,d=t.length;h<d;h++)t[h].handlers&&u.push(t[h]);t=sortSolutions(u);var p=u[0];if(p&&p.handlers)return r&&"(.+)$"===p.regex.source.slice(-5)&&(n+="/"),findHandler(p,n,i)},e}(),RecognizeResults=function(e){this.splice=Array.prototype.splice,this.slice=Array.prototype.slice,this.push=Array.prototype.push,this.length=0,this.queryParams=e||{}};function parse(e,t,i,r){var n=e;"/"===e.charAt(0)&&(n=e.substr(1));for(var o=[],s=n.split("/"),a=0,l=s.length;a<l;++a){var c=s[a],u=c.match(/^:([^?]+)(\?)?$/);if(u){var h=u,d=h[1],p=h[2];if(-1!==d.indexOf("="))throw new Error("Parameter "+d+" in route "+e+" has a default value, which is not supported.");o.push(new DynamicSegment(d,!!p)),t.push(d),i.dynamics++}else(u=c.match(/^\*(.+)$/))?(o.push(new StarSegment(u[1])),t.push(u[1]),i.stars++):""===c?o.push(new EpsilonSegment):(o.push(new StaticSegment(c,r)),i.statics++)}return o}function sortSolutions(e){return e.sort(function(e,t){if(e.types.stars!==t.types.stars)return e.types.stars-t.types.stars;if(e.types.stars){if(e.types.statics!==t.types.statics)return t.types.statics-e.types.statics;if(e.types.dynamics!==t.types.dynamics)return t.types.dynamics-e.types.dynamics}return e.types.dynamics!==t.types.dynamics?e.types.dynamics-t.types.dynamics:e.types.statics!==t.types.statics?t.types.statics-e.types.statics:0})}function recognizeChar(e,t){for(var i=[],r=0,n=e.length;r<n;r++){var o=e[r];i.push.apply(i,o.match(t))}return i}function findHandler(e,t,i){for(var r=e.handlers,n=e.regex,o=t.match(n),s=1,a=new RecognizeResults(i),l=0,c=r.length;l<c;l++){for(var u=r[l],h=u.names,d={},p=0,f=h.length;p<f;p++)d[h[p]]=o[s++];a.push({handler:u.handler,params:d,isDynamic:!!h.length})}return a}function addSegment(e,t){var i=e.put({validChars:"/"}),r=i;return t.eachChar(function(e){r=r.put(e)}),[i,r]}function _normalizeAbsolutePath(e,t,i=!1){return t||"#"===e[0]||(e="#"+e),t&&i&&(e=e.substring(1,e.length)),e}function _createRootedPath(e,t,i,r){if(isAbsoluteUrl.test(e))return e;let n="";return t.length&&"/"!==t[0]&&(n+="/"),(n+=t).length&&"/"===n[n.length-1]||"/"===e[0]||(n+="/"),n.length&&"/"===n[n.length-1]&&"/"===e[0]&&(n=n.substring(0,n.length-1)),_normalizeAbsolutePath(n+e,i,r)}function _resolveUrl(e,t,i){return isRootedPath.test(e)?_normalizeAbsolutePath(e,i):_createRootedPath(e,t,i)}function _ensureArrayWithSingleRoutePerConfig(e){let t=[];if(Array.isArray(e.route))for(let i=0,r=e.route.length;i<r;++i){let r=Object.assign({},e);r.route=e.route[i],t.push(r)}else t.push(Object.assign({},e));return t}const isRootedPath=/^#?\//,isAbsoluteUrl=/^([a-z][a-z0-9+\-.]*:)?\/\//i;let CommitChangesStep=class{run(e,t){return e._commitChanges(!0).then(()=>(e._updateTitle(),t()))}},NavigationInstruction=class{constructor(e){this.plan=null,this.options={},Object.assign(this,e),this.params=this.params||{},this.viewPortInstructions={};let t=[],i=this;do{let e=Object.assign({},i.params);i.config&&i.config.hasChildRouter&&delete e[i.getWildCardName()],t.unshift(e),i=i.parentInstruction}while(i);let r=Object.assign({},this.queryParams,...t);this.lifecycleArgs=[r,this.config,this]}getAllInstructions(){let e=[this];for(let t in this.viewPortInstructions){let i=this.viewPortInstructions[t].childNavigationInstruction;i&&e.push(...i.getAllInstructions())}return e}getAllPreviousInstructions(){return this.getAllInstructions().map(e=>e.previousInstruction).filter(e=>e)}addViewPortInstruction(e,t,i,r){const n=Object.assign({},this.lifecycleArgs[1],{currentViewPort:e});return this.viewPortInstructions[e]={name:e,strategy:t,moduleId:i,component:r,childRouter:r.childRouter,lifecycleArgs:[].concat(this.lifecycleArgs[0],n,this.lifecycleArgs[2])}}getWildCardName(){let e=this.config.route.lastIndexOf("*");return this.config.route.substr(e+1)}getWildcardPath(){let e=this.getWildCardName(),t=this.params[e]||"";return this.queryString&&(t+="?"+this.queryString),t}getBaseUrl(){let e=decodeURI(this.fragment);if(""===e){let t=this.router.routes.find(e=>e.name===this.config.name&&""!==e.route);t&&(e=t.route)}if(!this.params)return encodeURI(e);let t=this.getWildCardName(),i=this.params[t]||"";return i?encodeURI(e.substr(0,e.lastIndexOf(i))):encodeURI(e)}_commitChanges(e){let t=this.router;t.currentInstruction=this,this.previousInstruction&&(this.previousInstruction.config.navModel.isActive=!1),this.config.navModel.isActive=!0,t.refreshNavigation();let i=[],r=[];for(let n in this.viewPortInstructions){let o=this.viewPortInstructions[n],s=t.viewPorts[n];if(!s)throw new Error(`There was no router-view found in the view for ${o.moduleId}.`);o.strategy===activationStrategy.replace?o.childNavigationInstruction&&o.childNavigationInstruction.parentCatchHandler?i.push(o.childNavigationInstruction._commitChanges(e)):(e&&r.push({viewPort:s,viewPortInstruction:o}),i.push(s.process(o,e).then(t=>{if(o.childNavigationInstruction)return o.childNavigationInstruction._commitChanges(e)}))):o.childNavigationInstruction&&i.push(o.childNavigationInstruction._commitChanges(e))}return Promise.all(i).then(()=>(r.forEach(e=>e.viewPort.swap(e.viewPortInstruction)),null)).then(()=>prune(this))}_updateTitle(){let e=this._buildTitle(this.router.titleSeparator);e&&this.router.history.setTitle(e)}_buildTitle(e=" | "){let t="",i=[];this.config.navModel.title&&(t=this.router.transformTitle(this.config.navModel.title));for(let t in this.viewPortInstructions){let r=this.viewPortInstructions[t];if(r.childNavigationInstruction){let t=r.childNavigationInstruction._buildTitle(e);t&&i.push(t)}}return i.length&&(t=i.join(e)+(t?e:"")+t),this.router.title&&(t+=(t?e:"")+this.router.transformTitle(this.router.title)),t}};function prune(e){e.previousInstruction=null,e.plan=null}let NavModel=class{constructor(e,t){this.isActive=!1,this.title=null,this.href=null,this.relativeHref=null,this.settings={},this.config=null,this.router=e,this.relativeHref=t}setTitle(e){this.title=e,this.isActive&&this.router.updateTitle()}};function isNavigationCommand(e){return e&&"function"==typeof e.navigate}let Redirect=class{constructor(e,t={}){this.url=e,this.options=Object.assign({trigger:!0,replace:!0},t),this.shouldContinueProcessing=!1}setRouter(e){this.router=e}navigate(e){(this.options.useAppRouter?e:this.router||e).navigate(this.url,this.options)}},RedirectToRoute=class{constructor(e,t={},i={}){this.route=e,this.params=t,this.options=Object.assign({trigger:!0,replace:!0},i),this.shouldContinueProcessing=!1}setRouter(e){this.router=e}navigate(e){(this.options.useAppRouter?e:this.router||e).navigateToRoute(this.route,this.params,this.options)}};const pipelineStatus={completed:"completed",canceled:"canceled",rejected:"rejected",running:"running"};let Pipeline=class{constructor(){this.steps=[]}addStep(e){let t;if("function"==typeof e)t=e;else{if("function"==typeof e.getSteps){let t=e.getSteps();for(let e=0,i=t.length;e<i;e++)this.addStep(t[e]);return this}t=e.run.bind(e)}return this.steps.push(t),this}run(e){let t=-1,i=this.steps;function r(){if(!(++t<i.length))return r.complete();{let n=i[t];try{return n(e,r)}catch(e){return r.reject(e)}}}return r.complete=createCompletionHandler(r,pipelineStatus.completed),r.cancel=createCompletionHandler(r,pipelineStatus.canceled),r.reject=createCompletionHandler(r,pipelineStatus.rejected),r()}};function createCompletionHandler(e,t){return e=>Promise.resolve({status:t,output:e,completed:t===pipelineStatus.completed})}let RouterConfiguration=class{constructor(){this.instructions=[],this.options={},this.pipelineSteps=[]}addPipelineStep(e,t){if(null==t)throw new Error("Pipeline step cannot be null or undefined.");return this.pipelineSteps.push({name:e,step:t}),this}addAuthorizeStep(e){return this.addPipelineStep("authorize",e)}addPreActivateStep(e){return this.addPipelineStep("preActivate",e)}addPreRenderStep(e){return this.addPipelineStep("preRender",e)}addPostRenderStep(e){return this.addPipelineStep("postRender",e)}fallbackRoute(e){return this._fallbackRoute=e,this}map(e){return Array.isArray(e)?(e.forEach(this.map.bind(this)),this):this.mapRoute(e)}useViewPortDefaults(e){return this.viewPortDefaults=e,this}mapRoute(e){return this.instructions.push(t=>{let i,r=_ensureArrayWithSingleRoutePerConfig(e);for(let e=0,n=r.length;e<n;++e){let n=r[e];n.settings=n.settings||{},i||(i=t.createNavModel(n)),t.addRoute(n,i)}}),this}mapUnknownRoutes(e){return this.unknownRouteConfig=e,this}exportToRouter(e){let t=this.instructions;for(let i=0,r=t.length;i<r;++i)t[i](e);this.title&&(e.title=this.title),this.titleSeparator&&(e.titleSeparator=this.titleSeparator),this.unknownRouteConfig&&e.handleUnknownRoutes(this.unknownRouteConfig),this._fallbackRoute&&(e.fallbackRoute=this._fallbackRoute),this.viewPortDefaults&&e.useViewPortDefaults(this.viewPortDefaults),Object.assign(e.options,this.options);let i=this.pipelineSteps;if(i.length){if(!e.isRoot)throw new Error("Pipeline steps can only be added to the root router");let t=e.pipelineProvider;for(let e=0,r=i.length;e<r;++e){let{name:r,step:n}=i[e];t.addStep(r,n)}}}};const activationStrategy={noChange:"no-change",invokeLifecycle:"invoke-lifecycle",replace:"replace"};let BuildNavigationPlanStep=class{run(e,t){return _buildNavigationPlan(e).then(i=>i instanceof Redirect?t.cancel(i):(e.plan=i,t())).catch(t.cancel)}};function _buildNavigationPlan(e,t){let i=e.config;if("redirect"in i){let t=e.router;return t._createNavigationInstruction(i.redirect).then(i=>{let r={};for(let t in i.params){let n=i.params[t];"string"==typeof n&&":"===n[0]?(n=n.slice(1))in e.params&&(r[t]=e.params[n]):r[t]=i.params[t]}let n=t.generate(i.config.name,r,e.options);return e.queryString&&(n+="?"+e.queryString),Promise.resolve(new Redirect(n))})}let r=e.previousInstruction,n={},o=e.router.viewPortDefaults;if(r){let s=hasDifferentParameterValues(r,e),a=[];for(let l in r.viewPortInstructions){let c=r.viewPortInstructions[l],u=l in i.viewPorts?i.viewPorts[l]:c;null===u.moduleId&&l in e.router.viewPortDefaults&&(u=o[l]);let h=n[l]={name:l,config:u,prevComponent:c.component,prevModuleId:c.moduleId};if(c.moduleId!==u.moduleId?h.strategy=activationStrategy.replace:"determineActivationStrategy"in c.component.viewModel?h.strategy=c.component.viewModel.determineActivationStrategy(...e.lifecycleArgs):i.activationStrategy?h.strategy=i.activationStrategy:h.strategy=s||t?activationStrategy.invokeLifecycle:activationStrategy.noChange,h.strategy!==activationStrategy.replace&&c.childRouter){let t=e.getWildcardPath(),i=c.childRouter._createNavigationInstruction(t,e).then(e=>(h.childNavigationInstruction=e,_buildNavigationPlan(e,h.strategy===activationStrategy.invokeLifecycle).then(t=>{if(t instanceof Redirect)return Promise.reject(t);e.plan=t})));a.push(i)}}return Promise.all(a).then(()=>n)}for(let t in i.viewPorts){let r=i.viewPorts[t];null===r.moduleId&&t in e.router.viewPortDefaults&&(r=o[t]),n[t]={name:t,strategy:activationStrategy.replace,config:r}}return Promise.resolve(n)}function hasDifferentParameterValues(e,t){let i=e.params,r=t.params,n=t.config.hasChildRouter?t.getWildCardName():null;for(let e in r)if(e!==n&&i[e]!==r[e])return!0;for(let e in i)if(e!==n&&i[e]!==r[e])return!0;if(!t.options.compareQueryParams)return!1;let o=e.queryParams,s=t.queryParams;for(let e in s)if(o[e]!==s[e])return!0;for(let e in o)if(o[e]!==s[e])return!0;return!1}let Router=class e{constructor(e,t){this.parent=null,this.options={},this.viewPortDefaults={},this.transformTitle=(e=>this.parent?this.parent.transformTitle(e):e),this.container=e,this.history=t,this.reset()}reset(){this.viewPorts={},this.routes=[],this.baseUrl="",this.isConfigured=!1,this.isNavigating=!1,this.isExplicitNavigation=!1,this.isExplicitNavigationBack=!1,this.isNavigatingFirst=!1,this.isNavigatingNew=!1,this.isNavigatingRefresh=!1,this.isNavigatingForward=!1,this.isNavigatingBack=!1,this.couldDeactivate=!1,this.navigation=[],this.currentInstruction=null,this.viewPortDefaults={},this._fallbackOrder=100,this._recognizer=new RouteRecognizer,this._childRecognizer=new RouteRecognizer,this._configuredPromise=new Promise(e=>{this._resolveConfiguredPromise=e})}get isRoot(){return!this.parent}registerViewPort(e,t){t=t||"default",this.viewPorts[t]=e}ensureConfigured(){return this._configuredPromise}configure(e){this.isConfigured=!0;let t,i=e;return"function"==typeof e&&(i=e(t=new RouterConfiguration)),Promise.resolve(i).then(e=>{e&&e.exportToRouter&&(t=e),t.exportToRouter(this),this.isConfigured=!0,this._resolveConfiguredPromise()})}navigate(e,t){return!this.isConfigured&&this.parent?this.parent.navigate(e,t):(this.isExplicitNavigation=!0,this.history.navigate(_resolveUrl(e,this.baseUrl,this.history._hasPushState),t))}navigateToRoute(e,t,i){let r=this.generate(e,t);return this.navigate(r,i)}navigateBack(){this.isExplicitNavigationBack=!0,this.history.navigateBack()}createChild(t){let i=new e(t||this.container.createChild(),this.history);return i.parent=this,i}generate(e,t,i={}){let r=this._recognizer.hasRoute(e);if((!this.isConfigured||!r)&&this.parent)return this.parent.generate(e,t,i);if(!r)throw new Error(`A route with name '${e}' could not be found. Check that \`name: '${e}'\` was specified in the route's config.`);let n=_createRootedPath(this._recognizer.generate(e,t),this.baseUrl,this.history._hasPushState,i.absolute);return i.absolute?`${this.history.getAbsoluteRoot()}${n}`:n}createNavModel(e){let t=new NavModel(this,"href"in e?e.href:e.route);return t.title=e.title,t.order=e.nav,t.href=e.href,t.settings=e.settings,t.config=e,t}addRoute(e,t){if(Array.isArray(e.route)){return void _ensureArrayWithSingleRoutePerConfig(e).forEach(this.addRoute.bind(this))}validateRouteConfig(e,this.routes),"viewPorts"in e||e.navigationStrategy||(e.viewPorts={default:{moduleId:e.moduleId,view:e.view}}),t||(t=this.createNavModel(e)),this.routes.push(e);let i=e.route;"/"===i.charAt(0)&&(i=i.substr(1));let r=!0===e.caseSensitive,n=this._recognizer.add({path:i,handler:e,caseSensitive:r});if(i){let n=e.settings;delete e.settings;let o=JSON.parse(JSON.stringify(e));e.settings=n,o.route=`${i}/*childRoute`,o.hasChildRouter=!0,this._childRecognizer.add({path:o.route,handler:o,caseSensitive:r}),o.navModel=t,o.settings=e.settings,o.navigationStrategy=e.navigationStrategy}if(e.navModel=t,(t.order||0===t.order)&&-1===this.navigation.indexOf(t)){if(!t.href&&""!==t.href&&(n.types.dynamics||n.types.stars))throw new Error('Invalid route config for "'+e.route+'" : dynamic routes must specify an "href:" to be included in the navigation model.');"number"!=typeof t.order&&(t.order=++this._fallbackOrder),this.navigation.push(t),this.navigation=this.navigation.sort((e,t)=>e.order-t.order)}}hasRoute(e){return!!(this._recognizer.hasRoute(e)||this.parent&&this.parent.hasRoute(e))}hasOwnRoute(e){return this._recognizer.hasRoute(e)}handleUnknownRoutes(e){if(!e)throw new Error("Invalid unknown route handler");this.catchAllHandler=(t=>this._createRouteConfig(e,t).then(e=>(t.config=e,t)))}updateTitle(){if(this.parent)return this.parent.updateTitle();this.currentInstruction&&this.currentInstruction._updateTitle()}refreshNavigation(){let e=this.navigation;for(let t=0,i=e.length;t<i;t++){let i=e[t];i.config.href?i.href=_normalizeAbsolutePath(i.config.href,this.history._hasPushState):i.href=_createRootedPath(i.relativeHref,this.baseUrl,this.history._hasPushState)}}useViewPortDefaults(e){for(let t in e){let i=e[t];this.viewPortDefaults[t]={moduleId:i.moduleId}}}_refreshBaseUrl(){this.parent&&(this.baseUrl=generateBaseUrl(this.parent,this.parent.currentInstruction))}_createNavigationInstruction(e="",t=null){let i=e,r="",n=e.indexOf("?");-1!==n&&(i=e.substr(0,n),r=e.substr(n+1));let o=this._recognizer.recognize(e);o&&o.length||(o=this._childRecognizer.recognize(e));let s,a={fragment:i,queryString:r,config:null,parentInstruction:t,previousInstruction:this.currentInstruction,router:this,options:{compareQueryParams:this.options.compareQueryParams}};if(o&&o.length){let e=o[0],t=new NavigationInstruction(Object.assign({},a,{params:e.params,queryParams:e.queryParams||o.queryParams,config:e.config||e.handler}));s="function"==typeof e.handler?evaluateNavigationStrategy(t,e.handler,e):e.handler&&"function"==typeof e.handler.navigationStrategy?evaluateNavigationStrategy(t,e.handler.navigationStrategy,e.handler):Promise.resolve(t)}else if(this.catchAllHandler){s=evaluateNavigationStrategy(new NavigationInstruction(Object.assign({},a,{params:{path:i},queryParams:o?o.queryParams:{},config:null})),this.catchAllHandler)}else if(this.parent){let e=this._parentCatchAllHandler(this.parent);if(e){let r=this._findParentInstructionFromRouter(e,t);s=evaluateNavigationStrategy(new NavigationInstruction(Object.assign({},a,{params:{path:i},queryParams:o?o.queryParams:{},router:e,parentInstruction:r,parentCatchHandler:!0,config:null})),e.catchAllHandler)}}return s&&t&&(this.baseUrl=generateBaseUrl(this.parent,t)),s||Promise.reject(new Error(`Route not found: ${e}`))}_findParentInstructionFromRouter(e,t){return t.router===e?(t.fragment=e.baseUrl,t):t.parentInstruction?this._findParentInstructionFromRouter(e,t.parentInstruction):void 0}_parentCatchAllHandler(e){return e.catchAllHandler?e:!!e.parent&&this._parentCatchAllHandler(e.parent)}_createRouteConfig(e,t){return Promise.resolve(e).then(e=>"string"==typeof e?{moduleId:e}:"function"==typeof e?e(t):e).then(e=>"string"==typeof e?{moduleId:e}:e).then(e=>(e.route=t.params.path,validateRouteConfig(e,this.routes),e.navModel||(e.navModel=this.createNavModel(e)),e))}};function generateBaseUrl(e,t){return`${e.baseUrl||""}${t.getBaseUrl()||""}`}function validateRouteConfig(e,t){if("object"!=typeof e)throw new Error("Invalid Route Config");if("string"!=typeof e.route){let t=e.name||"(no name)";throw new Error('Invalid Route Config for "'+t+'": You must specify a "route:" pattern.')}if(!("redirect"in e||e.moduleId||e.navigationStrategy||e.viewPorts))throw new Error('Invalid Route Config for "'+e.route+'": You must specify a "moduleId:", "redirect:", "navigationStrategy:", or "viewPorts:".')}function evaluateNavigationStrategy(e,t,i){return Promise.resolve(t.call(i,e)).then(()=>("viewPorts"in e.config||(e.config.viewPorts={default:{moduleId:e.config.moduleId}}),e))}let CanDeactivatePreviousStep=class{run(e,t){return processDeactivatable(e,"canDeactivate",t)}},CanActivateNextStep=class{run(e,t){return processActivatable(e,"canActivate",t)}},DeactivatePreviousStep=class{run(e,t){return processDeactivatable(e,"deactivate",t,!0)}},ActivateNextStep=class{run(e,t){return processActivatable(e,"activate",t,!0)}};function processDeactivatable(e,t,i,r){let n=findDeactivatable(e.plan,t),o=n.length;function s(e){return r||shouldContinue(e)?a():i.cancel(e)}function a(){if(o--)try{return processPotential(n[o][t](e),s,i.cancel)}catch(e){return i.cancel(e)}return e.router.couldDeactivate=!0,i()}return a()}function findDeactivatable(e,t,i=[]){for(let r in e){let n=e[r],o=n.prevComponent;if((n.strategy===activationStrategy.invokeLifecycle||n.strategy===activationStrategy.replace)&&o){let e=o.viewModel;t in e&&i.push(e)}n.strategy===activationStrategy.replace&&o?addPreviousDeactivatable(o,t,i):n.childNavigationInstruction&&findDeactivatable(n.childNavigationInstruction.plan,t,i)}return i}function addPreviousDeactivatable(e,t,i){let r=e.childRouter;if(r&&r.currentInstruction){let e=r.currentInstruction.viewPortInstructions;for(let r in e){let n=e[r].component,o=n.viewModel;t in o&&i.push(o),addPreviousDeactivatable(n,t,i)}}}function processActivatable(e,t,i,r){let n=findActivatable(e,t),o=n.length,s=-1;function a(){if(++s<o)try{let e=n[s];return processPotential(e.viewModel[t](...e.lifecycleArgs),t=>(function(e,t){return r||shouldContinue(e,t)?a():i.cancel(e)})(t,e.router),i.cancel)}catch(e){return i.cancel(e)}return i()}return a()}function findActivatable(e,t,i=[],r){let n=e.plan;return Object.keys(n).filter(o=>{let s=n[o],a=e.viewPortInstructions[o],l=a.component.viewModel;(s.strategy===activationStrategy.invokeLifecycle||s.strategy===activationStrategy.replace)&&t in l&&i.push({viewModel:l,lifecycleArgs:a.lifecycleArgs,router:r}),s.childNavigationInstruction&&findActivatable(s.childNavigationInstruction,t,i,a.component.childRouter||r)}),i}function shouldContinue(e,t){return!(e instanceof Error)&&(isNavigationCommand(e)?("function"==typeof e.setRouter&&e.setRouter(t),!!e.shouldContinueProcessing):void 0===e||e)}let SafeSubscription=class{constructor(e){this._subscribed=!0,this._subscription=e(this),this._subscribed||this.unsubscribe()}get subscribed(){return this._subscribed}unsubscribe(){this._subscribed&&this._subscription&&this._subscription.unsubscribe(),this._subscribed=!1}};function processPotential(e,t,i){if(e&&"function"==typeof e.then)return Promise.resolve(e).then(t).catch(i);if(e&&"function"==typeof e.subscribe){let r=e;return new SafeSubscription(n=>r.subscribe({next(){n.subscribed&&(n.unsubscribe(),t(e))},error(e){n.subscribed&&(n.unsubscribe(),i(e))},complete(){n.subscribed&&(n.unsubscribe(),t(e))}}))}try{return t(e)}catch(e){return i(e)}}let RouteLoader=class{loadRoute(e,t,i){throw Error('Route loaders must implement "loadRoute(router, config, navigationInstruction)".')}},LoadRouteStep=class{static inject(){return[RouteLoader]}constructor(e){this.routeLoader=e}run(e,t){return loadNewRoute(this.routeLoader,e).then(t).catch(t.cancel)}};function loadNewRoute(e,t){let i=determineWhatToLoad(t).map(t=>loadRoute(e,t.navigationInstruction,t.viewPortPlan));return Promise.all(i)}function determineWhatToLoad(e,t=[]){let i=e.plan;for(let r in i){let n=i[r];if(n.strategy===activationStrategy.replace)t.push({viewPortPlan:n,navigationInstruction:e}),n.childNavigationInstruction&&determineWhatToLoad(n.childNavigationInstruction,t);else{let i=e.addViewPortInstruction(r,n.strategy,n.prevModuleId,n.prevComponent);n.childNavigationInstruction&&(i.childNavigationInstruction=n.childNavigationInstruction,determineWhatToLoad(n.childNavigationInstruction,t))}}return t}function loadRoute(e,t,i){let r=i.config?i.config.moduleId:null;return loadComponent(e,t,i.config).then(n=>{let o=t.addViewPortInstruction(i.name,i.strategy,r,n),s=n.childRouter;if(s){let r=t.getWildcardPath();return s._createNavigationInstruction(r,t).then(t=>(i.childNavigationInstruction=t,_buildNavigationPlan(t).then(i=>i instanceof Redirect?Promise.reject(i):(t.plan=i,o.childNavigationInstruction=t,loadNewRoute(e,t)))))}})}function loadComponent(e,t,i){let r=t.router,n=t.lifecycleArgs;return e.loadRoute(r,i,t).then(e=>{let{viewModel:t,childContainer:o}=e;if(e.router=r,e.config=i,"configureRouter"in t){let i=o.getChildRouter();return e.childRouter=i,i.configure(e=>t.configureRouter(e,i,...n)).then(()=>e)}return e})}let PipelineSlot=class{constructor(e,t,i){this.steps=[],this.container=e,this.slotName=t,this.slotAlias=i}getSteps(){return this.steps.map(e=>this.container.get(e))}},PipelineProvider=class{static inject(){return[Container]}constructor(e){this.container=e,this.steps=[BuildNavigationPlanStep,CanDeactivatePreviousStep,LoadRouteStep,this._createPipelineSlot("authorize"),CanActivateNextStep,this._createPipelineSlot("preActivate","modelbind"),DeactivatePreviousStep,ActivateNextStep,this._createPipelineSlot("preRender","precommit"),CommitChangesStep,this._createPipelineSlot("postRender","postcomplete")]}createPipeline(e=!0){let t=new Pipeline;return this.steps.forEach(i=>{(e||i!==CanDeactivatePreviousStep)&&t.addStep(this.container.get(i))}),t}_findStep(e){return this.steps.find(t=>t.slotName===e||t.slotAlias===e)}addStep(e,t){let i=this._findStep(e);if(!i)throw new Error(`Invalid pipeline slot name: ${e}.`);i.steps.includes(t)||i.steps.push(t)}removeStep(e,t){let i=this._findStep(e);i&&i.steps.splice(i.steps.indexOf(t),1)}_clearSteps(e=""){let t=this._findStep(e);t&&(t.steps=[])}reset(){this._clearSteps("authorize"),this._clearSteps("preActivate"),this._clearSteps("preRender"),this._clearSteps("postRender")}_createPipelineSlot(e,t){return new PipelineSlot(this.container,e,t)}};const logger$4=getLogger("app-router");let AppRouter=class extends Router{static inject(){return[Container,History,PipelineProvider,EventAggregator]}constructor(e,t,i,r){super(e,t),this.pipelineProvider=i,this.events=r}reset(){super.reset(),this.maxInstructionCount=10,this._queue?this._queue.length=0:this._queue=[]}loadUrl(e){return this._createNavigationInstruction(e).then(e=>this._queueInstruction(e)).catch(e=>{logger$4.error(e),restorePreviousLocation(this)})}registerViewPort(e,t){if(super.registerViewPort(e,t),this.isActive)this._dequeueInstruction();else{let t=this._findViewModel(e);if("configureRouter"in t){if(!this.isConfigured){let e=this._resolveConfiguredPromise;return this._resolveConfiguredPromise=(()=>{}),this.configure(e=>t.configureRouter(e,this)).then(()=>{this.activate(),e()})}}else this.activate()}return Promise.resolve()}activate(e){this.isActive||(this.isActive=!0,this.options=Object.assign({routeHandler:this.loadUrl.bind(this)},this.options,e),this.history.activate(this.options),this._dequeueInstruction())}deactivate(){this.isActive=!1,this.history.deactivate()}_queueInstruction(e){return new Promise(t=>{e.resolve=t,this._queue.unshift(e),this._dequeueInstruction()})}_dequeueInstruction(e=0){return Promise.resolve().then(()=>{if(this.isNavigating&&!e)return;let t=this._queue.shift();if(this._queue.length=0,!t)return;this.isNavigating=!0;let i=this.history.getState("NavigationTracker");if(i||this.currentNavigationTracker?i?this.currentNavigationTracker?this.currentNavigationTracker<i?this.isNavigatingForward=!0:this.currentNavigationTracker>i&&(this.isNavigatingBack=!0):this.isNavigatingRefresh=!0:this.isNavigatingNew=!0:(this.isNavigatingFirst=!0,this.isNavigatingNew=!0),i||(i=Date.now(),this.history.setState("NavigationTracker",i)),this.currentNavigationTracker=i,t.previousInstruction=this.currentInstruction,e){if(e===this.maxInstructionCount-1)return logger$4.error(`${e+1} navigation instructions have been attempted without success. Restoring last known good location.`),restorePreviousLocation(this),this._dequeueInstruction(e+1);if(e>this.maxInstructionCount)throw new Error("Maximum navigation attempts exceeded. Giving up.")}else this.events.publish("router:navigation:processing",{instruction:t});return this.pipelineProvider.createPipeline(!this.couldDeactivate).run(t).then(i=>processResult(t,i,e,this)).catch(e=>({output:e instanceof Error?e:new Error(e)})).then(i=>resolveInstruction(t,i,!!e,this))})}_findViewModel(e){if(this.container.viewModel)return this.container.viewModel;if(e.container){let t=e.container;for(;t;){if(t.viewModel)return this.container.viewModel=t.viewModel,t.viewModel;t=t.parent}}}};function processResult(e,t,i,r){t&&"completed"in t&&"output"in t||((t=t||{}).output=new Error(`Expected router pipeline to return a navigation result, but got [${JSON.stringify(t)}] instead.`));let n=null,o=null;return isNavigationCommand(t.output)?o=t.output.navigate(r):(n=t,t.completed||(t.output instanceof Error&&logger$4.error(t.output),restorePreviousLocation(r))),Promise.resolve(o).then(e=>r._dequeueInstruction(i+1)).then(e=>n||e||t)}function resolveInstruction(e,t,i,r){e.resolve(t);let n={instruction:e,result:t};if(i)r.events.publish("router:navigation:child:complete",n);else{let i;if(r.isNavigating=!1,r.isExplicitNavigation=!1,r.isExplicitNavigationBack=!1,r.isNavigatingFirst=!1,r.isNavigatingNew=!1,r.isNavigatingRefresh=!1,r.isNavigatingForward=!1,r.isNavigatingBack=!1,r.couldDeactivate=!1,t.output instanceof Error)i="error";else if(t.completed){let t=e.queryString?"?"+e.queryString:"";r.history.previousLocation=e.fragment+t,i="success"}else i="canceled";r.events.publish(`router:navigation:${i}`,n),r.events.publish("router:navigation:complete",n)}return t}function restorePreviousLocation(e){e.history.previousLocation?e.navigate(e.history.previousLocation,{trigger:!1,replace:!0}):e.fallbackRoute?e.navigate(e.fallbackRoute,{trigger:!0,replace:!0}):logger$4.error("Router navigation failed, and no previous location or fallbackRoute could be restored.")}var _dec$l,_class$m,_class2$8,_descriptor$3,_descriptor2$3,_descriptor3$3,_descriptor4$2;function _initDefineProp$3(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function _applyDecoratedDescriptor$3(e,t,i,r,n){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}let RouterView=(_dec$l=customElement("router-view"))(_class$m=noView((_descriptor$3=_applyDecoratedDescriptor$3((_class2$8=class{static inject(){return[DOM.Element,Container,ViewSlot,Router,ViewLocator,CompositionTransaction,CompositionEngine]}constructor(e,t,i,r,n,o,s){_initDefineProp$3(this,"swapOrder",_descriptor$3,this),_initDefineProp$3(this,"layoutView",_descriptor2$3,this),_initDefineProp$3(this,"layoutViewModel",_descriptor3$3,this),_initDefineProp$3(this,"layoutModel",_descriptor4$2,this),this.element=e,this.container=t,this.viewSlot=i,this.router=r,this.viewLocator=n,this.compositionTransaction=o,this.compositionEngine=s,this.router.registerViewPort(this,this.element.getAttribute("name")),"initialComposition"in o||(o.initialComposition=!0,this.compositionTransactionNotifier=o.enlist())}created(e){this.owningView=e}bind(e,t){this.container.viewModel=e,this.overrideContext=t}process(e,t){let i=e.component,r=i.childContainer,n=i.viewModel,o=i.viewModelResource,s=o.metadata,a=i.router.currentInstruction.config,l=a.viewPorts&&a.viewPorts[e.name]||{};r.get(RouterViewLocator)._notify(this);let c={viewModel:l.layoutViewModel||a.layoutViewModel||this.layoutViewModel,view:l.layoutView||a.layoutView||this.layoutView,model:l.layoutModel||a.layoutModel||this.layoutModel,router:e.component.router,childContainer:r,viewSlot:this.viewSlot},u=this.viewLocator.getViewStrategy(i.view||n);return u&&i.view&&u.makeRelativeTo(Origin.get(i.router.container.viewModel.constructor).moduleId),s.load(r,o.value,null,u,!0).then(i=>{if(this.compositionTransactionNotifier||(this.compositionTransactionOwnershipToken=this.compositionTransaction.tryCapture()),(c.viewModel||c.view)&&(e.layoutInstruction=c),e.controller=s.create(r,BehaviorInstruction.dynamic(this.element,n,i)),t)return null;this.swap(e)})}swap(e){let t=e.layoutInstruction,i=this.view,r=()=>{let e=SwapStrategies[this.swapOrder]||SwapStrategies.after,t=this.viewSlot;e(t,i,()=>Promise.resolve(t.add(this.view))).then(()=>{this._notify()})},n=t=>(e.controller.automate(this.overrideContext,t),this.compositionTransactionOwnershipToken?this.compositionTransactionOwnershipToken.waitForCompositionComplete().then(()=>(this.compositionTransactionOwnershipToken=null,r())):r());return t?(t.viewModel||(t.viewModel={}),this.compositionEngine.createController(t).then(i=>(ShadowDOM.distributeView(e.controller.view,i.slots||i.view.slots),i.automate(createOverrideContext(t.viewModel),this.owningView),i.view.children.push(e.controller.view),i.view||i)).then(e=>(this.view=e,n(e)))):(this.view=e.controller.view,n(this.owningView))}_notify(){this.compositionTransactionNotifier&&(this.compositionTransactionNotifier.done(),this.compositionTransactionNotifier=null)}}).prototype,"swapOrder",[bindable],{enumerable:!0,initializer:null}),_descriptor2$3=_applyDecoratedDescriptor$3(_class2$8.prototype,"layoutView",[bindable],{enumerable:!0,initializer:null}),_descriptor3$3=_applyDecoratedDescriptor$3(_class2$8.prototype,"layoutViewModel",[bindable],{enumerable:!0,initializer:null}),_descriptor4$2=_applyDecoratedDescriptor$3(_class2$8.prototype,"layoutModel",[bindable],{enumerable:!0,initializer:null}),_class$m=_class2$8))||_class$m)||_class$m,RouterViewLocator=class{constructor(){this.promise=new Promise(e=>this.resolve=e)}findNearest(){return this.promise}_notify(e){this.resolve(e)}};var _dec$m,_class$n,_dec2$b,_class2$9;let EmptyClass=(_dec$m=inlineView("<template></template>"))(_class$n=class{})||_class$n,TemplatingRouteLoader=(_dec2$b=inject(CompositionEngine))(_class2$9=class extends RouteLoader{constructor(e){super(),this.compositionEngine=e}loadRoute(e,t){let i,r=e.container.createChild(),n={viewModel:i=null===t.moduleId?EmptyClass:/\.html/i.test(t.moduleId)?createDynamicClass(t.moduleId):relativeToFile(t.moduleId,Origin.get(e.container.viewModel.constructor).moduleId),childContainer:r,view:t.view||t.viewStrategy,router:e};return r.registerSingleton(RouterViewLocator),r.getChildRouter=function(){let t;return r.registerHandler(Router,i=>t||(t=e.createChild(r))),r.get(Router)},this.compositionEngine.ensureViewModel(n)}})||_class2$9;function createDynamicClass(e){var t;return customElement(/([^\/^\?]+)\.html/i.exec(e)[1])(t=useView(e)(t=class{bind(e){this.$parent=e}})||t)||t}var _dec$n,_dec2$c,_dec3$5,_dec4$4,_class$o;const logger$5=getLogger("route-href");let RouteHref=(_dec$n=customAttribute("route-href"))(_class$o=(_dec2$c=bindable({name:"route",changeHandler:"processChange",primaryProperty:!0}))(_class$o=(_dec3$5=bindable({name:"params",changeHandler:"processChange"}))(_class$o=(_dec4$4=bindable({name:"attribute",defaultValue:"href"}))(_class$o=class{static inject(){return[Router,DOM.Element]}constructor(e,t){this.router=e,this.element=t}bind(){this.isActive=!0,this.processChange()}unbind(){this.isActive=!1}attributeChanged(e,t){t&&this.element.removeAttribute(t),this.processChange()}processChange(){return this.router.ensureConfigured().then(()=>{if(!this.isActive)return null;let e=this.router.generate(this.route,this.params);return this.element.au.controller?this.element.au.controller.viewModel[this.attribute]=e:this.element.setAttribute(this.attribute,e),null}).catch(e=>{logger$5.error(e)})}})||_class$o)||_class$o)||_class$o)||_class$o;function configure$5(e){e.singleton(RouteLoader,TemplatingRouteLoader).singleton(Router,AppRouter).globalResources(RouterView,RouteHref),e.container.registerAlias(Router,AppRouter)}function getTargetDOMElement(e,t){const i=e.target;if(i instanceof Element)return i;for(let r=0,n=t.controllers.length;r<n;r++){const n=t.controllers[r];if(n.viewModel===i){const t=n.container.get(DOM.Element);if(t)return t;throw new Error(`Unable to locate target element for "${e.sourceExpression}".`)}}throw new Error(`Unable to locate target element for "${e.sourceExpression}".`)}function getObject(e,t,i){const r=t.evaluate(i,null);if(null==r||r instanceof Object)return r;throw new Error(`The '${t}' part of '${e}' evaluates to ${r} instead of an object, null or undefined.`)}function getPropertyInfo(e,t){const i=e;for(;e instanceof BindingBehavior||e instanceof ValueConverter;)e=e.expression;let r,n;if(e instanceof AccessScope)r=getContextFor(e.name,t,e.ancestor),n=e.name;else if(e instanceof AccessMember)r=getObject(i,e.object,t),n=e.name;else{if(!(e instanceof AccessKeyed))throw new Error(`Expression '${i}' is not compatible with the validate binding-behavior.`);r=getObject(i,e.object,t),n=e.key.evaluate(t)}return null==r?null:{object:r,propertyName:n}}function isString(e){return"[object String]"===Object.prototype.toString.call(e)}function isNumber(e){return"[object Number]"===Object.prototype.toString.call(e)}class PropertyAccessorParser{constructor(e){this.parser=e}parse(e){if(isString(e)||isNumber(e))return e;const t=getAccessorExpression(e.toString()),i=this.parser.parse(t);if(i instanceof AccessScope||i instanceof AccessMember&&i.object instanceof AccessScope)return i.name;throw new Error(`Invalid property expression: "${i}"`)}}function getAccessorExpression(e){const t=/^function\s*\([$_\w\d]+\)\s*\{(?:\s*"use strict";)?\s*(?:[$_\w\d.['"\]+;]+)?\s*return\s+[$_\w\d]+\.([$_\w\d]+)\s*;?\s*\}$/.exec(e)||/^\(?[$_\w\d]+\)?\s*=>\s*[$_\w\d]+\.([$_\w\d]+)$/.exec(e);if(null===t)throw new Error(`Unable to parse accessor function:\n${e}`);return t[1]}function __decorate(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}var validateTrigger;PropertyAccessorParser.inject=[Parser],function(e){e[e.manual=0]="manual",e[e.blur=1]="blur",e[e.change=2]="change",e[e.changeOrBlur=3]="changeOrBlur"}(validateTrigger||(validateTrigger={}));class Validator{}class ValidateResult{constructor(e,t,i,r,n=null){this.rule=e,this.object=t,this.propertyName=i,this.valid=r,this.message=n,this.id=ValidateResult.nextId++}toString(){return this.valid?"Valid.":this.message}}ValidateResult.nextId=0;class ValidateEvent{constructor(e,t,i,r,n){this.type=e,this.errors=t,this.results=i,this.instruction=r,this.controllerValidateResult=n}}class ValidationController{constructor(e,t){this.validator=e,this.propertyParser=t,this.bindings=new Map,this.renderers=[],this.results=[],this.errors=[],this.validating=!1,this.elements=new Map,this.objects=new Map,this.validateTrigger=validateTrigger.blur,this.finishValidating=Promise.resolve(),this.eventCallbacks=[]}subscribe(e){return this.eventCallbacks.push(e),{dispose:()=>{const t=this.eventCallbacks.indexOf(e);-1!==t&&this.eventCallbacks.splice(t,1)}}}addObject(e,t){this.objects.set(e,t)}removeObject(e){this.objects.delete(e),this.processResultDelta("reset",this.results.filter(t=>t.object===e),[])}addError(e,t,i=null){let r;r=null===i?i:this.propertyParser.parse(i);const n=new ValidateResult({__manuallyAdded__:!0},t,r,!1,e);return this.processResultDelta("validate",[],[n]),n}removeError(e){-1!==this.results.indexOf(e)&&this.processResultDelta("reset",[e],[])}addRenderer(e){this.renderers.push(e),e.render({kind:"validate",render:this.results.map(e=>({result:e,elements:this.elements.get(e)})),unrender:[]})}removeRenderer(e){this.renderers.splice(this.renderers.indexOf(e),1),e.render({kind:"reset",render:[],unrender:this.results.map(e=>({result:e,elements:this.elements.get(e)}))})}registerBinding(e,t,i){this.bindings.set(e,{target:t,rules:i,propertyInfo:null})}unregisterBinding(e){this.resetBinding(e),this.bindings.delete(e)}getInstructionPredicate(e){if(e){const{object:t,propertyName:i,rules:r}=e;let n;return n=e.propertyName?e=>e.object===t&&e.propertyName===i:e=>e.object===t,r?e=>n(e)&&this.validator.ruleExists(r,e.rule):n}return()=>!0}validate(e){let t;if(e){let{object:i,propertyName:r,rules:n}=e;n=n||this.objects.get(i),t=void 0===e.propertyName?()=>this.validator.validateObject(i,n):()=>this.validator.validateProperty(i,r,n)}else t=(()=>{const e=[];for(const[t,i]of Array.from(this.objects))e.push(this.validator.validateObject(t,i));for(const[t,{rules:i}]of Array.from(this.bindings)){const r=getPropertyInfo(t.sourceExpression,t.source);r&&!this.objects.has(r.object)&&e.push(this.validator.validateProperty(r.object,r.propertyName,i))}return Promise.all(e).then(e=>e.reduce((e,t)=>e.concat(t),[]))});this.validating=!0;const i=this.finishValidating.then(t).then(t=>{const r=this.getInstructionPredicate(e),n=this.results.filter(r);this.processResultDelta("validate",n,t),i===this.finishValidating&&(this.validating=!1);const o={instruction:e,valid:void 0===t.find(e=>!e.valid),results:t};return this.invokeCallbacks(e,o),o}).catch(e=>(this.validating=!1,this.finishValidating=Promise.resolve(),Promise.reject(e)));return this.finishValidating=i,i}reset(e){const t=this.getInstructionPredicate(e),i=this.results.filter(t);this.processResultDelta("reset",i,[]),this.invokeCallbacks(e,null)}getAssociatedElements({object:e,propertyName:t}){const i=[];for(const[r,{target:n}]of Array.from(this.bindings)){const o=getPropertyInfo(r.sourceExpression,r.source);o&&o.object===e&&o.propertyName===t&&i.push(n)}return i}processResultDelta(e,t,i){const r={kind:e,render:[],unrender:[]};i=i.slice(0);for(const e of t){const t=this.elements.get(e);this.elements.delete(e),r.unrender.push({result:e,elements:t});const n=i.findIndex(t=>t.rule===e.rule&&t.object===e.object&&t.propertyName===e.propertyName);if(-1===n)this.results.splice(this.results.indexOf(e),1),e.valid||this.errors.splice(this.errors.indexOf(e),1);else{const t=i.splice(n,1)[0],o=this.getAssociatedElements(t);this.elements.set(t,o),r.render.push({result:t,elements:o}),this.results.splice(this.results.indexOf(e),1,t),!e.valid&&t.valid?this.errors.splice(this.errors.indexOf(e),1):e.valid||t.valid?t.valid||this.errors.push(t):this.errors.splice(this.errors.indexOf(e),1,t)}}for(const e of i){const t=this.getAssociatedElements(e);r.render.push({result:e,elements:t}),this.elements.set(e,t),this.results.push(e),e.valid||this.errors.push(e)}for(const e of this.renderers)e.render(r)}validateBinding(e){if(!e.isBound)return;const t=getPropertyInfo(e.sourceExpression,e.source);let i;const r=this.bindings.get(e);if(r&&(i=r.rules,r.propertyInfo=t),!t)return;const{object:n,propertyName:o}=t;this.validate({object:n,propertyName:o,rules:i})}resetBinding(e){const t=this.bindings.get(e);let i=getPropertyInfo(e.sourceExpression,e.source);if(!i&&t&&(i=t.propertyInfo),t&&(t.propertyInfo=null),!i)return;const{object:r,propertyName:n}=i;this.reset({object:r,propertyName:n})}changeTrigger(e){this.validateTrigger=e;const t=Array.from(this.bindings.keys());for(const e of t){const t=e.source;e.unbind(),e.bind(t)}}revalidateErrors(){for(const{object:e,propertyName:t,rule:i}of this.errors){if(i.__manuallyAdded__)continue;const r=[[i]];this.validate({object:e,propertyName:t,rules:r})}}invokeCallbacks(e,t){if(0===this.eventCallbacks.length)return;const i=new ValidateEvent(t?"validate":"reset",this.errors,this.results,e||null,t);for(let e=0;e<this.eventCallbacks.length;e++)this.eventCallbacks[e](i)}}ValidationController.inject=[Validator,PropertyAccessorParser];class ValidateBindingBehaviorBase{constructor(e){this.taskQueue=e}bind(e,t,i,r){const n=getTargetDOMElement(e,t);let o;if(i instanceof ValidationController?o=i:(o=t.container.get(Optional.of(ValidationController)),r=i),null===o)throw new Error("A ValidationController has not been registered.");o.registerBinding(e,n,r),e.validationController=o;const s=this.getValidateTrigger(o);s&validateTrigger.change&&(e.vbbUpdateSource=e.updateSource,e.updateSource=function(e){this.vbbUpdateSource(e),this.validationController.validateBinding(this)}),s&validateTrigger.blur&&(e.validateBlurHandler=(()=>{this.taskQueue.queueMicroTask(()=>o.validateBinding(e))}),e.validateTarget=n,n.addEventListener("blur",e.validateBlurHandler)),s!==validateTrigger.manual&&(e.standardUpdateTarget=e.updateTarget,e.updateTarget=function(e){this.standardUpdateTarget(e),this.validationController.resetBinding(this)})}unbind(e){e.vbbUpdateSource&&(e.updateSource=e.vbbUpdateSource,e.vbbUpdateSource=null),e.standardUpdateTarget&&(e.updateTarget=e.standardUpdateTarget,e.standardUpdateTarget=null),e.validateBlurHandler&&(e.validateTarget.removeEventListener("blur",e.validateBlurHandler),e.validateBlurHandler=null,e.validateTarget=null),e.validationController.unregisterBinding(e),e.validationController=null}}let ValidateBindingBehavior=class extends ValidateBindingBehaviorBase{getValidateTrigger(e){return e.validateTrigger}};ValidateBindingBehavior.inject=[TaskQueue],ValidateBindingBehavior=__decorate([bindingBehavior("validate")],ValidateBindingBehavior);let ValidateManuallyBindingBehavior=class extends ValidateBindingBehaviorBase{getValidateTrigger(){return validateTrigger.manual}};ValidateManuallyBindingBehavior.inject=[TaskQueue],ValidateManuallyBindingBehavior=__decorate([bindingBehavior("validateManually")],ValidateManuallyBindingBehavior);let ValidateOnBlurBindingBehavior=class extends ValidateBindingBehaviorBase{getValidateTrigger(){return validateTrigger.blur}};ValidateOnBlurBindingBehavior.inject=[TaskQueue],ValidateOnBlurBindingBehavior=__decorate([bindingBehavior("validateOnBlur")],ValidateOnBlurBindingBehavior);let ValidateOnChangeBindingBehavior=class extends ValidateBindingBehaviorBase{getValidateTrigger(){return validateTrigger.change}};ValidateOnChangeBindingBehavior.inject=[TaskQueue],ValidateOnChangeBindingBehavior=__decorate([bindingBehavior("validateOnChange")],ValidateOnChangeBindingBehavior);let ValidateOnChangeOrBlurBindingBehavior=class extends ValidateBindingBehaviorBase{getValidateTrigger(){return validateTrigger.changeOrBlur}};ValidateOnChangeOrBlurBindingBehavior.inject=[TaskQueue],ValidateOnChangeOrBlurBindingBehavior=__decorate([bindingBehavior("validateOnChangeOrBlur")],ValidateOnChangeOrBlurBindingBehavior);class ValidationControllerFactory{constructor(e){this.container=e}static get(e){return new ValidationControllerFactory(e)}create(e){e||(e=this.container.get(Validator));const t=this.container.get(PropertyAccessorParser);return new ValidationController(e,t)}createForCurrentScope(e){const t=this.create(e);return this.container.registerInstance(ValidationController,t),t}}ValidationControllerFactory["protocol:aurelia:resolver"]=!0;let ValidationErrorsCustomAttribute=class{constructor(e,t){this.boundaryElement=e,this.controllerAccessor=t,this.controller=null,this.errors=[],this.errorsInternal=[]}static inject(){return[DOM.Element,Lazy.of(ValidationController)]}sort(){this.errorsInternal.sort((e,t)=>e.targets[0]===t.targets[0]?0:2&e.targets[0].compareDocumentPosition(t.targets[0])?1:-1)}interestingElements(e){return e.filter(e=>this.boundaryElement.contains(e))}render(e){for(const{result:t}of e.unrender){const e=this.errorsInternal.findIndex(e=>e.error===t);-1!==e&&this.errorsInternal.splice(e,1)}for(const{result:t,elements:i}of e.render){if(t.valid)continue;const e=this.interestingElements(i);e.length&&this.errorsInternal.push({error:t,targets:e})}this.sort(),this.errors=this.errorsInternal}bind(){this.controller||(this.controller=this.controllerAccessor()),this.controller.addRenderer(this)}unbind(){this.controller&&this.controller.removeRenderer(this)}};__decorate([bindable({defaultBindingMode:bindingMode.oneWay})],ValidationErrorsCustomAttribute.prototype,"controller",void 0),__decorate([bindable({primaryProperty:!0,defaultBindingMode:bindingMode.twoWay})],ValidationErrorsCustomAttribute.prototype,"errors",void 0),ValidationErrorsCustomAttribute=__decorate([customAttribute("validation-errors")],ValidationErrorsCustomAttribute);let ValidationRendererCustomAttribute=class{created(e){this.container=e.container}bind(){this.controller=this.container.get(ValidationController),this.renderer=this.container.get(this.value),this.controller.addRenderer(this.renderer)}unbind(){this.controller.removeRenderer(this.renderer),this.controller=null,this.renderer=null}};ValidationRendererCustomAttribute=__decorate([customAttribute("validation-renderer")],ValidationRendererCustomAttribute);class Rules{static set(e,t){e instanceof Function&&(e=e.prototype),Object.defineProperty(e,Rules.key,{enumerable:!1,configurable:!1,writable:!0,value:t})}static unset(e){e instanceof Function&&(e=e.prototype),e[Rules.key]=null}static get(e){return e[Rules.key]||null}}Rules.key="__rules__";class ExpressionVisitor{visitChain(e){this.visitArgs(e.expressions)}visitBindingBehavior(e){e.expression.accept(this),this.visitArgs(e.args)}visitValueConverter(e){e.expression.accept(this),this.visitArgs(e.args)}visitAssign(e){e.target.accept(this),e.value.accept(this)}visitConditional(e){e.condition.accept(this),e.yes.accept(this),e.no.accept(this)}visitAccessThis(e){e.ancestor=e.ancestor}visitAccessScope(e){e.name=e.name}visitAccessMember(e){e.object.accept(this)}visitAccessKeyed(e){e.object.accept(this),e.key.accept(this)}visitCallScope(e){this.visitArgs(e.args)}visitCallFunction(e){e.func.accept(this),this.visitArgs(e.args)}visitCallMember(e){e.object.accept(this),this.visitArgs(e.args)}visitPrefix(e){e.expression.accept(this)}visitBinary(e){e.left.accept(this),e.right.accept(this)}visitLiteralPrimitive(e){e.value=e.value}visitLiteralArray(e){this.visitArgs(e.elements)}visitLiteralObject(e){this.visitArgs(e.values)}visitLiteralString(e){e.value=e.value}visitArgs(e){for(let t=0;t<e.length;t++)e[t].accept(this)}}class ValidationMessageParser{constructor(e){this.bindinqLanguage=e,this.emptyStringExpression=new LiteralString(""),this.nullExpression=new LiteralPrimitive(null),this.undefinedExpression=new LiteralPrimitive(void 0),this.cache={}}parse(e){if(void 0!==this.cache[e])return this.cache[e];const t=this.bindinqLanguage.parseInterpolation(null,e);if(null===t)return new LiteralString(e);let i=new LiteralString(t[0]);for(let e=1;e<t.length;e+=2)i=new Binary("+",i,new Binary("+",this.coalesce(t[e]),new LiteralString(t[e+1])));return MessageExpressionValidator.validate(i,e),this.cache[e]=i,i}coalesce(e){return new Conditional(new Binary("||",new Binary("===",e,this.nullExpression),new Binary("===",e,this.undefinedExpression)),this.emptyStringExpression,new CallMember(e,"toString",[]))}}ValidationMessageParser.inject=[BindingLanguage];class MessageExpressionValidator extends ExpressionVisitor{constructor(e){super(),this.originalMessage=e}static validate(e,t){const i=new MessageExpressionValidator(t);e.accept(i)}visitAccessScope(e){if(0!==e.ancestor)throw new Error("$parent is not permitted in validation message expressions.");-1!==["displayName","propertyName","value","object","config","getDisplayName"].indexOf(e.name)&&getLogger("aurelia-validation").warn(`Did you mean to use "$${e.name}" instead of "${e.name}" in this validation message template: "${this.originalMessage}"?`)}}const validationMessages={default:"${$displayName} is invalid.",required:"${$displayName} is required.",matches:"${$displayName} is not correctly formatted.",email:"${$displayName} is not a valid email.",minLength:"${$displayName} must be at least ${$config.length} character${$config.length === 1 ? '' : 's'}.",maxLength:"${$displayName} cannot be longer than ${$config.length} character${$config.length === 1 ? '' : 's'}.",minItems:"${$displayName} must contain at least ${$config.count} item${$config.count === 1 ? '' : 's'}.",maxItems:"${$displayName} cannot contain more than ${$config.count} item${$config.count === 1 ? '' : 's'}.",equals:"${$displayName} must be ${$config.expectedValue}."};class ValidationMessageProvider{constructor(e){this.parser=e}getMessage(e){let t;return t=e in validationMessages?validationMessages[e]:validationMessages.default,this.parser.parse(t)}getDisplayName(e,t){if(null!=t)return t instanceof Function?t():t;const i=e.toString().split(/(?=[A-Z])/).join(" ");return i.charAt(0).toUpperCase()+i.slice(1)}}ValidationMessageProvider.inject=[ValidationMessageParser];class StandardValidator extends Validator{constructor(e,t){super(),this.messageProvider=e,this.lookupFunctions=t.lookupFunctions,this.getDisplayName=e.getDisplayName.bind(e)}validateProperty(e,t,i){return this.validate(e,t,i||null)}validateObject(e,t){return this.validate(e,null,t||null)}ruleExists(e,t){let i=e.length;for(;i--;)if(-1!==e[i].indexOf(t))return!0;return!1}getMessage(e,t,i){const r=e.message||this.messageProvider.getMessage(e.messageKey);let{name:n,displayName:o}=e.property;null!==n&&(o=this.messageProvider.getDisplayName(n,o));const s={$displayName:o,$propertyName:n,$value:i,$object:t,$config:e.config,$getDisplayName:this.getDisplayName};return r.evaluate({bindingContext:t,overrideContext:s},this.lookupFunctions)}validateRuleSequence(e,t,i,r,n){const o=null==t,s=i[r];let a=!0;const l=[];for(let i=0;i<s.length;i++){const r=s[i];if(!o&&r.property.name!=t)continue;if(r.when&&!r.when(e))continue;const c=null===r.property.name?e:e[r.property.name];let u=r.condition(c,e);u instanceof Promise||(u=Promise.resolve(u)),l.push(u.then(t=>{const i=t?null:this.getMessage(r,e,c);return n.push(new ValidateResult(r,e,r.property.name,t,i)),a=a&&t,t}))}return Promise.all(l).then(()=>(r++,a&&r<i.length?this.validateRuleSequence(e,t,i,r,n):n))}validate(e,t,i){return i||(i=Rules.get(e)),i&&0!==i.length?this.validateRuleSequence(e,t,i,0,[]):Promise.resolve([])}}StandardValidator.inject=[ValidationMessageProvider,ViewResources];class FluentRuleCustomizer{constructor(e,t,i={},r,n,o){this.fluentEnsure=r,this.fluentRules=n,this.parsers=o,this.rule={property:e,condition:t,config:i,when:null,messageKey:"default",message:null,sequence:n.sequence},this.fluentEnsure._addRule(this.rule)}then(){return this.fluentRules.sequence++,this}withMessageKey(e){return this.rule.messageKey=e,this.rule.message=null,this}withMessage(e){return this.rule.messageKey="custom",this.rule.message=this.parsers.message.parse(e),this}when(e){return this.rule.when=e,this}tag(e){return this.rule.tag=e,this}ensure(e){return this.fluentEnsure.ensure(e)}ensureObject(){return this.fluentEnsure.ensureObject()}get rules(){return this.fluentEnsure.rules}on(e){return this.fluentEnsure.on(e)}satisfies(e,t){return this.fluentRules.satisfies(e,t)}satisfiesRule(e,...t){return this.fluentRules.satisfiesRule(e,...t)}required(){return this.fluentRules.required()}matches(e){return this.fluentRules.matches(e)}email(){return this.fluentRules.email()}minLength(e){return this.fluentRules.minLength(e)}maxLength(e){return this.fluentRules.maxLength(e)}minItems(e){return this.fluentRules.minItems(e)}maxItems(e){return this.fluentRules.maxItems(e)}equals(e){return this.fluentRules.equals(e)}}class FluentRules{constructor(e,t,i){this.fluentEnsure=e,this.parsers=t,this.property=i,this.sequence=0}displayName(e){return this.property.displayName=e,this}satisfies(e,t){return new FluentRuleCustomizer(this.property,e,t,this.fluentEnsure,this,this.parsers)}satisfiesRule(e,...t){let i=FluentRules.customRules[e];if(!i){if((i=this[e])instanceof Function)return i.call(this,...t);throw new Error(`Rule with name "${e}" does not exist.`)}const r=i.argsToConfig?i.argsToConfig(...t):void 0;return this.satisfies((e,r)=>i.condition.call(this,e,r,...t),r).withMessageKey(e)}required(){return this.satisfies(e=>null!=e&&!(isString(e)&&!/\S/.test(e))).withMessageKey("required")}matches(e){return this.satisfies(t=>null==t||0===t.length||e.test(t)).withMessageKey("matches")}email(){return this.matches(/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/).withMessageKey("email")}minLength(e){return this.satisfies(t=>null==t||0===t.length||t.length>=e,{length:e}).withMessageKey("minLength")}maxLength(e){return this.satisfies(t=>null==t||0===t.length||t.length<=e,{length:e}).withMessageKey("maxLength")}minItems(e){return this.satisfies(t=>null==t||t.length>=e,{count:e}).withMessageKey("minItems")}maxItems(e){return this.satisfies(t=>null==t||t.length<=e,{count:e}).withMessageKey("maxItems")}equals(e){return this.satisfies(t=>null==t||""===t||t===e,{expectedValue:e}).withMessageKey("equals")}}FluentRules.customRules={};class FluentEnsure{constructor(e){this.parsers=e,this.rules=[]}ensure(e){this.assertInitialized();const t=this.parsers.property.parse(e),i=new FluentRules(this,this.parsers,{name:t,displayName:null});return this.mergeRules(i,t)}ensureObject(){this.assertInitialized();const e=new FluentRules(this,this.parsers,{name:null,displayName:null});return this.mergeRules(e,null)}on(e){return Rules.set(e,this.rules),this}_addRule(e){for(;this.rules.length<e.sequence+1;)this.rules.push([]);this.rules[e.sequence].push(e)}assertInitialized(){if(!this.parsers)throw new Error("Did you forget to add \".plugin('aurelia-validation')\" to your main.js?")}mergeRules(e,t){const i=this.rules.find(e=>e.length>0&&e[0].property.name==t);if(i){const t=i[i.length-1];e.sequence=t.sequence,null!==t.property.displayName&&(e=e.displayName(t.property.displayName))}return e}}class ValidationRules{static initialize(e,t){this.parsers={message:e,property:t}}static ensure(e){return new FluentEnsure(ValidationRules.parsers).ensure(e)}static ensureObject(){return new FluentEnsure(ValidationRules.parsers).ensureObject()}static customRule(e,t,i,r){validationMessages[e]=i,FluentRules.customRules[e]={condition:t,argsToConfig:r}}static taggedRules(e,t){return e.map(e=>e.filter(e=>e.tag===t))}static untaggedRules(e){return e.map(e=>e.filter(e=>void 0===e.tag))}static off(e){Rules.unset(e)}}class AureliaValidationConfiguration{constructor(){this.validatorType=StandardValidator}customValidator(e){this.validatorType=e}apply(e){const t=e.get(this.validatorType);e.registerInstance(Validator,t)}}function configure$6(e,t){const i=e.container.get(ValidationMessageParser),r=e.container.get(PropertyAccessorParser);ValidationRules.initialize(i,r);const n=new AureliaValidationConfiguration;t instanceof Function&&t(n),n.apply(e.container),e.globalResources&&e.globalResources(ValidateBindingBehavior,ValidateManuallyBindingBehavior,ValidateOnBlurBindingBehavior,ValidateOnChangeBindingBehavior,ValidateOnChangeOrBlurBindingBehavior,ValidationErrorsCustomAttribute,ValidationRendererCustomAttribute)}class Renderer{getDialogContainer(){throw new Error("DialogRenderer must implement getDialogContainer().")}showDialog(e){throw new Error("DialogRenderer must implement showDialog().")}hideDialog(e){throw new Error("DialogRenderer must implement hideDialog().")}}class DefaultDialogSettings{constructor(){this.lock=!0,this.startingZIndex=1e3,this.centerHorizontalOnly=!1,this.rejectOnCancel=!1,this.ignoreTransitions=!1}}var __decorate$1=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s};const containerTagName="ux-dialog-container",overlayTagName="ux-dialog-overlay",transitionEvent=(()=>{let e;return()=>{if(e)return e;const t=DOM.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(let r in i)if(void 0!==t.style[r])return e=i[r];return""}})(),hasTransition=(()=>{const e=["webkitTransitionDuration","oTransitionDuration"];let t,i;return r=>(t||(t=DOM.createElement("fakeelement"),i="transitionDuration"in t.style?"transitionDuration":e.find(e=>e in t.style)),!!i&&!!DOM.getComputedStyle(r)[i].split(",").find(e=>!!parseFloat(e)))})();let body;function getActionKey(e){return"Escape"===(e.code||e.key)||27===e.keyCode?"Escape":"Enter"===(e.code||e.key)||13===e.keyCode?"Enter":void 0}let DialogRenderer=DialogRenderer_1=class{static keyboardEventHandler(e){const t=getActionKey(e);if(!t)return;const i=DialogRenderer_1.dialogControllers[DialogRenderer_1.dialogControllers.length-1];if(!i||!i.settings.keyboard)return;const r=i.settings.keyboard;"Escape"===t&&(!0===r||r===t||Array.isArray(r)&&r.indexOf(t)>-1)?i.cancel():"Enter"===t&&(r===t||Array.isArray(r)&&r.indexOf(t)>-1)&&i.ok()}static trackController(e){DialogRenderer_1.dialogControllers.length||DOM.addEventListener("keyup",DialogRenderer_1.keyboardEventHandler,!1),DialogRenderer_1.dialogControllers.push(e)}static untrackController(e){const t=DialogRenderer_1.dialogControllers.indexOf(e);-1!==t&&DialogRenderer_1.dialogControllers.splice(t,1),DialogRenderer_1.dialogControllers.length||DOM.removeEventListener("keyup",DialogRenderer_1.keyboardEventHandler,!1)}getOwnElements(e,t){const i=e.querySelectorAll(t),r=[];for(let t=0;t<i.length;t++)i[t].parentElement===e&&r.push(i[t]);return r}attach(e){const t=DOM.createElement("div");t.appendChild(this.anchor),this.dialogContainer=DOM.createElement(containerTagName),this.dialogContainer.appendChild(t),this.dialogOverlay=DOM.createElement(overlayTagName);const i="number"==typeof e.settings.startingZIndex?e.settings.startingZIndex+"":null;this.dialogOverlay.style.zIndex=i,this.dialogContainer.style.zIndex=i;const r=this.getOwnElements(this.host,containerTagName).pop();r&&r.parentElement?(this.host.insertBefore(this.dialogContainer,r.nextSibling),this.host.insertBefore(this.dialogOverlay,r.nextSibling)):(this.host.insertBefore(this.dialogContainer,this.host.firstChild),this.host.insertBefore(this.dialogOverlay,this.host.firstChild)),e.controller.attached(),this.host.classList.add("ux-dialog-open")}detach(e){this.host.removeChild(this.dialogOverlay),this.host.removeChild(this.dialogContainer),e.controller.detached(),DialogRenderer_1.dialogControllers.length||this.host.classList.remove("ux-dialog-open")}setAsActive(){this.dialogOverlay.classList.add("active"),this.dialogContainer.classList.add("active")}setAsInactive(){this.dialogOverlay.classList.remove("active"),this.dialogContainer.classList.remove("active")}setupClickHandling(e){this.stopPropagation=(e=>{e._aureliaDialogHostClicked=!0}),this.closeDialogClick=(t=>{e.settings.overlayDismiss&&!t._aureliaDialogHostClicked&&e.cancel()}),this.dialogContainer.addEventListener("click",this.closeDialogClick),this.anchor.addEventListener("click",this.stopPropagation)}clearClickHandling(){this.dialogContainer.removeEventListener("click",this.closeDialogClick),this.anchor.removeEventListener("click",this.stopPropagation)}centerDialog(){const e=this.dialogContainer.children[0],t=Math.max(DOM.querySelectorAll("html")[0].clientHeight,window.innerHeight||0);e.style.marginTop=Math.max((t-e.offsetHeight)/2,30)+"px",e.style.marginBottom=Math.max((t-e.offsetHeight)/2,30)+"px"}awaitTransition(e,t){return new Promise(i=>{const r=this,n=transitionEvent();t||!hasTransition(this.dialogContainer)?i():this.dialogContainer.addEventListener(n,function e(t){t.target===r.dialogContainer&&(r.dialogContainer.removeEventListener(n,e),i())}),e()})}getDialogContainer(){return this.anchor||(this.anchor=DOM.createElement("div"))}showDialog(e){body||(body=DOM.querySelectorAll("body")[0]),e.settings.host?this.host=e.settings.host:this.host=body;const t=e.settings;return this.attach(e),"function"==typeof t.position?t.position(this.dialogContainer,this.dialogOverlay):t.centerHorizontalOnly||this.centerDialog(),DialogRenderer_1.trackController(e),this.setupClickHandling(e),this.awaitTransition(()=>this.setAsActive(),e.settings.ignoreTransitions)}hideDialog(e){return this.clearClickHandling(),DialogRenderer_1.untrackController(e),this.awaitTransition(()=>this.setAsInactive(),e.settings.ignoreTransitions).then(()=>{this.detach(e)})}};var DialogRenderer_1;DialogRenderer.dialogControllers=[];const defaultRenderer=DialogRenderer=DialogRenderer_1=__decorate$1([transient()],DialogRenderer),resources={"ux-dialog":PLATFORM.moduleName("./ux-dialog"),"ux-dialog-header":PLATFORM.moduleName("./ux-dialog-header"),"ux-dialog-body":PLATFORM.moduleName("./ux-dialog-body"),"ux-dialog-footer":PLATFORM.moduleName("./ux-dialog-footer"),"attach-focus":PLATFORM.moduleName("./attach-focus")},defaultCSSText="ux-dialog-container,ux-dialog-overlay{position:fixed;top:0;right:0;bottom:0;left:0}ux-dialog-overlay{opacity:0}ux-dialog-overlay.active{opacity:1}ux-dialog-container{display:block;transition:opacity .2s linear;opacity:0;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}ux-dialog-container.active{opacity:1}ux-dialog-container>div{padding:30px}ux-dialog-container>div>div{display:block;min-width:300px;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;margin:auto}ux-dialog-container,ux-dialog-container>div,ux-dialog-container>div>div{outline:0}ux-dialog{display:table;box-shadow:0 5px 15px rgba(0,0,0,.5);border:1px solid rgba(0,0,0,.2);border-radius:5px;padding:3px;min-width:300px;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;margin:auto;border-image-source:initial;border-image-slice:initial;border-image-width:initial;border-image-outset:initial;border-image-repeat:initial;background:#fff}ux-dialog>ux-dialog-header{display:block;padding:16px;border-bottom:1px solid #e5e5e5}ux-dialog>ux-dialog-header>button{float:right;border:none;display:block;width:32px;height:32px;background:0 0;font-size:22px;line-height:16px;margin:-14px -16px 0 0;padding:0;cursor:pointer}ux-dialog>ux-dialog-body{display:block;padding:16px}ux-dialog>ux-dialog-footer{display:block;padding:6px;border-top:1px solid #e5e5e5;text-align:right}ux-dialog>ux-dialog-footer button{color:#333;background-color:#fff;padding:6px 12px;font-size:14px;text-align:center;white-space:nowrap;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid #ccc;border-radius:4px;margin:5px 0 5px 5px}ux-dialog>ux-dialog-footer button:disabled{cursor:default;opacity:.45}ux-dialog>ux-dialog-footer button:hover:enabled{color:#333;background-color:#e6e6e6;border-color:#adadad}.ux-dialog-open{overflow:hidden}";class DialogConfiguration{constructor(e,t){this.renderer=defaultRenderer,this.cssText=defaultCSSText,this.resources=[],this.fwConfig=e,this.settings=this.fwConfig.container.get(DefaultDialogSettings),t(()=>this._apply())}_apply(){this.fwConfig.transient(Renderer,this.renderer),this.resources.forEach(e=>this.fwConfig.globalResources(resources[e])),this.cssText&&DOM.injectStyles(this.cssText)}useDefaults(){return this.useRenderer(defaultRenderer).useCSS(defaultCSSText).useStandardResources()}useStandardResources(){return this.useResource("ux-dialog").useResource("ux-dialog-header").useResource("ux-dialog-body").useResource("ux-dialog-footer").useResource("attach-focus")}useResource(e){return this.resources.push(e),this}useRenderer(e,t){return this.renderer=e,t&&Object.assign(this.settings,t),this}useCSS(e){return this.cssText=e,this}}var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function __extends(e,t){function i(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function isFunction(e){return"function"==typeof e}var _enable_super_gross_mode_that_will_cause_bad_things=!1,config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;_enable_super_gross_mode_that_will_cause_bad_things=e},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(e){setTimeout(function(){throw e})}var empty={closed:!0,next:function(e){},error:function(e){if(config.useDeprecatedSynchronousErrorHandling)throw e;hostReportError(e)},complete:function(){}},isArray=Array.isArray||function(e){return e&&"number"==typeof e.length};function isObject$1(e){return null!==e&&"object"==typeof e}function UnsubscriptionErrorImpl(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}UnsubscriptionErrorImpl.prototype=Object.create(Error.prototype);var UnsubscriptionError=UnsubscriptionErrorImpl,Subscription=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var i=this._parent,r=this._parents,n=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,a=r?r.length:0;i;)i.remove(this),i=++s<a&&r[s]||null;if(isFunction(n))try{n.call(this)}catch(i){t=!0,e=i instanceof UnsubscriptionError?flattenUnsubscriptionErrors(i.errors):[i]}if(isArray(o))for(s=-1,a=o.length;++s<a;){var l=o[s];if(isObject$1(l))try{l.unsubscribe()}catch(i){t=!0,e=e||[],i instanceof UnsubscriptionError?e=e.concat(flattenUnsubscriptionErrors(i.errors)):e.push(i)}}if(t)throw new UnsubscriptionError(e)}},e.prototype.add=function(t){var i=t;switch(typeof t){case"function":i=new e(t);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof e)){var r=i;(i=new e)._subscriptions=[r]}break;default:if(!t)return e.EMPTY;throw new Error("unrecognized teardown "+t+" added to Subscription.")}if(i._addParent(this)){var n=this._subscriptions;n?n.push(i):this._subscriptions=[i]}return i},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}},e.prototype._addParent=function(e){var t=this._parent,i=this._parents;return t!==e&&(t?i?-1===i.indexOf(e)&&(i.push(e),!0):(this._parents=[e],!0):(this._parent=e,!0))},e.EMPTY=((t=new e).closed=!0,t),e}();function flattenUnsubscriptionErrors(e){return e.reduce(function(e,t){return e.concat(t instanceof UnsubscriptionError?t.errors:t)},[])}var rxSubscriber="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),Subscriber=function(e){function t(i,r,n){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=empty;break;case 1:if(!i){o.destination=empty;break}if("object"==typeof i){i instanceof t?(o.syncErrorThrowable=i.syncErrorThrowable,o.destination=i,i.add(o)):(o.syncErrorThrowable=!0,o.destination=new SafeSubscriber(o,i));break}default:o.syncErrorThrowable=!0,o.destination=new SafeSubscriber(o,i,r,n)}return o}return __extends(t,e),t.prototype[rxSubscriber]=function(){return this},t.create=function(e,i,r){var n=new t(e,i,r);return n.syncErrorThrowable=!1,n},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this},t}(Subscription),SafeSubscriber=function(e){function t(t,i,r,n){var o,s=e.call(this)||this;s._parentSubscriber=t;var a=s;return isFunction(i)?o=i:i&&(o=i.next,r=i.error,n=i.complete,i!==empty&&(isFunction((a=Object.create(i)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=o,s._error=r,s._complete=n,s}return __extends(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,i=config.useDeprecatedSynchronousErrorHandling;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):hostReportError(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;hostReportError(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var i=function(){return e._complete.call(e._context)};config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,i),this.unsubscribe()):(this.__tryOrUnsub(i),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),config.useDeprecatedSynchronousErrorHandling)throw e;hostReportError(e)}},t.prototype.__tryOrSetError=function(e,t,i){if(!config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(t){return config.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(hostReportError(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Subscriber);function canReportError(e){for(;e;){var t=e,i=t.closed,r=t.destination,n=t.isStopped;if(i||n)return!1;e=r&&r instanceof Subscriber?r:null}return!0}function toSubscriber(e,t,i){if(e){if(e instanceof Subscriber)return e;if(e[rxSubscriber])return e[rxSubscriber]()}return e||t||i?new Subscriber(e,t,i):new Subscriber(empty)}var observable$1="function"==typeof Symbol&&Symbol.observable||"@@observable";function noop(){}function pipeFromArray(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}:noop}var Observable=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var i=new e;return i.source=this,i.operator=t,i},e.prototype.subscribe=function(e,t,i){var r=this.operator,n=toSubscriber(e,t,i);if(r?n.add(r.call(n,this.source)):n.add(this.source||config.useDeprecatedSynchronousErrorHandling&&!n.syncErrorThrowable?this._subscribe(n):this._trySubscribe(n)),config.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable&&(n.syncErrorThrowable=!1,n.syncErrorThrown))throw n.syncErrorValue;return n},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){config.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),canReportError(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var i=this;return new(t=getPromiseCtor(t))(function(t,r){var n;n=i.subscribe(function(t){try{e(t)}catch(e){r(e),n&&n.unsubscribe()}},r,t)})},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[observable$1]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=getPromiseCtor(e))(function(e,i){var r;t.subscribe(function(e){return r=e},function(e){return i(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function getPromiseCtor(e){if(e||(e=config.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function ObjectUnsubscribedErrorImpl(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}ObjectUnsubscribedErrorImpl.prototype=Object.create(Error.prototype);var ObjectUnsubscribedError=ObjectUnsubscribedErrorImpl,SubjectSubscription=function(e){function t(t,i){var r=e.call(this)||this;return r.subject=t,r.subscriber=i,r.closed=!1,r}return __extends(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}},t}(Subscription),SubjectSubscriber=function(e){function t(t){var i=e.call(this,t)||this;return i.destination=t,i}return __extends(t,e),t}(Subscriber),Subject=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return __extends(t,e),t.prototype[rxSubscriber]=function(){return new SubjectSubscriber(this)},t.prototype.lift=function(e){var t=new AnonymousSubject(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,i=t.length,r=t.slice(),n=0;n<i;n++)r[n].next(e)},t.prototype.error=function(e){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,i=t.length,r=t.slice(),n=0;n<i;n++)r[n].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;for(var e=this.observers,t=e.length,i=e.slice(),r=0;r<t;r++)i[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(e.error(this.thrownError),Subscription.EMPTY):this.isStopped?(e.complete(),Subscription.EMPTY):(this.observers.push(e),new SubjectSubscription(this,e))},t.prototype.asObservable=function(){var e=new Observable;return e.source=this,e},t.create=function(e,t){return new AnonymousSubject(e,t)},t}(Observable),AnonymousSubject=function(e){function t(t,i){var r=e.call(this)||this;return r.destination=t,r.source=i,r}return __extends(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):Subscription.EMPTY},t}(Subject);function refCount(){return function(e){return e.lift(new RefCountOperator(e))}}var RefCountOperator=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var i=this.connectable;i._refCount++;var r=new RefCountSubscriber(e,i),n=t.subscribe(r);return r.closed||(r.connection=i.connect()),n},e}(),RefCountSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.connectable=i,r}return __extends(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var i=this.connection,r=e._connection;this.connection=null,!r||i&&r!==i||r.unsubscribe()}}else this.connection=null},t}(Subscriber),ConnectableObservable=function(e){function t(t,i){var r=e.call(this)||this;return r.source=t,r.subjectFactory=i,r._refCount=0,r._isComplete=!1,r}return __extends(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new Subscription).add(this.source.subscribe(new ConnectableSubscriber(this.getSubject(),this))),e.closed?(this._connection=null,e=Subscription.EMPTY):this._connection=e),e},t.prototype.refCount=function(){return refCount()(this)},t}(Observable),connectableProto=ConnectableObservable.prototype,connectableObservableDescriptor={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:connectableProto._subscribe},_isComplete:{value:connectableProto._isComplete,writable:!0},getSubject:{value:connectableProto.getSubject},connect:{value:connectableProto.connect},refCount:{value:connectableProto.refCount}},ConnectableSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.connectable=i,r}return __extends(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(SubjectSubscriber),RefCountSubscriber$1=function(e){function t(t,i){var r=e.call(this,t)||this;return r.connectable=i,r}return __extends(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var i=this.connection,r=e._connection;this.connection=null,!r||i&&r!==i||r.unsubscribe()}}else this.connection=null},t}(Subscriber),GroupBySubscriber=function(e){function t(t,i,r,n,o){var s=e.call(this,t)||this;return s.keySelector=i,s.elementSelector=r,s.durationSelector=n,s.subjectSelector=o,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.keySelector(e)}catch(e){return void this.error(e)}this._group(e,t)},t.prototype._group=function(e,t){var i=this.groups;i||(i=this.groups=new Map);var r,n=i.get(t);if(this.elementSelector)try{r=this.elementSelector(e)}catch(e){this.error(e)}else r=e;if(!n){n=this.subjectSelector?this.subjectSelector():new Subject,i.set(t,n);var o=new GroupedObservable(t,n,this);if(this.destination.next(o),this.durationSelector){var s=void 0;try{s=this.durationSelector(new GroupedObservable(t,n))}catch(e){return void this.error(e)}this.add(s.subscribe(new GroupDurationSubscriber(t,n,this)))}}n.closed||n.next(r)},t.prototype._error=function(e){var t=this.groups;t&&(t.forEach(function(t,i){t.error(e)}),t.clear()),this.destination.error(e)},t.prototype._complete=function(){var e=this.groups;e&&(e.forEach(function(e,t){e.complete()}),e.clear()),this.destination.complete()},t.prototype.removeGroup=function(e){this.groups.delete(e)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&e.prototype.unsubscribe.call(this))},t}(Subscriber),GroupDurationSubscriber=function(e){function t(t,i,r){var n=e.call(this,i)||this;return n.key=t,n.group=i,n.parent=r,n}return __extends(t,e),t.prototype._next=function(e){this.complete()},t.prototype._unsubscribe=function(){var e=this.parent,t=this.key;this.key=this.parent=null,e&&e.removeGroup(t)},t}(Subscriber),GroupedObservable=function(e){function t(t,i,r){var n=e.call(this)||this;return n.key=t,n.groupSubject=i,n.refCountSubscription=r,n}return __extends(t,e),t.prototype._subscribe=function(e){var t=new Subscription,i=this.refCountSubscription,r=this.groupSubject;return i&&!i.closed&&t.add(new InnerRefCountSubscription(i)),t.add(r.subscribe(e)),t},t}(Observable),InnerRefCountSubscription=function(e){function t(t){var i=e.call(this)||this;return i.parent=t,t.count++,i}return __extends(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}(Subscription),BehaviorSubject=function(e){function t(t){var i=e.call(this)||this;return i._value=t,i}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var i=e.prototype._subscribe.call(this,t);return i&&!i.closed&&t.next(this._value),i},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Subject),Action=function(e){function t(t,i){return e.call(this)||this}return __extends(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(Subscription),AsyncAction=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.scheduler=t,r.work=i,r.pending=!1,r}return __extends(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,i){return void 0===i&&(i=0),setInterval(e.flush.bind(e,this),i)},t.prototype.recycleAsyncId=function(e,t,i){if(void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var i=!1,r=void 0;try{this.work(e)}catch(e){i=!0,r=!!e&&e||new Error(e)}if(i)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(Action),QueueAction=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.scheduler=t,r.work=i,r}return __extends(t,e),t.prototype.schedule=function(t,i){return void 0===i&&(i=0),i>0?e.prototype.schedule.call(this,t,i):(this.delay=i,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,i){return i>0||this.closed?e.prototype.execute.call(this,t,i):this._execute(t,i)},t.prototype.requestAsyncId=function(t,i,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,i,r):t.flush(this)},t}(AsyncAction),Scheduler=function(){function e(t,i){void 0===i&&(i=e.now),this.SchedulerAction=t,this.now=i}return e.prototype.schedule=function(e,t,i){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(i,t)},e.now=function(){return Date.now()},e}(),AsyncScheduler=function(e){function t(i,r){void 0===r&&(r=Scheduler.now);var n=e.call(this,i,function(){return t.delegate&&t.delegate!==n?t.delegate.now():r()})||this;return n.actions=[],n.active=!1,n.scheduled=void 0,n}return __extends(t,e),t.prototype.schedule=function(i,r,n){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(i,r,n):e.prototype.schedule.call(this,i,r,n)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}},t}(Scheduler),QueueScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(AsyncScheduler),queue$1=new QueueScheduler(QueueAction),EMPTY=new Observable(function(e){return e.complete()});function empty$1(e){return e?emptyScheduled(e):EMPTY}function emptyScheduled(e){return new Observable(function(t){return e.schedule(function(){return t.complete()})})}function isScheduler(e){return e&&"function"==typeof e.schedule}var NotificationKind,subscribeToArray=function(e){return function(t){for(var i=0,r=e.length;i<r&&!t.closed;i++)t.next(e[i]);t.closed||t.complete()}};function fromArray(e,t){return new Observable(t?function(i){var r=new Subscription,n=0;return r.add(t.schedule(function(){n!==e.length?(i.next(e[n++]),i.closed||r.add(this.schedule())):i.complete()})),r}:subscribeToArray(e))}function scalar(e){var t=new Observable(function(t){t.next(e),t.complete()});return t._isScalar=!0,t.value=e,t}function of(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e[e.length-1];switch(isScheduler(i)?e.pop():i=void 0,e.length){case 0:return empty$1(i);case 1:return i?fromArray(e,i):scalar(e[0]);default:return fromArray(e,i)}}function throwError(e,t){return new Observable(t?function(i){return t.schedule(dispatch,0,{error:e,subscriber:i})}:function(t){return t.error(e)})}function dispatch(e){var t=e.error;e.subscriber.error(t)}NotificationKind||(NotificationKind={});var Notification=function(){function e(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}},e.prototype.accept=function(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)},e.prototype.toObservable=function(){switch(this.kind){case"N":return of(this.value);case"E":return throwError(this.error);case"C":return empty$1()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),ObserveOnSubscriber=function(e){function t(t,i,r){void 0===r&&(r=0);var n=e.call(this,t)||this;return n.scheduler=i,n.delay=r,n}return __extends(t,e),t.dispatch=function(e){var t=e.notification,i=e.destination;t.observe(i),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new ObserveOnMessage(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(Notification.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(Notification.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Notification.createComplete()),this.unsubscribe()},t}(Subscriber),ObserveOnMessage=function(){return function(e,t){this.notification=e,this.destination=t}}(),ReplaySubject=function(e){function t(t,i,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===i&&(i=Number.POSITIVE_INFINITY);var n=e.call(this)||this;return n.scheduler=r,n._events=[],n._infiniteTimeWindow=!1,n._bufferSize=t<1?1:t,n._windowTime=i<1?1:i,i===Number.POSITIVE_INFINITY?(n._infiniteTimeWindow=!0,n.next=n.nextInfiniteTimeWindow):n.next=n.nextTimeWindow,n}return __extends(t,e),t.prototype.nextInfiniteTimeWindow=function(t){var i=this._events;i.push(t),i.length>this._bufferSize&&i.shift(),e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this._events.push(new ReplayEvent(this._getNow(),t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,i=this._infiniteTimeWindow,r=i?this._events:this._trimBufferThenGetEvents(),n=this.scheduler,o=r.length;if(this.closed)throw new ObjectUnsubscribedError;if(this.isStopped||this.hasError?t=Subscription.EMPTY:(this.observers.push(e),t=new SubjectSubscription(this,e)),n&&e.add(e=new ObserveOnSubscriber(e,n)),i)for(var s=0;s<o&&!e.closed;s++)e.next(r[s]);else for(s=0;s<o&&!e.closed;s++)e.next(r[s].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||queue$1).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,n=r.length,o=0;o<n&&!(e-r[o].time<i);)o++;return n>t&&(o=Math.max(o,n-t)),o>0&&r.splice(0,o),r},t}(Subject),ReplayEvent=function(){return function(e,t){this.time=e,this.value=t}}(),AsyncSubject=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return __extends(t,e),t.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),Subscription.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),Subscription.EMPTY):e.prototype._subscribe.call(this,t)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},t}(Subject),nextHandle=1,tasksByHandle={};function runIfPresent(e){var t=tasksByHandle[e];t&&t()}var Immediate={setImmediate:function(e){var t=nextHandle++;return tasksByHandle[t]=e,Promise.resolve().then(function(){return runIfPresent(t)}),t},clearImmediate:function(e){delete tasksByHandle[e]}},AsapAction=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.scheduler=t,r.work=i,r}return __extends(t,e),t.prototype.requestAsyncId=function(t,i,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,i,r):(t.actions.push(this),t.scheduled||(t.scheduled=Immediate.setImmediate(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,i,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,i,r);0===t.actions.length&&(Immediate.clearImmediate(i),t.scheduled=void 0)},t}(AsyncAction),AsapScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,i=this.actions,r=-1,n=i.length;e=e||i.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<n&&(e=i.shift()));if(this.active=!1,t){for(;++r<n&&(e=i.shift());)e.unsubscribe();throw t}},t}(AsyncScheduler),asap=new AsapScheduler(AsapAction),async=new AsyncScheduler(AsyncAction),AnimationFrameAction=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.scheduler=t,r.work=i,r}return __extends(t,e),t.prototype.requestAsyncId=function(t,i,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,i,r):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(function(){return t.flush(null)})))},t.prototype.recycleAsyncId=function(t,i,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,i,r);0===t.actions.length&&(cancelAnimationFrame(i),t.scheduled=void 0)},t}(AsyncAction),AnimationFrameScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,i=this.actions,r=-1,n=i.length;e=e||i.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<n&&(e=i.shift()));if(this.active=!1,t){for(;++r<n&&(e=i.shift());)e.unsubscribe();throw t}},t}(AsyncScheduler),animationFrame=new AnimationFrameScheduler(AnimationFrameAction),VirtualTimeScheduler=function(e){function t(t,i){void 0===t&&(t=VirtualAction),void 0===i&&(i=Number.POSITIVE_INFINITY);var r=e.call(this,t,function(){return r.frame})||this;return r.maxFrames=i,r.frame=0,r.index=-1,r}return __extends(t,e),t.prototype.flush=function(){for(var e,t,i=this.actions,r=this.maxFrames;(t=i[0])&&t.delay<=r&&(i.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=i.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(AsyncScheduler),VirtualAction=function(e){function t(t,i,r){void 0===r&&(r=t.index+=1);var n=e.call(this,t,i)||this;return n.scheduler=t,n.work=i,n.index=r,n.active=!0,n.index=t.index=r,n}return __extends(t,e),t.prototype.schedule=function(i,r){if(void 0===r&&(r=0),!this.id)return e.prototype.schedule.call(this,i,r);this.active=!1;var n=new t(this.scheduler,this.work);return this.add(n),n.schedule(i,r)},t.prototype.requestAsyncId=function(e,i,r){void 0===r&&(r=0),this.delay=e.frame+r;var n=e.actions;return n.push(this),n.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,i){void 0===i&&(i=0)},t.prototype._execute=function(t,i){if(!0===this.active)return e.prototype._execute.call(this,t,i)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(AsyncAction);function ArgumentOutOfRangeErrorImpl(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}ArgumentOutOfRangeErrorImpl.prototype=Object.create(Error.prototype);var ArgumentOutOfRangeError=ArgumentOutOfRangeErrorImpl;function EmptyErrorImpl(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}EmptyErrorImpl.prototype=Object.create(Error.prototype);var EmptyError=EmptyErrorImpl,MapSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.project=i,n.count=0,n.thisArg=r||n,n}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Subscriber),OuterSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Subscriber),InnerSubscriber=function(e){function t(t,i,r){var n=e.call(this)||this;return n.parent=t,n.outerValue=i,n.outerIndex=r,n.index=0,n}return __extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Subscriber),subscribeToPromise=function(e){return function(t){return e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,hostReportError),t}};function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var iterator=getSymbolIterator(),subscribeToIterable=function(e){return function(t){for(var i=e[iterator]();;){var r=i.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof i.return&&t.add(function(){i.return&&i.return()}),t}},subscribeToObservable=function(e){return function(t){var i=e[observable$1]();if("function"!=typeof i.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return i.subscribe(t)}},isArrayLike=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function isPromise(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var subscribeTo=function(e){if(e instanceof Observable)return function(t){return e._isScalar?(t.next(e.value),void t.complete()):e.subscribe(t)};if(e&&"function"==typeof e[observable$1])return subscribeToObservable(e);if(isArrayLike(e))return subscribeToArray(e);if(isPromise(e))return subscribeToPromise(e);if(e&&"function"==typeof e[iterator])return subscribeToIterable(e);var t=isObject$1(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function subscribeToResult(e,t,i,r,n){if(void 0===n&&(n=new InnerSubscriber(e,i,r)),!n.closed)return subscribeTo(t)(n)}var NONE={},CombineLatestSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.resultSelector=i,r.active=0,r.values=[],r.observables=[],r}return __extends(t,e),t.prototype._next=function(e){this.values.push(NONE),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var i=0;i<t;i++){var r=e[i];this.add(subscribeToResult(this,r,r,i))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,i,r,n){var o=this.values,s=o[i],a=this.toRespond?s===NONE?--this.toRespond:this.toRespond:0;o[i]=t,0===a&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(OuterSubscriber),MergeMapSubscriber=function(e){function t(t,i,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var n=e.call(this,t)||this;return n.project=i,n.concurrent=r,n.hasCompleted=!1,n.buffer=[],n.active=0,n.index=0,n}return __extends(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,i=this.index++;try{t=this.project(e,i)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t,e,i)},t.prototype._innerSub=function(e,t,i){var r=new InnerSubscriber(this,void 0,void 0);this.destination.add(r),subscribeToResult(this,e,t,i,r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,i,r,n){this.destination.next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(OuterSubscriber),ForkJoinSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;r.sources=i,r.completed=0,r.haveValues=0;var n=i.length;r.values=new Array(n);for(var o=0;o<n;o++){var s=subscribeToResult(r,i[o],null,o);s&&r.add(s)}return r}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.values[i]=t,n._hasValue||(n._hasValue=!0,this.haveValues++)},t.prototype.notifyComplete=function(e){var t=this.destination,i=this.haveValues,r=this.values,n=r.length;e._hasValue?(this.completed++,this.completed===n&&(i===n&&t.next(r),t.complete())):t.complete()},t}(OuterSubscriber);function isNumeric(e){return!isArray(e)&&e-parseFloat(e)+1>=0}var NEVER=new Observable(noop),RaceSubscriber=function(e){function t(t){var i=e.call(this,t)||this;return i.hasFirst=!1,i.observables=[],i.subscriptions=[],i}return __extends(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var i=0;i<t&&!this.hasFirst;i++){var r=e[i],n=subscribeToResult(this,r,r,i);this.subscriptions&&this.subscriptions.push(n),this.add(n)}this.observables=null}},t.prototype.notifyNext=function(e,t,i,r,n){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==i){var s=this.subscriptions[o];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(t)},t}(OuterSubscriber),ZipSubscriber=function(e){function t(t,i,r){void 0===r&&(r=Object.create(null));var n=e.call(this,t)||this;return n.iterators=[],n.active=0,n.resultSelector="function"==typeof i?i:null,n.values=r,n}return __extends(t,e),t.prototype._next=function(e){var t=this.iterators;isArray(e)?t.push(new StaticArrayIterator(e)):"function"==typeof e[iterator]?t.push(new StaticIterator(e[iterator]())):t.push(new ZipBufferIterator(this.destination,this,e))},t.prototype._complete=function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(var i=0;i<t;i++){var r=e[i];if(r.stillUnsubscribed)this.destination.add(r.subscribe(r,i));else this.active--}}else this.destination.complete()},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var e=this.iterators,t=e.length,i=this.destination,r=0;r<t;r++){if("function"==typeof(s=e[r]).hasValue&&!s.hasValue())return}var n=!1,o=[];for(r=0;r<t;r++){var s,a=(s=e[r]).next();if(s.hasCompleted()&&(n=!0),a.done)return void i.complete();o.push(a.value)}this.resultSelector?this._tryresultSelector(o):i.next(o),n&&i.complete()},t.prototype._tryresultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Subscriber),StaticIterator=function(){function e(e){this.iterator=e,this.nextResult=e.next()}return e.prototype.hasValue=function(){return!0},e.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},e.prototype.hasCompleted=function(){var e=this.nextResult;return e&&e.done},e}(),StaticArrayIterator=function(){function e(e){this.array=e,this.index=0,this.length=0,this.length=e.length}return e.prototype[iterator]=function(){return this},e.prototype.next=function(e){var t=this.index++,i=this.array;return t<this.length?{value:i[t],done:!1}:{value:null,done:!0}},e.prototype.hasValue=function(){return this.array.length>this.index},e.prototype.hasCompleted=function(){return this.array.length===this.index},e}(),ZipBufferIterator=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.parent=i,n.observable=r,n.stillUnsubscribed=!0,n.buffer=[],n.isComplete=!1,n}return __extends(t,e),t.prototype[iterator]=function(){return this},t.prototype.next=function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}},t.prototype.hasValue=function(){return this.buffer.length>0},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(e,t,i,r,n){this.buffer.push(t),this.parent.checkIterators()},t.prototype.subscribe=function(e,t){return subscribeToResult(this,this.observable,this,t)},t}(OuterSubscriber),AuditSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.durationSelector=i,r.hasValue=!1,r}return __extends(t,e),t.prototype._next=function(e){if(this.value=e,this.hasValue=!0,!this.throttled){var t=void 0;try{t=(0,this.durationSelector)(e)}catch(e){return this.destination.error(e)}var i=subscribeToResult(this,t);!i||i.closed?this.clearThrottle():this.add(this.throttled=i)}},t.prototype.clearThrottle=function(){var e=this.value,t=this.hasValue,i=this.throttled;i&&(this.remove(i),this.throttled=null,i.unsubscribe()),t&&(this.value=null,this.hasValue=!1,this.destination.next(e))},t.prototype.notifyNext=function(e,t,i,r){this.clearThrottle()},t.prototype.notifyComplete=function(){this.clearThrottle()},t}(OuterSubscriber),BufferSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.buffer=[],r.add(subscribeToResult(r,i)),r}return __extends(t,e),t.prototype._next=function(e){this.buffer.push(e)},t.prototype.notifyNext=function(e,t,i,r,n){var o=this.buffer;this.buffer=[],this.destination.next(o)},t}(OuterSubscriber),BufferCountSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.bufferSize=i,r.buffer=[],r}return __extends(t,e),t.prototype._next=function(e){var t=this.buffer;t.push(e),t.length==this.bufferSize&&(this.destination.next(t),this.buffer=[])},t.prototype._complete=function(){var t=this.buffer;t.length>0&&this.destination.next(t),e.prototype._complete.call(this)},t}(Subscriber),BufferSkipCountSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.bufferSize=i,n.startBufferEvery=r,n.buffers=[],n.count=0,n}return __extends(t,e),t.prototype._next=function(e){var t=this.bufferSize,i=this.startBufferEvery,r=this.buffers,n=this.count;this.count++,n%i==0&&r.push([]);for(var o=r.length;o--;){var s=r[o];s.push(e),s.length===t&&(r.splice(o,1),this.destination.next(s))}},t.prototype._complete=function(){for(var t=this.buffers,i=this.destination;t.length>0;){var r=t.shift();r.length>0&&i.next(r)}e.prototype._complete.call(this)},t}(Subscriber),Context=function(){return function(){this.buffer=[]}}(),BufferTimeSubscriber=function(e){function t(t,i,r,n,o){var s=e.call(this,t)||this;s.bufferTimeSpan=i,s.bufferCreationInterval=r,s.maxBufferSize=n,s.scheduler=o,s.contexts=[];var a=s.openContext();if(s.timespanOnly=null==r||r<0,s.timespanOnly){var l={subscriber:s,context:a,bufferTimeSpan:i};s.add(a.closeAction=o.schedule(dispatchBufferTimeSpanOnly,i,l))}else{var c={subscriber:s,context:a},u={bufferTimeSpan:i,bufferCreationInterval:r,subscriber:s,scheduler:o};s.add(a.closeAction=o.schedule(dispatchBufferClose,i,c)),s.add(o.schedule(dispatchBufferCreation,r,u))}return s}return __extends(t,e),t.prototype._next=function(e){for(var t,i=this.contexts,r=i.length,n=0;n<r;n++){var o=i[n],s=o.buffer;s.push(e),s.length==this.maxBufferSize&&(t=o)}t&&this.onBufferFull(t)},t.prototype._error=function(t){this.contexts.length=0,e.prototype._error.call(this,t)},t.prototype._complete=function(){for(var t=this.contexts,i=this.destination;t.length>0;){var r=t.shift();i.next(r.buffer)}e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.contexts=null},t.prototype.onBufferFull=function(e){this.closeContext(e);var t=e.closeAction;if(t.unsubscribe(),this.remove(t),!this.closed&&this.timespanOnly){e=this.openContext();var i=this.bufferTimeSpan,r={subscriber:this,context:e,bufferTimeSpan:i};this.add(e.closeAction=this.scheduler.schedule(dispatchBufferTimeSpanOnly,i,r))}},t.prototype.openContext=function(){var e=new Context;return this.contexts.push(e),e},t.prototype.closeContext=function(e){this.destination.next(e.buffer);var t=this.contexts;(t?t.indexOf(e):-1)>=0&&t.splice(t.indexOf(e),1)},t}(Subscriber);function dispatchBufferTimeSpanOnly(e){var t=e.subscriber,i=e.context;i&&t.closeContext(i),t.closed||(e.context=t.openContext(),e.context.closeAction=this.schedule(e,e.bufferTimeSpan))}function dispatchBufferCreation(e){var t=e.bufferCreationInterval,i=e.bufferTimeSpan,r=e.subscriber,n=e.scheduler,o=r.openContext();r.closed||(r.add(o.closeAction=n.schedule(dispatchBufferClose,i,{subscriber:r,context:o})),this.schedule(e,t))}function dispatchBufferClose(e){var t=e.subscriber,i=e.context;t.closeContext(i)}var BufferToggleSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.openings=i,n.closingSelector=r,n.contexts=[],n.add(subscribeToResult(n,i)),n}return __extends(t,e),t.prototype._next=function(e){for(var t=this.contexts,i=t.length,r=0;r<i;r++)t[r].buffer.push(e)},t.prototype._error=function(t){for(var i=this.contexts;i.length>0;){var r=i.shift();r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,e.prototype._error.call(this,t)},t.prototype._complete=function(){for(var t=this.contexts;t.length>0;){var i=t.shift();this.destination.next(i.buffer),i.subscription.unsubscribe(),i.buffer=null,i.subscription=null}this.contexts=null,e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,i,r,n){e?this.closeBuffer(e):this.openBuffer(t)},t.prototype.notifyComplete=function(e){this.closeBuffer(e.context)},t.prototype.openBuffer=function(e){try{var t=this.closingSelector.call(this,e);t&&this.trySubscribe(t)}catch(e){this._error(e)}},t.prototype.closeBuffer=function(e){var t=this.contexts;if(t&&e){var i=e.buffer,r=e.subscription;this.destination.next(i),t.splice(t.indexOf(e),1),this.remove(r),r.unsubscribe()}},t.prototype.trySubscribe=function(e){var t=this.contexts,i=new Subscription,r={buffer:[],subscription:i};t.push(r);var n=subscribeToResult(this,e,r);!n||n.closed?this.closeBuffer(r):(n.context=r,this.add(n),i.add(n))},t}(OuterSubscriber),BufferWhenSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.closingSelector=i,r.subscribing=!1,r.openBuffer(),r}return __extends(t,e),t.prototype._next=function(e){this.buffer.push(e)},t.prototype._complete=function(){var t=this.buffer;t&&this.destination.next(t),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},t.prototype.notifyNext=function(e,t,i,r,n){this.openBuffer()},t.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},t.prototype.openBuffer=function(){var e=this.closingSubscription;e&&(this.remove(e),e.unsubscribe());var t,i=this.buffer;this.buffer&&this.destination.next(i),this.buffer=[];try{t=(0,this.closingSelector)()}catch(e){return this.error(e)}e=new Subscription,this.closingSubscription=e,this.add(e),this.subscribing=!0,e.add(subscribeToResult(this,t)),this.subscribing=!1},t}(OuterSubscriber),CatchSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.selector=i,n.caught=r,n}return __extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var i=void 0;try{i=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var r=new InnerSubscriber(this,void 0,void 0);this.add(r),subscribeToResult(this,i,void 0,void 0,r)}},t}(OuterSubscriber),CountSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.predicate=i,n.source=r,n.count=0,n.index=0,n}return __extends(t,e),t.prototype._next=function(e){this.predicate?this._tryPredicate(e):this.count++},t.prototype._tryPredicate=function(e){var t;try{t=this.predicate(e,this.index++,this.source)}catch(e){return void this.destination.error(e)}t&&this.count++},t.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},t}(Subscriber),DebounceSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.durationSelector=i,r.hasValue=!1,r.durationSubscription=null,r}return __extends(t,e),t.prototype._next=function(e){try{var t=this.durationSelector.call(this,e);t&&this._tryNext(e,t)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.emitValue(),this.destination.complete()},t.prototype._tryNext=function(e,t){var i=this.durationSubscription;this.value=e,this.hasValue=!0,i&&(i.unsubscribe(),this.remove(i)),(i=subscribeToResult(this,t))&&!i.closed&&this.add(this.durationSubscription=i)},t.prototype.notifyNext=function(e,t,i,r,n){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){if(this.hasValue){var t=this.value,i=this.durationSubscription;i&&(this.durationSubscription=null,i.unsubscribe(),this.remove(i)),this.value=null,this.hasValue=!1,e.prototype._next.call(this,t)}},t}(OuterSubscriber),DebounceTimeSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.dueTime=i,n.scheduler=r,n.debouncedSubscription=null,n.lastValue=null,n.hasValue=!1,n}return __extends(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(dispatchNext$2,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(Subscriber);function dispatchNext$2(e){e.debouncedNext()}var DefaultIfEmptySubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.defaultValue=i,r.isEmpty=!0,r}return __extends(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(Subscriber);function isDate(e){return e instanceof Date&&!isNaN(+e)}function delay(e,t){void 0===t&&(t=async);var i=isDate(e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new DelayOperator(i,t))}}var DelayOperator=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new DelaySubscriber(e,this.delay,this.scheduler))},e}(),DelaySubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.delay=i,n.scheduler=r,n.queue=[],n.active=!1,n.errored=!1,n}return __extends(t,e),t.dispatch=function(e){for(var t=e.source,i=t.queue,r=e.scheduler,n=e.destination;i.length>0&&i[0].time-r.now()<=0;)i.shift().notification.observe(n);if(i.length>0){var o=Math.max(0,i[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,i=new DelayMessage(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(Notification.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(Notification.createComplete()),this.unsubscribe()},t}(Subscriber),DelayMessage=function(){return function(e,t){this.time=e,this.notification=t}}(),DelayWhenSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.delayDurationSelector=i,r.completed=!1,r.delayNotifierSubscriptions=[],r.index=0,r}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.destination.next(e),this.removeSubscription(n),this.tryComplete()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype.notifyComplete=function(e){var t=this.removeSubscription(e);t&&this.destination.next(t),this.tryComplete()},t.prototype._next=function(e){var t=this.index++;try{var i=this.delayDurationSelector(e,t);i&&this.tryDelay(i,e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},t.prototype.removeSubscription=function(e){e.unsubscribe();var t=this.delayNotifierSubscriptions.indexOf(e);return-1!==t&&this.delayNotifierSubscriptions.splice(t,1),e.outerValue},t.prototype.tryDelay=function(e,t){var i=subscribeToResult(this,e,t);i&&!i.closed&&(this.destination.add(i),this.delayNotifierSubscriptions.push(i))},t.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},t}(OuterSubscriber),SubscriptionDelayObservable=function(e){function t(t,i){var r=e.call(this)||this;return r.source=t,r.subscriptionDelay=i,r}return __extends(t,e),t.prototype._subscribe=function(e){this.subscriptionDelay.subscribe(new SubscriptionDelaySubscriber(e,this.source))},t}(Observable),SubscriptionDelaySubscriber=function(e){function t(t,i){var r=e.call(this)||this;return r.parent=t,r.source=i,r.sourceSubscribed=!1,r}return __extends(t,e),t.prototype._next=function(e){this.subscribeToSource()},t.prototype._error=function(e){this.unsubscribe(),this.parent.error(e)},t.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},t.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},t}(Subscriber),DeMaterializeSubscriber=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype._next=function(e){e.observe(this.destination)},t}(Subscriber),DistinctSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.keySelector=i,n.values=new Set,r&&n.add(subscribeToResult(n,r)),n}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.values.clear()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},t.prototype._useKeySelector=function(e){var t,i=this.destination;try{t=this.keySelector(e)}catch(e){return void i.error(e)}this._finalizeNext(t,e)},t.prototype._finalizeNext=function(e,t){var i=this.values;i.has(e)||(i.add(e),this.destination.next(t))},t}(OuterSubscriber),DistinctUntilChangedSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.keySelector=r,n.hasKey=!1,"function"==typeof i&&(n.compare=i),n}return __extends(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var i=this.keySelector;t=i?i(e):e}catch(e){return this.destination.error(e)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))},t}(Subscriber),FilterSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.predicate=i,n.thisArg=r,n.count=0,n}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(Subscriber),TapSubscriber=function(e){function t(t,i,r,n){var o=e.call(this,t)||this;return o._tapNext=noop,o._tapError=noop,o._tapComplete=noop,o._tapError=r||noop,o._tapComplete=n||noop,isFunction(i)?(o._context=o,o._tapNext=i):i&&(o._context=i,o._tapNext=i.next||noop,o._tapError=i.error||noop,o._tapComplete=i.complete||noop),o}return __extends(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(Subscriber);function take(e){return function(t){return 0===e?empty$1():t.lift(new TakeOperator(e))}}var TakeOperator=function(){function e(e){if(this.total=e,this.total<0)throw new ArgumentOutOfRangeError}return e.prototype.call=function(e,t){return t.subscribe(new TakeSubscriber(e,this.total))},e}(),TakeSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.total=i,r.count=0,r}return __extends(t,e),t.prototype._next=function(e){var t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))},t}(Subscriber),EverySubscriber=function(e){function t(t,i,r,n){var o=e.call(this,t)||this;return o.predicate=i,o.thisArg=r,o.source=n,o.index=0,o.thisArg=r||o,o}return __extends(t,e),t.prototype.notifyComplete=function(e){this.destination.next(e),this.destination.complete()},t.prototype._next=function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(e){return void this.destination.error(e)}t||this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)},t}(Subscriber),SwitchFirstSubscriber=function(e){function t(t){var i=e.call(this,t)||this;return i.hasCompleted=!1,i.hasSubscription=!1,i}return __extends(t,e),t.prototype._next=function(e){this.hasSubscription||(this.hasSubscription=!0,this.add(subscribeToResult(this,e)))},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},t.prototype.notifyComplete=function(e){this.remove(e),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}(OuterSubscriber),ExhaustMapSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.project=i,r.hasSubscription=!1,r.hasCompleted=!1,r.index=0,r}return __extends(t,e),t.prototype._next=function(e){this.hasSubscription||this.tryNext(e)},t.prototype.tryNext=function(e){var t,i=this.index++;try{t=this.project(e,i)}catch(e){return void this.destination.error(e)}this.hasSubscription=!0,this._innerSub(t,e,i)},t.prototype._innerSub=function(e,t,i){var r=new InnerSubscriber(this,void 0,void 0);this.destination.add(r),subscribeToResult(this,e,t,i,r)},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,i,r,n){this.destination.next(t)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.remove(e),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}(OuterSubscriber),ExpandSubscriber=function(e){function t(t,i,r,n){var o=e.call(this,t)||this;return o.project=i,o.concurrent=r,o.scheduler=n,o.index=0,o.active=0,o.hasCompleted=!1,r<Number.POSITIVE_INFINITY&&(o.buffer=[]),o}return __extends(t,e),t.dispatch=function(e){var t=e.subscriber,i=e.result,r=e.value,n=e.index;t.subscribeToProjection(i,r,n)},t.prototype._next=function(e){var i=this.destination;if(i.closed)this._complete();else{var r=this.index++;if(this.active<this.concurrent){i.next(e);try{var n=(0,this.project)(e,r);if(this.scheduler){var o={subscriber:this,result:n,value:e,index:r};this.destination.add(this.scheduler.schedule(t.dispatch,0,o))}else this.subscribeToProjection(n,e,r)}catch(e){i.error(e)}}else this.buffer.push(e)}},t.prototype.subscribeToProjection=function(e,t,i){this.active++,this.destination.add(subscribeToResult(this,e,t,i))},t.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,i,r,n){this._next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.destination.remove(e),this.active--,t&&t.length>0&&this._next(t.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},t}(OuterSubscriber),FinallySubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.add(new Subscription(i)),r}return __extends(t,e),t}(Subscriber),FindValueSubscriber=function(e){function t(t,i,r,n,o){var s=e.call(this,t)||this;return s.predicate=i,s.source=r,s.yieldIndex=n,s.thisArg=o,s.index=0,s}return __extends(t,e),t.prototype.notifyComplete=function(e){var t=this.destination;t.next(e),t.complete(),this.unsubscribe()},t.prototype._next=function(e){var t=this.predicate,i=this.thisArg,r=this.index++;try{t.call(i||this,e,r,this.source)&&this.notifyComplete(this.yieldIndex?r:e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},t}(Subscriber),IgnoreElementsSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._next=function(e){},t}(Subscriber),IsEmptySubscriber=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.notifyComplete=function(e){var t=this.destination;t.next(e),t.complete()},t.prototype._next=function(e){this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)},t}(Subscriber),TakeLastSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.total=i,r.ring=new Array,r.count=0,r}return __extends(t,e),t.prototype._next=function(e){var t=this.ring,i=this.total,r=this.count++;t.length<i?t.push(e):t[r%i]=e},t.prototype._complete=function(){var e=this.destination,t=this.count;if(t>0)for(var i=this.count>=this.total?this.total:this.count,r=this.ring,n=0;n<i;n++){var o=t++%i;e.next(r[o])}e.complete()},t}(Subscriber),MapToSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.value=i,r}return __extends(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(Subscriber),MaterializeSubscriber=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype._next=function(e){this.destination.next(Notification.createNext(e))},t.prototype._error=function(e){var t=this.destination;t.next(Notification.createError(e)),t.complete()},t.prototype._complete=function(){var e=this.destination;e.next(Notification.createComplete()),e.complete()},t}(Subscriber),ScanSubscriber=function(e){function t(t,i,r,n){var o=e.call(this,t)||this;return o.accumulator=i,o._seed=r,o.hasSeed=n,o.index=0,o}return __extends(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,i=this.index++;try{t=this.accumulator(this.seed,e,i)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(Subscriber),MergeScanSubscriber=function(e){function t(t,i,r,n){var o=e.call(this,t)||this;return o.accumulator=i,o.acc=r,o.concurrent=n,o.hasValue=!1,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return __extends(t,e),t.prototype._next=function(e){if(this.active<this.concurrent){var t=this.index++,i=this.destination,r=void 0;try{r=(0,this.accumulator)(this.acc,e,t)}catch(e){return i.error(e)}this.active++,this._innerSub(r,e,t)}else this.buffer.push(e)},t.prototype._innerSub=function(e,t,i){var r=new InnerSubscriber(this,void 0,void 0);this.destination.add(r),subscribeToResult(this,e,t,i,r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},t.prototype.notifyNext=function(e,t,i,r,n){var o=this.destination;this.acc=t,this.hasValue=!0,o.next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.destination.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},t}(OuterSubscriber),OnErrorResumeNextSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.destination=t,r.nextSources=i,r}return __extends(t,e),t.prototype.notifyError=function(e,t){this.subscribeToNextSource()},t.prototype.notifyComplete=function(e){this.subscribeToNextSource()},t.prototype._error=function(e){this.subscribeToNextSource(),this.unsubscribe()},t.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},t.prototype.subscribeToNextSource=function(){var e=this.nextSources.shift();if(e){var t=new InnerSubscriber(this,void 0,void 0);this.destination.add(t),subscribeToResult(this,e,void 0,void 0,t)}else this.destination.complete()},t}(OuterSubscriber),PairwiseSubscriber=function(e){function t(t){var i=e.call(this,t)||this;return i.hasPrev=!1,i}return __extends(t,e),t.prototype._next=function(e){this.hasPrev?this.destination.next([this.prev,e]):this.hasPrev=!0,this.prev=e},t}(Subscriber),RepeatSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.count=i,n.source=r,n}return __extends(t,e),t.prototype.complete=function(){if(!this.isStopped){var t=this.source,i=this.count;if(0===i)return e.prototype.complete.call(this);i>-1&&(this.count=i-1),t.subscribe(this._unsubscribeAndRecycle())}},t}(Subscriber),RepeatWhenSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.notifier=i,n.source=r,n.sourceIsBeingSubscribedTo=!0,n}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},t.prototype.notifyComplete=function(t){if(!1===this.sourceIsBeingSubscribedTo)return e.prototype.complete.call(this)},t.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return e.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next()}},t.prototype._unsubscribe=function(){var e=this.notifications,t=this.retriesSubscription;e&&(e.unsubscribe(),this.notifications=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null},t.prototype._unsubscribeAndRecycle=function(){var t=this._unsubscribe;return this._unsubscribe=null,e.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=t,this},t.prototype.subscribeToRetries=function(){var t;this.notifications=new Subject;try{t=(0,this.notifier)(this.notifications)}catch(t){return e.prototype.complete.call(this)}this.retries=t,this.retriesSubscription=subscribeToResult(this,t)},t}(OuterSubscriber),RetrySubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.count=i,n.source=r,n}return __extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var i=this.source,r=this.count;if(0===r)return e.prototype.error.call(this,t);r>-1&&(this.count=r-1),i.subscribe(this._unsubscribeAndRecycle())}},t}(Subscriber),RetryWhenSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.notifier=i,n.source=r,n}return __extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var i=this.errors,r=this.retries,n=this.retriesSubscription;if(r)this.errors=null,this.retriesSubscription=null;else{i=new Subject;try{r=(0,this.notifier)(i)}catch(t){return e.prototype.error.call(this,t)}n=subscribeToResult(this,r)}this._unsubscribeAndRecycle(),this.errors=i,this.retries=r,this.retriesSubscription=n,i.next(t)}},t.prototype._unsubscribe=function(){var e=this.errors,t=this.retriesSubscription;e&&(e.unsubscribe(),this.errors=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null},t.prototype.notifyNext=function(e,t,i,r,n){var o=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=o,this.source.subscribe(this)},t}(OuterSubscriber),SampleSubscriber=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasValue=!1,t}return __extends(t,e),t.prototype._next=function(e){this.value=e,this.hasValue=!0},t.prototype.notifyNext=function(e,t,i,r,n){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},t}(OuterSubscriber),SampleTimeSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.period=i,n.scheduler=r,n.hasValue=!1,n.add(r.schedule(dispatchNotification,i,{subscriber:n,period:i})),n}return __extends(t,e),t.prototype._next=function(e){this.lastValue=e,this.hasValue=!0},t.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},t}(Subscriber);function dispatchNotification(e){var t=e.subscriber,i=e.period;t.notifyNext(),this.schedule(e,i)}var SequenceEqualSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.compareTo=i,n.comparator=r,n._a=[],n._b=[],n._oneComplete=!1,n.destination.add(i.subscribe(new SequenceEqualCompareToSubscriber(t,n))),n}return __extends(t,e),t.prototype._next=function(e){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(e),this.checkValues())},t.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},t.prototype.checkValues=function(){for(var e=this._a,t=this._b,i=this.comparator;e.length>0&&t.length>0;){var r=e.shift(),n=t.shift(),o=!1;try{o=i?i(r,n):r===n}catch(e){this.destination.error(e)}o||this.emit(!1)}},t.prototype.emit=function(e){var t=this.destination;t.next(e),t.complete()},t.prototype.nextB=function(e){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(e),this.checkValues())},t.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},t}(Subscriber),SequenceEqualCompareToSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.parent=i,r}return __extends(t,e),t.prototype._next=function(e){this.parent.nextB(e)},t.prototype._error=function(e){this.parent.error(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},t}(Subscriber),SingleSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.predicate=i,n.source=r,n.seenValue=!1,n.index=0,n}return __extends(t,e),t.prototype.applySingleValue=function(e){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=e)},t.prototype._next=function(e){var t=this.index++;this.predicate?this.tryNext(e,t):this.applySingleValue(e)},t.prototype.tryNext=function(e,t){try{this.predicate(e,t,this.source)&&this.applySingleValue(e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){var e=this.destination;this.index>0?(e.next(this.seenValue?this.singleValue:void 0),e.complete()):e.error(new EmptyError)},t}(Subscriber);function skip(e){return function(t){return t.lift(new SkipOperator(e))}}var SkipOperator=function(){function e(e){this.total=e}return e.prototype.call=function(e,t){return t.subscribe(new SkipSubscriber(e,this.total))},e}(),SkipSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.total=i,r.count=0,r}return __extends(t,e),t.prototype._next=function(e){++this.count>this.total&&this.destination.next(e)},t}(Subscriber),SkipLastSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r._skipCount=i,r._count=0,r._ring=new Array(i),r}return __extends(t,e),t.prototype._next=function(e){var t=this._skipCount,i=this._count++;if(i<t)this._ring[i]=e;else{var r=i%t,n=this._ring,o=n[r];n[r]=e,this.destination.next(o)}},t}(Subscriber),SkipUntilSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;r.hasValue=!1;var n=new InnerSubscriber(r,void 0,void 0);return r.add(n),r.innerSubscription=n,subscribeToResult(r,i,void 0,void 0,n),r}return __extends(t,e),t.prototype._next=function(t){this.hasValue&&e.prototype._next.call(this,t)},t.prototype.notifyNext=function(e,t,i,r,n){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},t.prototype.notifyComplete=function(){},t}(OuterSubscriber),SkipWhileSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.predicate=i,r.skipping=!0,r.index=0,r}return __extends(t,e),t.prototype._next=function(e){var t=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||t.next(e)},t.prototype.tryCallPredicate=function(e){try{var t=this.predicate(e,this.index++);this.skipping=Boolean(t)}catch(e){this.destination.error(e)}},t}(Subscriber),SubscribeOnObservable=function(e){function t(t,i,r){void 0===i&&(i=0),void 0===r&&(r=asap);var n=e.call(this)||this;return n.source=t,n.delayTime=i,n.scheduler=r,(!isNumeric(i)||i<0)&&(n.delayTime=0),r&&"function"==typeof r.schedule||(n.scheduler=asap),n}return __extends(t,e),t.create=function(e,i,r){return void 0===i&&(i=0),void 0===r&&(r=asap),new t(e,i,r)},t.dispatch=function(e){var t=e.source,i=e.subscriber;return this.add(t.subscribe(i))},t.prototype._subscribe=function(e){var i=this.delayTime,r=this.source;return this.scheduler.schedule(t.dispatch,i,{source:r,subscriber:e})},t}(Observable),SwitchMapSubscriber=function(e){function t(t,i){var r=e.call(this,t)||this;return r.project=i,r.index=0,r}return __extends(t,e),t.prototype._next=function(e){var t,i=this.index++;try{t=this.project(e,i)}catch(e){return void this.destination.error(e)}this._innerSub(t,e,i)},t.prototype._innerSub=function(e,t,i){var r=this.innerSubscription;r&&r.unsubscribe();var n=new InnerSubscriber(this,void 0,void 0);this.destination.add(n),this.innerSubscription=subscribeToResult(this,e,t,i,n)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,i,r,n){this.destination.next(t)},t}(OuterSubscriber),TakeUntilSubscriber=function(e){function t(t){var i=e.call(this,t)||this;return i.seenValue=!1,i}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(OuterSubscriber),TakeWhileSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.predicate=i,n.inclusive=r,n.index=0,n}return __extends(t,e),t.prototype._next=function(e){var t,i=this.destination;try{t=this.predicate(e,this.index++)}catch(e){return void i.error(e)}this.nextOrComplete(e,t)},t.prototype.nextOrComplete=function(e,t){var i=this.destination;Boolean(t)?i.next(e):(this.inclusive&&i.next(e),i.complete())},t}(Subscriber),ThrottleSubscriber=function(e){function t(t,i,r,n){var o=e.call(this,t)||this;return o.destination=t,o.durationSelector=i,o._leading=r,o._trailing=n,o._hasValue=!1,o}return __extends(t,e),t.prototype._next=function(e){this._hasValue=!0,this._sendValue=e,this._throttled||(this._leading?this.send():this.throttle(e))},t.prototype.send=function(){var e=this._hasValue,t=this._sendValue;e&&(this.destination.next(t),this.throttle(t)),this._hasValue=!1,this._sendValue=null},t.prototype.throttle=function(e){var t=this.tryDurationSelector(e);t&&this.add(this._throttled=subscribeToResult(this,t))},t.prototype.tryDurationSelector=function(e){try{return this.durationSelector(e)}catch(e){return this.destination.error(e),null}},t.prototype.throttlingDone=function(){var e=this._throttled,t=this._trailing;e&&e.unsubscribe(),this._throttled=null,t&&this.send()},t.prototype.notifyNext=function(e,t,i,r,n){this.throttlingDone()},t.prototype.notifyComplete=function(){this.throttlingDone()},t}(OuterSubscriber),ThrottleTimeSubscriber=function(e){function t(t,i,r,n,o){var s=e.call(this,t)||this;return s.duration=i,s.scheduler=r,s.leading=n,s.trailing=o,s._hasTrailingValue=!1,s._trailingValue=null,s}return __extends(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(dispatchNext$3,this.duration,{subscriber:this})),this.leading&&this.destination.next(e))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(Subscriber);function dispatchNext$3(e){e.subscriber.clearThrottle()}var TimeoutWithSubscriber=function(e){function t(t,i,r,n,o){var s=e.call(this,t)||this;return s.absoluteTimeout=i,s.waitFor=r,s.withObservable=n,s.scheduler=o,s.action=null,s.scheduleTimeout(),s}return __extends(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(subscribeToResult(e,t))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},t}(OuterSubscriber),WindowSubscriber=function(e){function t(t){var i=e.call(this,t)||this;return i.window=new Subject,t.next(i.window),i}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.openWindow()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype.notifyComplete=function(e){this._complete()},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e)},t.prototype._complete=function(){this.window.complete(),this.destination.complete()},t.prototype._unsubscribe=function(){this.window=null},t.prototype.openWindow=function(){var e=this.window;e&&e.complete();var t=this.destination,i=this.window=new Subject;t.next(i)},t}(OuterSubscriber),WindowCountSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.destination=t,n.windowSize=i,n.startWindowEvery=r,n.windows=[new Subject],n.count=0,t.next(n.windows[0]),n}return __extends(t,e),t.prototype._next=function(e){for(var t=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,i=this.destination,r=this.windowSize,n=this.windows,o=n.length,s=0;s<o&&!this.closed;s++)n[s].next(e);var a=this.count-r+1;if(a>=0&&a%t==0&&!this.closed&&n.shift().complete(),++this.count%t==0&&!this.closed){var l=new Subject;n.push(l),i.next(l)}},t.prototype._error=function(e){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().error(e);this.destination.error(e)},t.prototype._complete=function(){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().complete();this.destination.complete()},t.prototype._unsubscribe=function(){this.count=0,this.windows=null},t}(Subscriber),CountedSubject=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._numberOfNextedValues=0,t}return __extends(t,e),t.prototype.next=function(t){this._numberOfNextedValues++,e.prototype.next.call(this,t)},Object.defineProperty(t.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),t}(Subject),WindowTimeSubscriber=function(e){function t(t,i,r,n,o){var s=e.call(this,t)||this;s.destination=t,s.windowTimeSpan=i,s.windowCreationInterval=r,s.maxWindowSize=n,s.scheduler=o,s.windows=[];var a=s.openWindow();if(null!==r&&r>=0){var l={subscriber:s,window:a,context:null},c={windowTimeSpan:i,windowCreationInterval:r,subscriber:s,scheduler:o};s.add(o.schedule(dispatchWindowClose,i,l)),s.add(o.schedule(dispatchWindowCreation,r,c))}else{var u={subscriber:s,window:a,windowTimeSpan:i};s.add(o.schedule(dispatchWindowTimeSpanOnly,i,u))}return s}return __extends(t,e),t.prototype._next=function(e){for(var t=this.windows,i=t.length,r=0;r<i;r++){var n=t[r];n.closed||(n.next(e),n.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(n))}},t.prototype._error=function(e){for(var t=this.windows;t.length>0;)t.shift().error(e);this.destination.error(e)},t.prototype._complete=function(){for(var e=this.windows;e.length>0;){var t=e.shift();t.closed||t.complete()}this.destination.complete()},t.prototype.openWindow=function(){var e=new CountedSubject;return this.windows.push(e),this.destination.next(e),e},t.prototype.closeWindow=function(e){e.complete();var t=this.windows;t.splice(t.indexOf(e),1)},t}(Subscriber);function dispatchWindowTimeSpanOnly(e){var t=e.subscriber,i=e.windowTimeSpan,r=e.window;r&&t.closeWindow(r),e.window=t.openWindow(),this.schedule(e,i)}function dispatchWindowCreation(e){var t=e.windowTimeSpan,i=e.subscriber,r=e.scheduler,n=e.windowCreationInterval,o=i.openWindow(),s={action:this,subscription:null},a={subscriber:i,window:o,context:s};s.subscription=r.schedule(dispatchWindowClose,t,a),this.add(s.subscription),this.schedule(e,n)}function dispatchWindowClose(e){var t=e.subscriber,i=e.window,r=e.context;r&&r.action&&r.subscription&&r.action.remove(r.subscription),t.closeWindow(i)}var MiddlewarePlacement,LogLevel,PerformanceMeasurement,WindowToggleSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.openings=i,n.closingSelector=r,n.contexts=[],n.add(n.openSubscription=subscribeToResult(n,i,i)),n}return __extends(t,e),t.prototype._next=function(e){var t=this.contexts;if(t)for(var i=t.length,r=0;r<i;r++)t[r].window.next(e)},t.prototype._error=function(t){var i=this.contexts;if(this.contexts=null,i)for(var r=i.length,n=-1;++n<r;){var o=i[n];o.window.error(t),o.subscription.unsubscribe()}e.prototype._error.call(this,t)},t.prototype._complete=function(){var t=this.contexts;if(this.contexts=null,t)for(var i=t.length,r=-1;++r<i;){var n=t[r];n.window.complete(),n.subscription.unsubscribe()}e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.contexts;if(this.contexts=null,e)for(var t=e.length,i=-1;++i<t;){var r=e[i];r.window.unsubscribe(),r.subscription.unsubscribe()}},t.prototype.notifyNext=function(e,t,i,r,n){if(e===this.openings){var o=void 0;try{o=(0,this.closingSelector)(t)}catch(e){return this.error(e)}var s=new Subject,a=new Subscription,l={window:s,subscription:a};this.contexts.push(l);var c=subscribeToResult(this,o,l);c.closed?this.closeWindow(this.contexts.length-1):(c.context=l,a.add(c)),this.destination.next(s)}else this.closeWindow(this.contexts.indexOf(e))},t.prototype.notifyError=function(e){this.error(e)},t.prototype.notifyComplete=function(e){e!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(e.context))},t.prototype.closeWindow=function(e){if(-1!==e){var t=this.contexts,i=t[e],r=i.window,n=i.subscription;t.splice(e,1),r.complete(),n.unsubscribe()}},t}(OuterSubscriber),WindowSubscriber$1=function(e){function t(t,i){var r=e.call(this,t)||this;return r.destination=t,r.closingSelector=i,r.openWindow(),r}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.openWindow(n)},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype.notifyComplete=function(e){this.openWindow(e)},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e),this.unsubscribeClosingNotification()},t.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},t.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},t.prototype.openWindow=function(e){void 0===e&&(e=null),e&&(this.remove(e),e.unsubscribe());var t=this.window;t&&t.complete();var i,r=this.window=new Subject;this.destination.next(r);try{i=(0,this.closingSelector)()}catch(e){return this.destination.error(e),void this.window.error(e)}this.add(this.closingNotification=subscribeToResult(this,i))},t}(OuterSubscriber),WithLatestFromSubscriber=function(e){function t(t,i,r){var n=e.call(this,t)||this;n.observables=i,n.project=r,n.toRespond=[];var o=i.length;n.values=new Array(o);for(var s=0;s<o;s++)n.toRespond.push(s);for(s=0;s<o;s++){var a=i[s];n.add(subscribeToResult(n,a,a,s))}return n}return __extends(t,e),t.prototype.notifyNext=function(e,t,i,r,n){this.values[i]=t;var o=this.toRespond;if(o.length>0){var s=o.indexOf(i);-1!==s&&o.splice(s,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(OuterSubscriber);function __awaiter$1(e,t,i,r){return new(i||(i=Promise))(function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})}function jump(e,t){return isStateHistory(e)?t>0?jumpToFuture(e,t-1):t<0?jumpToPast(e,e.past.length+t):e:e}function jumpToFuture(e,t){if(t<0||t>=e.future.length)return e;const{past:i,future:r,present:n}=e;return{past:[...i,n,...r.slice(0,t)],present:r[t],future:r.slice(t+1)}}function jumpToPast(e,t){if(t<0||t>=e.past.length)return e;const{past:i,future:r,present:n}=e,o=i.slice(0,t),s=[...i.slice(t+1),n,...r];return{past:o,present:i[t],future:s}}function nextStateHistory(e,t){return Object.assign({},e,{past:[...e.past,e.present],present:t,future:[]})}function applyLimits(e,t){return isStateHistory(e)&&(e.past.length>t&&(e.past=e.past.slice(e.past.length-t)),e.future.length>t&&(e.future=e.future.slice(0,t))),e}function isStateHistory(e){return void 0!==e.present&&void 0!==e.future&&void 0!==e.past&&Array.isArray(e.future)&&Array.isArray(e.past)}function logMiddleware(e,t,i){i&&i.logType&&console.hasOwnProperty(i.logType)?console[i.logType]("New state: ",e):console.log("New state: ",e)}function localStorageMiddleware(e,t,i){if(PLATFORM.global.localStorage){const t=i&&i.key&&"string"==typeof i.key?i.key:"aurelia-store-state";PLATFORM.global.localStorage.setItem(t,JSON.stringify(e))}}function rehydrateFromLocalStorage(e,t){if(!PLATFORM.global.localStorage)return e;const i=PLATFORM.global.localStorage.getItem(t||"aurelia-store-state");if(!i)return e;try{return JSON.parse(i)}catch(e){}return e}function getLogType(e,t,i){return t&&e.logDefinitions&&e.logDefinitions.hasOwnProperty(t)&&e.logDefinitions[t]&&Object.values(LogLevel).includes(e.logDefinitions[t])?e.logDefinitions[t]:i}!function(e){e.Before="before",e.After="after"}(MiddlewarePlacement||(MiddlewarePlacement={})),function(e){e.trace="trace",e.debug="debug",e.info="info",e.log="log",e.warn="warn",e.error="error"}(LogLevel||(LogLevel={})),function(e){e.StartEnd="startEnd",e.All="all"}(PerformanceMeasurement||(PerformanceMeasurement={}));class Store{constructor(e,t){this.initialState=e,this.logger=getLogger("aurelia-store"),this.devToolsAvailable=!1,this.actions=new Map,this.middlewares=new Map,this.dispatchQueue=[],this.options=t||{};const i=this.options.history&&!0===this.options.history.undoable;this._state=new BehaviorSubject(e),this.state=this._state.asObservable(),this.options.devToolsOptions&&!0===this.options.devToolsOptions.disable||this.setupDevTools(),i&&this.registerHistoryMethods()}registerMiddleware(e,t,i){this.middlewares.set(e,{placement:t,settings:i})}unregisterMiddleware(e){this.middlewares.has(e)&&this.middlewares.delete(e)}isMiddlewareRegistered(e){return this.middlewares.has(e)}registerAction(e,t){if(0===t.length)throw new Error("The reducer is expected to have one or more parameters, where the first will be the present state");this.actions.set(t,{type:e})}unregisterAction(e){this.actions.has(e)&&this.actions.delete(e)}isActionRegistered(e){return"string"==typeof e?void 0!==Array.from(this.actions).find(t=>t[1].type===e):this.actions.has(e)}resetToState(e){this._state.next(e)}dispatch(e,...t){let i;if("string"==typeof e){const t=Array.from(this.actions).find(t=>t[1].type===e);t&&(i=t[0])}else i=e;return new Promise((e,r)=>{this.dispatchQueue.push({reducer:i,params:t,resolve:e,reject:r}),1===this.dispatchQueue.length&&this.handleQueue()})}handleQueue(){return __awaiter$1(this,void 0,void 0,function*(){if(this.dispatchQueue.length>0){const e=this.dispatchQueue[0];try{yield this.internalDispatch(e.reducer,...e.params),e.resolve()}catch(t){e.reject(t)}this.dispatchQueue.shift(),this.handleQueue()}})}internalDispatch(e,...t){return __awaiter$1(this,void 0,void 0,function*(){if(!this.actions.has(e))throw new Error(`Tried to dispatch an unregistered action${e?" "+e.name:""}`);PLATFORM.performance.mark("dispatch-start");const i=Object.assign({},this.actions.get(e),{params:t});this.options.logDispatchedActions&&this.logger[getLogType(this.options,"dispatchedActions",LogLevel.info)](`Dispatching: ${i.type}`);const r=yield this.executeMiddlewares(this._state.getValue(),MiddlewarePlacement.Before,{name:i.type,params:t});if(!1===r)return PLATFORM.performance.clearMarks(),void PLATFORM.performance.clearMeasures();const n=yield e(r,...t);if(!1===n)return PLATFORM.performance.clearMarks(),void PLATFORM.performance.clearMeasures();if(PLATFORM.performance.mark("dispatch-after-reducer-"+i.type),!n&&"object"!=typeof n)throw new Error("The reducer has to return a new state");let o=yield this.executeMiddlewares(n,MiddlewarePlacement.After,{name:i.type,params:t});if(!1===o)return PLATFORM.performance.clearMarks(),void PLATFORM.performance.clearMeasures();if(isStateHistory(o)&&this.options.history&&this.options.history.limit&&(o=applyLimits(o,this.options.history.limit)),this._state.next(o),PLATFORM.performance.mark("dispatch-end"),this.options.measurePerformance===PerformanceMeasurement.StartEnd){PLATFORM.performance.measure("startEndDispatchDuration","dispatch-start","dispatch-end");const e=PLATFORM.performance.getEntriesByName("startEndDispatchDuration");this.logger[getLogType(this.options,"performanceLog",LogLevel.info)](`Total duration ${e[0].duration} of dispatched action ${i.type}:`,e)}else if(this.options.measurePerformance===PerformanceMeasurement.All){const e=PLATFORM.performance.getEntriesByType("mark"),t=e[e.length-1].startTime-e[0].startTime;this.logger[getLogType(this.options,"performanceLog",LogLevel.info)](`Total duration ${t} of dispatched action ${i.type}:`,e)}PLATFORM.performance.clearMarks(),PLATFORM.performance.clearMeasures(),this.updateDevToolsState(i,o)})}executeMiddlewares(e,t,i){return Array.from(this.middlewares).filter(e=>e[1].placement===t).reduce((e,r,n,o)=>__awaiter$1(this,void 0,void 0,function*(){try{const n=yield r[0](yield e,this._state.getValue(),r[1].settings,i);return!1===n?([],!1):n||(yield e)}catch(t){if(this.options.propagateError)throw[],t;return yield e}finally{PLATFORM.performance.mark(`dispatch-${t}-${r[0].name}`)}}),e)}setupDevTools(){PLATFORM.global.devToolsExtension&&(this.logger[getLogType(this.options,"devToolsStatus",LogLevel.debug)]("DevTools are available"),this.devToolsAvailable=!0,this.devTools=PLATFORM.global.__REDUX_DEVTOOLS_EXTENSION__.connect(this.options.devToolsOptions),this.devTools.init(this.initialState),this.devTools.subscribe(e=>{this.logger[getLogType(this.options,"devToolsStatus",LogLevel.debug)](`DevTools sent change ${e.type}`),"DISPATCH"===e.type&&this._state.next(JSON.parse(e.state))}))}updateDevToolsState(e,t){this.devToolsAvailable&&this.devTools.send(e,t)}registerHistoryMethods(){this.registerAction("jump",jump)}}function dispatchify(e){const t=Container.instance.get(Store);return function(...i){return t.dispatch(e,...i)}}function executeSteps(e,t,...i){return __awaiter$1(this,void 0,void 0,function*(){const r=(e,i)=>r=>{t&&(console.group(`Step ${i}`),console.log(r),console.groupEnd()),e(r)},n=(e,t)=>i=>{try{e(i)}catch(e){t(e)}};return new Promise((t,o)=>{let s=0;i.slice(0,-1).forEach(t=>{e.state.pipe(skip(s),take(1),delay(0)).subscribe(n(r(t,s),o)),s++}),e.state.pipe(skip(s),take(1)).subscribe(((e,t)=>i=>{e(i),t()})(n(r(i[i.length-1],s),o),t))})})}const defaultSelector=e=>e.state;function connectTo(e){if(!Object.entries)throw new Error("You need a polyfill for Object.entries for browsers like Internet Explorer. Example: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries#Polyfill");const t=Container.instance.get(Store),i=Object.assign({selector:"function"==typeof e?e:defaultSelector},e);return function(r){const n="object"==typeof e&&e.setup?r.prototype[e.setup]:r.prototype.bind,o="object"==typeof e&&e.teardown?r.prototype[e.teardown]:r.prototype.unbind;r.prototype["object"==typeof e&&e.setup?e.setup:"bind"]=function(){if("object"==typeof e&&"string"==typeof e.onChanged&&!(e.onChanged in this))throw new Error("Provided onChanged handler does not exist on target VM");if(this._stateSubscriptions=function(){const e="object"==typeof i.selector,t={[i.target||"state"]:i.selector||defaultSelector};return Object.entries(Object.assign({},e?i.selector:t)).map(([t,r])=>({targets:i.target&&e?[i.target,t]:[t],selector:r,changeHandlers:{[i.onChanged||""]:1,[`${i.target||t}Changed`]:i.target?0:1,propertyChanged:0}}))}().map(e=>(function(e){const i=e(t);return i instanceof Observable?i:t.state})(e.selector).subscribe(t=>{const i=e.targets.length-1,r=e.targets.reduce((e={},t)=>e[t],this);Object.entries(e.changeHandlers).forEach(([n,o])=>{n in this&&this[n](...[e.targets[i],t,r].slice(o,3))}),e.targets.reduce((e,r,n)=>(e[r]=n===i?t:e[r]||{},e[r]),this)})),n)return n.apply(this,arguments)},r.prototype["object"==typeof e&&e.teardown?e.teardown:"unbind"]=function(){if(this._stateSubscriptions&&Array.isArray(this._stateSubscriptions)&&this._stateSubscriptions.forEach(e=>{e instanceof Subscription&&!1===e.closed&&e.unsubscribe()}),o)return o.apply(this,arguments)}}}function configure$7(e,t){if(!t||!t.initialState)throw new Error("initialState must be provided via options");let i=t.initialState;t&&t.history&&t.history.undoable&&!isStateHistory(t.initialState)&&(i={past:[],present:t.initialState,future:[]}),delete t.initialState,e.container.registerInstance(Store,new Store(i,t))}var ConsoleAppender=function(){function e(){}return e.prototype.debug=function(e){for(var t,i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];(t=console).debug.apply(t,["DEBUG ["+e.id+"]"].concat(r))},e.prototype.info=function(e){for(var t,i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];(t=console).info.apply(t,["INFO ["+e.id+"]"].concat(r))},e.prototype.warn=function(e){for(var t,i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];(t=console).warn.apply(t,["WARN ["+e.id+"]"].concat(r))},e.prototype.error=function(e){for(var t,i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];(t=console).error.apply(t,["ERROR ["+e.id+"]"].concat(r))},e}();function createDialogCancelError(e){const t=new Error("Operation cancelled.");return t.wasCancelled=!0,t.output=e,t}function invokeLifecycle(e,t,i){return"function"==typeof e[t]?new Promise(r=>{r(e[t](i))}).then(e=>null==e||e):Promise.resolve(!0)}function createDialogCloseError(e){const t=new Error;return t.wasCancelled=!1,t.output=e,t}class DialogController{constructor(e,t,i,r){this.resolve=i,this.reject=r,this.settings=t,this.renderer=e}releaseResources(e){return invokeLifecycle(this.controller.viewModel||{},"deactivate",e).then(()=>this.renderer.hideDialog(this)).then(()=>{this.controller.unbind()})}cancelOperation(){if(!this.settings.rejectOnCancel)return{wasCancelled:!0};throw createDialogCancelError()}ok(e){return this.close(!0,e)}cancel(e){return this.close(!1,e)}error(e){const t=createDialogCloseError(e);return this.releaseResources(t).then(()=>{this.reject(t)})}close(e,t){if(this.closePromise)return this.closePromise;const i={wasCancelled:!e,output:t};return this.closePromise=invokeLifecycle(this.controller.viewModel||{},"canDeactivate",i).catch(e=>(this.closePromise=void 0,Promise.reject(e))).then(r=>r?this.releaseResources(i).then(()=>(!this.settings.rejectOnCancel||e?this.resolve(i):this.reject(createDialogCancelError(t)),{wasCancelled:!1})).catch(e=>(this.closePromise=void 0,Promise.reject(e))):(this.closePromise=void 0,this.cancelOperation()))}}function whenClosed(e,t){return this.then(e=>e.wasCancelled?e:e.closeResult).then(e,t)}function asDialogOpenPromise(e){return e.whenClosed=whenClosed,e}DialogController.inject=[Renderer];class DialogService{constructor(e,t,i){this.controllers=[],this.hasOpenDialog=!1,this.hasActiveDialog=!1,this.container=e,this.compositionEngine=t,this.defaultSettings=i}validateSettings(e){if(!e.viewModel&&!e.view)throw new Error('Invalid Dialog Settings. You must provide "viewModel", "view" or both.')}createCompositionContext(e,t,i){return{container:e.parent,childContainer:e,bindingContext:null,viewResources:null,model:i.model,view:i.view,viewModel:i.viewModel,viewSlot:new ViewSlot(t,!0),host:t}}ensureViewModel(e){if("function"==typeof e.viewModel){const t=Origin.get(e.viewModel).moduleId;if(!t)return Promise.reject(new Error(`Can not resolve "moduleId" of "${e.viewModel.name}".`));e.viewModel=t}return"string"==typeof e.viewModel?this.compositionEngine.ensureViewModel(e):Promise.resolve(e)}_cancelOperation(e){if(!e)return{wasCancelled:!0};throw createDialogCancelError()}composeAndShowDialog(e,t){return e.viewModel||(e.bindingContext={controller:t}),this.compositionEngine.compose(e).then(e=>(t.controller=e,t.renderer.showDialog(t).then(()=>{this.controllers.push(t),this.hasActiveDialog=this.hasOpenDialog=!!this.controllers.length},t=>(e.viewModel&&invokeLifecycle(e.viewModel,"deactivate"),Promise.reject(t)))))}createSettings(e){return"boolean"==typeof(e=Object.assign({},this.defaultSettings,e)).keyboard||e.keyboard||(e.keyboard=!e.lock),"boolean"!=typeof e.overlayDismiss&&(e.overlayDismiss=!e.lock),Object.defineProperty(e,"rejectOnCancel",{writable:!1,configurable:!0,enumerable:!0}),this.validateSettings(e),e}open(e={}){const t=(e=this.createSettings(e)).childContainer||this.container.createChild();let i,r;const n=new Promise((e,t)=>{i=e,r=t}),o=t.invoke(DialogController,[e,i,r]);t.registerInstance(DialogController,o),n.then(()=>{removeController(this,o)},()=>{removeController(this,o)});const s=this.createCompositionContext(t,o.renderer.getDialogContainer(),o.settings);return asDialogOpenPromise(this.ensureViewModel(s).then(e=>!e.viewModel||invokeLifecycle(e.viewModel,"canActivate",o.settings.model)).then(e=>e?this.composeAndShowDialog(s,o).then(()=>({controller:o,closeResult:n,wasCancelled:!1})):this._cancelOperation(o.settings.rejectOnCancel)))}closeAll(){return Promise.all(this.controllers.slice(0).map(e=>e.settings.rejectOnCancel?e.cancel().then(()=>null).catch(t=>{if(t.wasCancelled)return e;throw t}):e.cancel().then(t=>t.wasCancelled?e:null))).then(e=>e.filter(e=>!!e))}}function removeController(e,t){const i=e.controllers.indexOf(t);-1!==i&&(e.controllers.splice(i,1),e.hasActiveDialog=e.hasOpenDialog=!!e.controllers.length)}DialogService.inject=[Container,CompositionEngine,DefaultDialogSettings];const isPromise$1=e=>!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then,tryCatch=e=>{if("function"!=typeof e&&!isPromise$1(e))throw new Error("Argument must be a function or Promise");return isPromise$1(e)?e.then(e=>({result:e}),e=>({error:e})):(e=>{try{return{result:e()}}catch(e){return{error:e}}})(e)};function configureDialog(e,t){let i=null;const r=new DialogConfiguration(e,e=>{i=e});"function"==typeof t?t(r):r.useDefaults(),i()}initialize(),(e=>{e.developmentLogging=function(){return LogManager.addAppender(new ConsoleAppender),LogManager.setLevel(LogManager.logLevel.debug),this},e.defaultBindingLanguage=function(){return this.plugin(configure)},e.defaultResources=function(){return this.plugin(configure$2)},e.eventAggregator=function(){return this.plugin(configure$3)},e.history=function(){return this.plugin(configure$4)},e.router=function(){return this.plugin(configure$5)},e.validation=function(e){return this.plugin(configure$6,e)},e.dialog=function(e){return this.plugin(configureDialog,e)},e.store=function(e){return this.plugin(configure$7,e)}})(FrameworkConfiguration.prototype);export{EventAggregator,includeEventsIn,CommitChangesStep,NavigationInstruction,NavModel,isNavigationCommand,Redirect,RedirectToRoute,pipelineStatus,Pipeline,RouterConfiguration,activationStrategy,BuildNavigationPlanStep,Router,CanDeactivatePreviousStep,CanActivateNextStep,DeactivatePreviousStep,ActivateNextStep,RouteLoader,LoadRouteStep,PipelineProvider,AppRouter,getTargetDOMElement,getPropertyInfo,PropertyAccessorParser,getAccessorExpression,ValidateBindingBehavior,ValidateManuallyBindingBehavior,ValidateOnBlurBindingBehavior,ValidateOnChangeBindingBehavior,ValidateOnChangeOrBlurBindingBehavior,ValidateEvent,ValidateResult,validateTrigger,ValidationController,ValidationControllerFactory,ValidationErrorsCustomAttribute,ValidationRendererCustomAttribute,Validator,Rules,StandardValidator,validationMessages,ValidationMessageProvider,ValidationMessageParser,MessageExpressionValidator,FluentRuleCustomizer,FluentRules,FluentEnsure,ValidationRules,PerformanceMeasurement,Store,dispatchify,executeSteps,jump,nextStateHistory,applyLimits,isStateHistory,MiddlewarePlacement,logMiddleware,localStorageMiddleware,rehydrateFromLocalStorage,connectTo,isPromise$1 as isPromise,tryCatch,Aurelia,FrameworkConfiguration,LogManager,resolver,StrategyResolver,Lazy,All,Optional,Parent,Factory,NewInstance,getDecoratorDependencies,lazy,all,optional,parent,factory,newInstance,invoker,invokeAsFactory,FactoryInvoker,registration,transient,singleton,TransientRegistration,SingletonRegistration,_emptyParameters,InvocationHandler,Container,autoinject,inject,_getArrayObserver as getArrayObserver,_getMapObserver as getMapObserver,_getSetObserver as getSetObserver,targetContext,sourceContext,camelCase,createOverrideContext,getContextFor,createScopeForTest,connectable,enqueueBindingConnect,setConnectQueueThreshold,enableConnectQueue,disableConnectQueue,getConnectQueueSize,subscriberCollection,ExpressionObserver,calcSplices,mergeSplice,projectArraySplices,getChangeRecords,ModifyCollectionObserver,CollectionLengthObserver,Expression,BindingBehavior,ValueConverter,Assign,Conditional,AccessThis,AccessScope,AccessMember,AccessKeyed,CallScope,CallMember,CallFunction,Binary,Unary,LiteralPrimitive,LiteralString,LiteralTemplate,LiteralArray,LiteralObject,_Unparser as Unparser,ExpressionCloner,cloneExpression,bindingMode,Parser,ParserImplementation,delegationStrategy,EventManager,EventSubscriber,DirtyChecker,DirtyCheckProperty,propertyAccessor,PrimitiveObserver,SetterObserver,XLinkAttributeObserver,dataAttributeAccessor,DataAttributeObserver,StyleObserver,ValueAttributeObserver,CheckedObserver,SelectValueObserver,ClassObserver,hasDeclaredDependencies,declarePropertyDependencies,computedFrom,ComputedExpression,createComputedObserver,elements,presentationElements,presentationAttributes,SVGAnalyzer,ObserverLocator,ObjectObservationAdapter,BindingExpression,Binding,CallExpression,Call,ValueConverterResource,valueConverter,BindingBehaviorResource,bindingBehavior,ListenerExpression,Listener,NameExpression,BindingEngine,observable,connectBindingToSignal,signalBindings,metadata,Origin,decorators,deprecated,mixin,protocol,animationEvent,Animator,CompositionTransactionNotifier,CompositionTransactionOwnershipToken,CompositionTransaction,_hyphenate,_isAllWhitespace,ViewEngineHooksResource,viewEngineHooks,ElementEvents,ResourceLoadContext,ViewCompileInstruction,BehaviorInstruction,TargetInstruction,viewStrategy,RelativeViewStrategy,ConventionalViewStrategy,NoViewStrategy,TemplateRegistryViewStrategy,InlineViewStrategy,StaticViewStrategy,ViewLocator,BindingLanguage,SlotCustomAttribute,PassThroughSlot,ShadowSlot,ShadowDOM,validateBehaviorName,ViewResources,View,ViewSlot,BoundViewFactory,ViewFactory,ViewCompiler,ResourceModule,ResourceDescription,ModuleAnalyzer,ViewEngine,Controller,BehaviorPropertyObserver,BindableProperty,HtmlBehaviorResource,children,child,SwapStrategies,CompositionEngine,ElementConfigResource,resource,behavior,customElement,customAttribute,templateController,bindable,dynamicOptions,useShadowDOM,processAttributes,processContent,containerless,useViewStrategy,useView,inlineView,noView,view,elementConfig,viewResources,TemplatingEngine,TemplateDependency,TemplateRegistryEntry,Loader,TaskQueue,relativeToFile,join,buildQueryString,parseQueryString,AggregateError,FEATURE,PLATFORM,DOM,isInitialized,initializePAL,reset,Renderer,DialogService,DialogController};